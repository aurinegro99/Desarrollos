<html>
<head>
<title>File Source for Parser.php</title>
<link rel="stylesheet" type="text/css" href="../media/style.css">
</head>
<body>

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
    <td class="header_top">PHPExcel_Writer_Excel5_Writer</td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td class="header_menu">
  		  [ <a href="../classtrees_PHPExcel_Writer_Excel5_Writer.html" class="menu">class tree: PHPExcel_Writer_Excel5_Writer</a> ]
		  [ <a href="../elementindex_PHPExcel_Writer_Excel5_Writer.html" class="menu">index: PHPExcel_Writer_Excel5_Writer</a> ]
		  [ <a href="../elementindex.html" class="menu">all elements</a> ]
    </td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="200" class="menu">
	<div id="todolist">
			<p><a href="../todolist.html">Todo List</a></p>
	</div>
      <b>Packages:</b><br />
              <a href="../li_OLE.html">OLE</a><br />
              <a href="../li_PHPExcel.html">PHPExcel</a><br />
              <a href="../li_PHPExcel_Calculation.html">PHPExcel_Calculation</a><br />
              <a href="../li_PHPExcel_Cell.html">PHPExcel_Cell</a><br />
              <a href="../li_PHPExcel_Reader.html">PHPExcel_Reader</a><br />
              <a href="../li_PHPExcel_RichText.html">PHPExcel_RichText</a><br />
              <a href="../li_PHPExcel_Shared.html">PHPExcel_Shared</a><br />
              <a href="../li_PHPExcel_Shared_OLE.html">PHPExcel_Shared_OLE</a><br />
              <a href="../li_PHPExcel_Style.html">PHPExcel_Style</a><br />
              <a href="../li_PHPExcel_Worksheet.html">PHPExcel_Worksheet</a><br />
              <a href="../li_PHPExcel_Worksheet_Drawing.html">PHPExcel_Worksheet_Drawing</a><br />
              <a href="../li_PHPExcel_Writer.html">PHPExcel_Writer</a><br />
              <a href="../li_PHPExcel_Writer_Excel5_Writer.html">PHPExcel_Writer_Excel5_Writer</a><br />
              <a href="../li_PHPExcel_Writer_Excel2007.html">PHPExcel_Writer_Excel2007</a><br />
            <br /><br />
                  
                </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<h1 align="center">Source for file Parser.php</h1>
<p>Documentation is available at <a href="../PHPExcel_Writer_Excel5_Writer/_Classes_PHPExcel_Writer_Excel5_Parser_php.html">Parser.php</a></p>
<div class="php">
<div class="listing"><pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a><span class="src-doc">/**</span></li>
<li><a name="a3"></a><span class="src-doc">*  Class for parsing Excel formulas</span></li>
<li><a name="a4"></a><span class="src-doc">*</span></li>
<li><a name="a5"></a><span class="src-doc">*  License Information:</span></li>
<li><a name="a6"></a><span class="src-doc">*</span></li>
<li><a name="a7"></a><span class="src-doc">*    PHPExcel_Writer_Excel5_Writer:  A library for generating Excel Spreadsheets</span></li>
<li><a name="a8"></a><span class="src-doc">*    Copyright (c) 2002-2003 Xavier Noguer xnoguer@rezebra.com</span></li>
<li><a name="a9"></a><span class="src-doc">*</span></li>
<li><a name="a10"></a><span class="src-doc">*    This library is free software; you can redistribute it and/or</span></li>
<li><a name="a11"></a><span class="src-doc">*    modify it under the terms of the GNU Lesser General Public</span></li>
<li><a name="a12"></a><span class="src-doc">*    License as published by the Free Software Foundation; either</span></li>
<li><a name="a13"></a><span class="src-doc">*    version 2.1 of the License, or (at your option) any later version.</span></li>
<li><a name="a14"></a><span class="src-doc">*</span></li>
<li><a name="a15"></a><span class="src-doc">*    This library is distributed in the hope that it will be useful,</span></li>
<li><a name="a16"></a><span class="src-doc">*    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></li>
<li><a name="a17"></a><span class="src-doc">*    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></li>
<li><a name="a18"></a><span class="src-doc">*    Lesser General Public License for more details.</span></li>
<li><a name="a19"></a><span class="src-doc">*</span></li>
<li><a name="a20"></a><span class="src-doc">*    You should have received a copy of the GNU Lesser General Public</span></li>
<li><a name="a21"></a><span class="src-doc">*    License along with this library; if not, write to the Free Software</span></li>
<li><a name="a22"></a><span class="src-doc">*    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></li>
<li><a name="a23"></a><span class="src-doc">*/</span></li>
<li><a name="a24"></a>&nbsp;</li>
<li><a name="a25"></a><span class="src-doc">/**</span></li>
<li><a name="a26"></a><span class="src-doc">* Class for parsing Excel formulas</span></li>
<li><a name="a27"></a><span class="src-doc">*</span></li>
<li><a name="a28"></a><span class="src-doc">* </span><span class="src-doc-coretag">@author</span><span class="src-doc">   Xavier Noguer &lt;xnoguer@rezebra.com&gt;</span></li>
<li><a name="a29"></a><span class="src-doc">* </span><span class="src-doc-coretag">@category</span><span class="src-doc"> FileFormats</span></li>
<li><a name="a30"></a><span class="src-doc">* </span><span class="src-doc-coretag">@package</span><span class="src-doc">  PHPExcel_Writer_Excel5_Writer</span></li>
<li><a name="a31"></a><span class="src-doc">*/</span></li>
<li><a name="a32"></a>&nbsp;</li>
<li><a name="a33"></a><span class="src-key">class </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html">PHPExcel_Writer_Excel5_Parser</a></li>
<li><a name="a34"></a><span class="src-sym">{</span></li>
<li><a name="a35"></a>    <span class="src-doc">/**</span></li>
<li><a name="a36"></a><span class="src-doc">    * The index of the character we are currently looking at</span></li>
<li><a name="a37"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">integer </span></li>
<li><a name="a38"></a><span class="src-doc">    */</span></li>
<li><a name="a39"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_char">$_current_char</a><span class="src-sym">;</span></li>
<li><a name="a40"></a>&nbsp;</li>
<li><a name="a41"></a>    <span class="src-doc">/**</span></li>
<li><a name="a42"></a><span class="src-doc">    * The token we are working on.</span></li>
<li><a name="a43"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a44"></a><span class="src-doc">    */</span></li>
<li><a name="a45"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">$_current_token</a><span class="src-sym">;</span></li>
<li><a name="a46"></a>&nbsp;</li>
<li><a name="a47"></a>    <span class="src-doc">/**</span></li>
<li><a name="a48"></a><span class="src-doc">    * The formula to parse</span></li>
<li><a name="a49"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a50"></a><span class="src-doc">    */</span></li>
<li><a name="a51"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">$_formula</a><span class="src-sym">;</span></li>
<li><a name="a52"></a>&nbsp;</li>
<li><a name="a53"></a>    <span class="src-doc">/**</span></li>
<li><a name="a54"></a><span class="src-doc">    * The character ahead of the current char</span></li>
<li><a name="a55"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a56"></a><span class="src-doc">    */</span></li>
<li><a name="a57"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">$_lookahead</a><span class="src-sym">;</span></li>
<li><a name="a58"></a>&nbsp;</li>
<li><a name="a59"></a>    <span class="src-doc">/**</span></li>
<li><a name="a60"></a><span class="src-doc">    * The parse tree to be generated</span></li>
<li><a name="a61"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a62"></a><span class="src-doc">    */</span></li>
<li><a name="a63"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_parse_tree">$_parse_tree</a><span class="src-sym">;</span></li>
<li><a name="a64"></a>&nbsp;</li>
<li><a name="a65"></a>    <span class="src-doc">/**</span></li>
<li><a name="a66"></a><span class="src-doc">    * The byte order. 1 =&gt; big endian, 0 =&gt; little endian.</span></li>
<li><a name="a67"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">integer </span></li>
<li><a name="a68"></a><span class="src-doc">    */</span></li>
<li><a name="a69"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_byte_order">$_byte_order</a><span class="src-sym">;</span></li>
<li><a name="a70"></a>&nbsp;</li>
<li><a name="a71"></a>    <span class="src-doc">/**</span></li>
<li><a name="a72"></a><span class="src-doc">    * Array of external sheets</span></li>
<li><a name="a73"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a74"></a><span class="src-doc">    */</span></li>
<li><a name="a75"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_ext_sheets">$_ext_sheets</a><span class="src-sym">;</span></li>
<li><a name="a76"></a>&nbsp;</li>
<li><a name="a77"></a>    <span class="src-doc">/**</span></li>
<li><a name="a78"></a><span class="src-doc">    * Array of sheet references in the form of REF structures</span></li>
<li><a name="a79"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a80"></a><span class="src-doc">    */</span></li>
<li><a name="a81"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_references">$_references</a><span class="src-sym">;</span></li>
<li><a name="a82"></a>&nbsp;</li>
<li><a name="a83"></a>    <span class="src-doc">/**</span></li>
<li><a name="a84"></a><span class="src-doc">    * The BIFF version for the workbook</span></li>
<li><a name="a85"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">integer </span></li>
<li><a name="a86"></a><span class="src-doc">    */</span></li>
<li><a name="a87"></a>    <span class="src-key">var </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">$_BIFF_version</a><span class="src-sym">;</span></li>
<li><a name="a88"></a>&nbsp;</li>
<li><a name="a89"></a>    <span class="src-doc">/**</span></li>
<li><a name="a90"></a><span class="src-doc">    * The class constructor</span></li>
<li><a name="a91"></a><span class="src-doc">    *</span></li>
<li><a name="a92"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">integer </span><span class="src-doc-var">$byte_order </span><span class="src-doc">The byte order (Little endian or Big endian) of the architecture</span></li>
<li><a name="a93"></a><span class="src-doc">                                 (optional). 1 =&gt; big endian, 0 (default) little endian.</span></li>
<li><a name="a94"></a><span class="src-doc">    */</span></li>
<li><a name="a95"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodPHPExcel_Writer_Excel5_Parser">PHPExcel_Writer_Excel5_Parser</a><span class="src-sym">(</span><span class="src-var">$byte_order</span><span class="src-sym">, </span><span class="src-var">$biff_version</span><span class="src-sym">)</span></li>
<li><a name="a96"></a>    <span class="src-sym">{</span></li>
<li><a name="a97"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_char">_current_char</a>  = <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a98"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a>  = <span class="src-var">$biff_version</span><span class="src-sym">;</span></li>
<li><a name="a99"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> = <span class="src-str">''</span><span class="src-sym">;       </span><span class="src-comm">// The token we are working on.</span></li>
<li><a name="a100"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a>       = <span class="src-str">''</span><span class="src-sym">;       </span><span class="src-comm">// The formula to parse.</span></li>
<li><a name="a101"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a>     = <span class="src-str">''</span><span class="src-sym">;       </span><span class="src-comm">// The character ahead of the current char.</span></li>
<li><a name="a102"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_parse_tree">_parse_tree</a>    = <span class="src-str">''</span><span class="src-sym">;       </span><span class="src-comm">// The parse tree to be generated.</span></li>
<li><a name="a103"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_initializeHashes">_initializeHashes</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;      </span><span class="src-comm">// Initialize the hashes: ptg's and function's ptg's</span></li>
<li><a name="a104"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_byte_order">_byte_order</a> = <span class="src-var">$byte_order</span><span class="src-sym">; </span><span class="src-comm">// Little Endian or Big Endian</span></li>
<li><a name="a105"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_ext_sheets">_ext_sheets</a> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a106"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_references">_references</a> = <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a107"></a>    <span class="src-sym">}</span></li>
<li><a name="a108"></a>&nbsp;</li>
<li><a name="a109"></a>    <span class="src-doc">/**</span></li>
<li><a name="a110"></a><span class="src-doc">    * Initialize the ptg and function hashes.</span></li>
<li><a name="a111"></a><span class="src-doc">    *</span></li>
<li><a name="a112"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a113"></a><span class="src-doc">    */</span></li>
<li><a name="a114"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_initializeHashes">_initializeHashes</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a115"></a>    <span class="src-sym">{</span></li>
<li><a name="a116"></a>        <span class="src-comm">// The Excel ptg indices</span></li>
<li><a name="a117"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg </span>= <span class="src-key">array</span><span class="src-sym">(</span></li>
<li><a name="a118"></a>            <span class="src-str">'ptgExp'       </span>=&gt; <span class="src-num">0x01</span><span class="src-sym">,</span></li>
<li><a name="a119"></a>            <span class="src-str">'ptgTbl'       </span>=&gt; <span class="src-num">0x02</span><span class="src-sym">,</span></li>
<li><a name="a120"></a>            <span class="src-str">'ptgAdd'       </span>=&gt; <span class="src-num">0x03</span><span class="src-sym">,</span></li>
<li><a name="a121"></a>            <span class="src-str">'ptgSub'       </span>=&gt; <span class="src-num">0x04</span><span class="src-sym">,</span></li>
<li><a name="a122"></a>            <span class="src-str">'ptgMul'       </span>=&gt; <span class="src-num">0x05</span><span class="src-sym">,</span></li>
<li><a name="a123"></a>            <span class="src-str">'ptgDiv'       </span>=&gt; <span class="src-num">0x06</span><span class="src-sym">,</span></li>
<li><a name="a124"></a>            <span class="src-str">'ptgPower'     </span>=&gt; <span class="src-num">0x07</span><span class="src-sym">,</span></li>
<li><a name="a125"></a>            <span class="src-str">'ptgConcat'    </span>=&gt; <span class="src-num">0x08</span><span class="src-sym">,</span></li>
<li><a name="a126"></a>            <span class="src-str">'ptgLT'        </span>=&gt; <span class="src-num">0x09</span><span class="src-sym">,</span></li>
<li><a name="a127"></a>            <span class="src-str">'ptgLE'        </span>=&gt; <span class="src-num">0x0A</span><span class="src-sym">,</span></li>
<li><a name="a128"></a>            <span class="src-str">'ptgEQ'        </span>=&gt; <span class="src-num">0x0B</span><span class="src-sym">,</span></li>
<li><a name="a129"></a>            <span class="src-str">'ptgGE'        </span>=&gt; <span class="src-num">0x0C</span><span class="src-sym">,</span></li>
<li><a name="a130"></a>            <span class="src-str">'ptgGT'        </span>=&gt; <span class="src-num">0x0D</span><span class="src-sym">,</span></li>
<li><a name="a131"></a>            <span class="src-str">'ptgNE'        </span>=&gt; <span class="src-num">0x0E</span><span class="src-sym">,</span></li>
<li><a name="a132"></a>            <span class="src-str">'ptgIsect'     </span>=&gt; <span class="src-num">0x0F</span><span class="src-sym">,</span></li>
<li><a name="a133"></a>            <span class="src-str">'ptgUnion'     </span>=&gt; <span class="src-num">0x10</span><span class="src-sym">,</span></li>
<li><a name="a134"></a>            <span class="src-str">'ptgRange'     </span>=&gt; <span class="src-num">0x11</span><span class="src-sym">,</span></li>
<li><a name="a135"></a>            <span class="src-str">'ptgUplus'     </span>=&gt; <span class="src-num">0x12</span><span class="src-sym">,</span></li>
<li><a name="a136"></a>            <span class="src-str">'ptgUminus'    </span>=&gt; <span class="src-num">0x13</span><span class="src-sym">,</span></li>
<li><a name="a137"></a>            <span class="src-str">'ptgPercent'   </span>=&gt; <span class="src-num">0x14</span><span class="src-sym">,</span></li>
<li><a name="a138"></a>            <span class="src-str">'ptgParen'     </span>=&gt; <span class="src-num">0x15</span><span class="src-sym">,</span></li>
<li><a name="a139"></a>            <span class="src-str">'ptgMissArg'   </span>=&gt; <span class="src-num">0x16</span><span class="src-sym">,</span></li>
<li><a name="a140"></a>            <span class="src-str">'ptgStr'       </span>=&gt; <span class="src-num">0x17</span><span class="src-sym">,</span></li>
<li><a name="a141"></a>            <span class="src-str">'ptgAttr'      </span>=&gt; <span class="src-num">0x19</span><span class="src-sym">,</span></li>
<li><a name="a142"></a>            <span class="src-str">'ptgSheet'     </span>=&gt; <span class="src-num">0x1A</span><span class="src-sym">,</span></li>
<li><a name="a143"></a>            <span class="src-str">'ptgEndSheet'  </span>=&gt; <span class="src-num">0x1B</span><span class="src-sym">,</span></li>
<li><a name="a144"></a>            <span class="src-str">'ptgErr'       </span>=&gt; <span class="src-num">0x1C</span><span class="src-sym">,</span></li>
<li><a name="a145"></a>            <span class="src-str">'ptgBool'      </span>=&gt; <span class="src-num">0x1D</span><span class="src-sym">,</span></li>
<li><a name="a146"></a>            <span class="src-str">'ptgInt'       </span>=&gt; <span class="src-num">0x1E</span><span class="src-sym">,</span></li>
<li><a name="a147"></a>            <span class="src-str">'ptgNum'       </span>=&gt; <span class="src-num">0x1F</span><span class="src-sym">,</span></li>
<li><a name="a148"></a>            <span class="src-str">'ptgArray'     </span>=&gt; <span class="src-num">0x20</span><span class="src-sym">,</span></li>
<li><a name="a149"></a>            <span class="src-str">'ptgFunc'      </span>=&gt; <span class="src-num">0x21</span><span class="src-sym">,</span></li>
<li><a name="a150"></a>            <span class="src-str">'ptgFuncVar'   </span>=&gt; <span class="src-num">0x22</span><span class="src-sym">,</span></li>
<li><a name="a151"></a>            <span class="src-str">'ptgName'      </span>=&gt; <span class="src-num">0x23</span><span class="src-sym">,</span></li>
<li><a name="a152"></a>            <span class="src-str">'ptgRef'       </span>=&gt; <span class="src-num">0x24</span><span class="src-sym">,</span></li>
<li><a name="a153"></a>            <span class="src-str">'ptgArea'      </span>=&gt; <span class="src-num">0x25</span><span class="src-sym">,</span></li>
<li><a name="a154"></a>            <span class="src-str">'ptgMemArea'   </span>=&gt; <span class="src-num">0x26</span><span class="src-sym">,</span></li>
<li><a name="a155"></a>            <span class="src-str">'ptgMemErr'    </span>=&gt; <span class="src-num">0x27</span><span class="src-sym">,</span></li>
<li><a name="a156"></a>            <span class="src-str">'ptgMemNoMem'  </span>=&gt; <span class="src-num">0x28</span><span class="src-sym">,</span></li>
<li><a name="a157"></a>            <span class="src-str">'ptgMemFunc'   </span>=&gt; <span class="src-num">0x29</span><span class="src-sym">,</span></li>
<li><a name="a158"></a>            <span class="src-str">'ptgRefErr'    </span>=&gt; <span class="src-num">0x2A</span><span class="src-sym">,</span></li>
<li><a name="a159"></a>            <span class="src-str">'ptgAreaErr'   </span>=&gt; <span class="src-num">0x2B</span><span class="src-sym">,</span></li>
<li><a name="a160"></a>            <span class="src-str">'ptgRefN'      </span>=&gt; <span class="src-num">0x2C</span><span class="src-sym">,</span></li>
<li><a name="a161"></a>            <span class="src-str">'ptgAreaN'     </span>=&gt; <span class="src-num">0x2D</span><span class="src-sym">,</span></li>
<li><a name="a162"></a>            <span class="src-str">'ptgMemAreaN'  </span>=&gt; <span class="src-num">0x2E</span><span class="src-sym">,</span></li>
<li><a name="a163"></a>            <span class="src-str">'ptgMemNoMemN' </span>=&gt; <span class="src-num">0x2F</span><span class="src-sym">,</span></li>
<li><a name="a164"></a>            <span class="src-str">'ptgNameX'     </span>=&gt; <span class="src-num">0x39</span><span class="src-sym">,</span></li>
<li><a name="a165"></a>            <span class="src-str">'ptgRef3d'     </span>=&gt; <span class="src-num">0x3A</span><span class="src-sym">,</span></li>
<li><a name="a166"></a>            <span class="src-str">'ptgArea3d'    </span>=&gt; <span class="src-num">0x3B</span><span class="src-sym">,</span></li>
<li><a name="a167"></a>            <span class="src-str">'ptgRefErr3d'  </span>=&gt; <span class="src-num">0x3C</span><span class="src-sym">,</span></li>
<li><a name="a168"></a>            <span class="src-str">'ptgAreaErr3d' </span>=&gt; <span class="src-num">0x3D</span><span class="src-sym">,</span></li>
<li><a name="a169"></a>            <span class="src-str">'ptgArrayV'    </span>=&gt; <span class="src-num">0x40</span><span class="src-sym">,</span></li>
<li><a name="a170"></a>            <span class="src-str">'ptgFuncV'     </span>=&gt; <span class="src-num">0x41</span><span class="src-sym">,</span></li>
<li><a name="a171"></a>            <span class="src-str">'ptgFuncVarV'  </span>=&gt; <span class="src-num">0x42</span><span class="src-sym">,</span></li>
<li><a name="a172"></a>            <span class="src-str">'ptgNameV'     </span>=&gt; <span class="src-num">0x43</span><span class="src-sym">,</span></li>
<li><a name="a173"></a>            <span class="src-str">'ptgRefV'      </span>=&gt; <span class="src-num">0x44</span><span class="src-sym">,</span></li>
<li><a name="a174"></a>            <span class="src-str">'ptgAreaV'     </span>=&gt; <span class="src-num">0x45</span><span class="src-sym">,</span></li>
<li><a name="a175"></a>            <span class="src-str">'ptgMemAreaV'  </span>=&gt; <span class="src-num">0x46</span><span class="src-sym">,</span></li>
<li><a name="a176"></a>            <span class="src-str">'ptgMemErrV'   </span>=&gt; <span class="src-num">0x47</span><span class="src-sym">,</span></li>
<li><a name="a177"></a>            <span class="src-str">'ptgMemNoMemV' </span>=&gt; <span class="src-num">0x48</span><span class="src-sym">,</span></li>
<li><a name="a178"></a>            <span class="src-str">'ptgMemFuncV'  </span>=&gt; <span class="src-num">0x49</span><span class="src-sym">,</span></li>
<li><a name="a179"></a>            <span class="src-str">'ptgRefErrV'   </span>=&gt; <span class="src-num">0x4A</span><span class="src-sym">,</span></li>
<li><a name="a180"></a>            <span class="src-str">'ptgAreaErrV'  </span>=&gt; <span class="src-num">0x4B</span><span class="src-sym">,</span></li>
<li><a name="a181"></a>            <span class="src-str">'ptgRefNV'     </span>=&gt; <span class="src-num">0x4C</span><span class="src-sym">,</span></li>
<li><a name="a182"></a>            <span class="src-str">'ptgAreaNV'    </span>=&gt; <span class="src-num">0x4D</span><span class="src-sym">,</span></li>
<li><a name="a183"></a>            <span class="src-str">'ptgMemAreaNV' </span>=&gt; <span class="src-num">0x4E</span><span class="src-sym">,</span></li>
<li><a name="a184"></a>            <span class="src-str">'ptgMemNoMemN' </span>=&gt; <span class="src-num">0x4F</span><span class="src-sym">,</span></li>
<li><a name="a185"></a>            <span class="src-str">'ptgFuncCEV'   </span>=&gt; <span class="src-num">0x58</span><span class="src-sym">,</span></li>
<li><a name="a186"></a>            <span class="src-str">'ptgNameXV'    </span>=&gt; <span class="src-num">0x59</span><span class="src-sym">,</span></li>
<li><a name="a187"></a>            <span class="src-str">'ptgRef3dV'    </span>=&gt; <span class="src-num">0x5A</span><span class="src-sym">,</span></li>
<li><a name="a188"></a>            <span class="src-str">'ptgArea3dV'   </span>=&gt; <span class="src-num">0x5B</span><span class="src-sym">,</span></li>
<li><a name="a189"></a>            <span class="src-str">'ptgRefErr3dV' </span>=&gt; <span class="src-num">0x5C</span><span class="src-sym">,</span></li>
<li><a name="a190"></a>            <span class="src-str">'ptgAreaErr3d' </span>=&gt; <span class="src-num">0x5D</span><span class="src-sym">,</span></li>
<li><a name="a191"></a>            <span class="src-str">'ptgArrayA'    </span>=&gt; <span class="src-num">0x60</span><span class="src-sym">,</span></li>
<li><a name="a192"></a>            <span class="src-str">'ptgFuncA'     </span>=&gt; <span class="src-num">0x61</span><span class="src-sym">,</span></li>
<li><a name="a193"></a>            <span class="src-str">'ptgFuncVarA'  </span>=&gt; <span class="src-num">0x62</span><span class="src-sym">,</span></li>
<li><a name="a194"></a>            <span class="src-str">'ptgNameA'     </span>=&gt; <span class="src-num">0x63</span><span class="src-sym">,</span></li>
<li><a name="a195"></a>            <span class="src-str">'ptgRefA'      </span>=&gt; <span class="src-num">0x64</span><span class="src-sym">,</span></li>
<li><a name="a196"></a>            <span class="src-str">'ptgAreaA'     </span>=&gt; <span class="src-num">0x65</span><span class="src-sym">,</span></li>
<li><a name="a197"></a>            <span class="src-str">'ptgMemAreaA'  </span>=&gt; <span class="src-num">0x66</span><span class="src-sym">,</span></li>
<li><a name="a198"></a>            <span class="src-str">'ptgMemErrA'   </span>=&gt; <span class="src-num">0x67</span><span class="src-sym">,</span></li>
<li><a name="a199"></a>            <span class="src-str">'ptgMemNoMemA' </span>=&gt; <span class="src-num">0x68</span><span class="src-sym">,</span></li>
<li><a name="a200"></a>            <span class="src-str">'ptgMemFuncA'  </span>=&gt; <span class="src-num">0x69</span><span class="src-sym">,</span></li>
<li><a name="a201"></a>            <span class="src-str">'ptgRefErrA'   </span>=&gt; <span class="src-num">0x6A</span><span class="src-sym">,</span></li>
<li><a name="a202"></a>            <span class="src-str">'ptgAreaErrA'  </span>=&gt; <span class="src-num">0x6B</span><span class="src-sym">,</span></li>
<li><a name="a203"></a>            <span class="src-str">'ptgRefNA'     </span>=&gt; <span class="src-num">0x6C</span><span class="src-sym">,</span></li>
<li><a name="a204"></a>            <span class="src-str">'ptgAreaNA'    </span>=&gt; <span class="src-num">0x6D</span><span class="src-sym">,</span></li>
<li><a name="a205"></a>            <span class="src-str">'ptgMemAreaNA' </span>=&gt; <span class="src-num">0x6E</span><span class="src-sym">,</span></li>
<li><a name="a206"></a>            <span class="src-str">'ptgMemNoMemN' </span>=&gt; <span class="src-num">0x6F</span><span class="src-sym">,</span></li>
<li><a name="a207"></a>            <span class="src-str">'ptgFuncCEA'   </span>=&gt; <span class="src-num">0x78</span><span class="src-sym">,</span></li>
<li><a name="a208"></a>            <span class="src-str">'ptgNameXA'    </span>=&gt; <span class="src-num">0x79</span><span class="src-sym">,</span></li>
<li><a name="a209"></a>            <span class="src-str">'ptgRef3dA'    </span>=&gt; <span class="src-num">0x7A</span><span class="src-sym">,</span></li>
<li><a name="a210"></a>            <span class="src-str">'ptgArea3dA'   </span>=&gt; <span class="src-num">0x7B</span><span class="src-sym">,</span></li>
<li><a name="a211"></a>            <span class="src-str">'ptgRefErr3dA' </span>=&gt; <span class="src-num">0x7C</span><span class="src-sym">,</span></li>
<li><a name="a212"></a>            <span class="src-str">'ptgAreaErr3d' </span>=&gt; <span class="src-num">0x7D</span></li>
<li><a name="a213"></a>            <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a214"></a>&nbsp;</li>
<li><a name="a215"></a>        <span class="src-comm">// Thanks to Michael Meeks and Gnumeric for the initial arg values.</span></li>
<li><a name="a216"></a>        <span class="src-comm">//</span></li>
<li><a name="a217"></a>        <span class="src-comm">// The following hash was generated by &quot;function_locale.pl&quot; in the distro.</span></li>
<li><a name="a218"></a>        <span class="src-comm">// Refer to function_locale.pl for non-English function names.</span></li>
<li><a name="a219"></a>        <span class="src-comm">//</span></li>
<li><a name="a220"></a>        <span class="src-comm">// The array elements are as follow:</span></li>
<li><a name="a221"></a>        <span class="src-comm">// ptg:   The Excel function ptg code.</span></li>
<li><a name="a222"></a>        <span class="src-comm">// args:  The number of arguments that the function takes:</span></li>
<li><a name="a223"></a>        <span class="src-comm">//           &gt;=0 is a fixed number of arguments.</span></li>
<li><a name="a224"></a>        <span class="src-comm">//           -1  is a variable  number of arguments.</span></li>
<li><a name="a225"></a>        <span class="src-comm">// class: The reference, value or array class of the function args.</span></li>
<li><a name="a226"></a>        <span class="src-comm">// vol:   The function is volatile.</span></li>
<li><a name="a227"></a>        <span class="src-comm">//</span></li>
<li><a name="a228"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">_functions </span>= <span class="src-key">array</span><span class="src-sym">(</span></li>
<li><a name="a229"></a>              <span class="src-comm">// function                  ptg  args  class  vol</span></li>
<li><a name="a230"></a>              <span class="src-str">'COUNT'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">0</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a231"></a>              <span class="src-str">'IF'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">1</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a232"></a>              <span class="src-str">'ISNA'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a233"></a>              <span class="src-str">'ISERROR'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a234"></a>              <span class="src-str">'SUM'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">4</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a235"></a>              <span class="src-str">'AVERAGE'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">5</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a236"></a>              <span class="src-str">'MIN'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">6</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a237"></a>              <span class="src-str">'MAX'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">7</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a238"></a>              <span class="src-str">'ROW'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">8</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a239"></a>              <span class="src-str">'COLUMN'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(   </span><span class="src-num">9</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a240"></a>              <span class="src-str">'NA'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">10</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a241"></a>              <span class="src-str">'NPV'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">11</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a242"></a>              <span class="src-str">'STDEV'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">12</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a243"></a>              <span class="src-str">'DOLLAR'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">13</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a244"></a>              <span class="src-str">'FIXED'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">14</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a245"></a>              <span class="src-str">'SIN'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">15</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a246"></a>              <span class="src-str">'COS'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">16</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a247"></a>              <span class="src-str">'TAN'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">17</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a248"></a>              <span class="src-str">'ATAN'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">18</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a249"></a>              <span class="src-str">'PI'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">19</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a250"></a>              <span class="src-str">'SQRT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">20</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a251"></a>              <span class="src-str">'EXP'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">21</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a252"></a>              <span class="src-str">'LN'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">22</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a253"></a>              <span class="src-str">'LOG10'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">23</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a254"></a>              <span class="src-str">'ABS'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">24</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a255"></a>              <span class="src-str">'INT'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">25</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a256"></a>              <span class="src-str">'SIGN'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">26</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a257"></a>              <span class="src-str">'ROUND'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">27</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a258"></a>              <span class="src-str">'LOOKUP'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">28</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a259"></a>              <span class="src-str">'INDEX'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">29</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a260"></a>              <span class="src-str">'REPT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">30</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a261"></a>              <span class="src-str">'MID'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">31</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a262"></a>              <span class="src-str">'LEN'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">32</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a263"></a>              <span class="src-str">'VALUE'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">33</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a264"></a>              <span class="src-str">'TRUE'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">34</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a265"></a>              <span class="src-str">'FALSE'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">35</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a266"></a>              <span class="src-str">'AND'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">36</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a267"></a>              <span class="src-str">'OR'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">37</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a268"></a>              <span class="src-str">'NOT'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">38</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a269"></a>              <span class="src-str">'MOD'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">39</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a270"></a>              <span class="src-str">'DCOUNT'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">40</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a271"></a>              <span class="src-str">'DSUM'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">41</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a272"></a>              <span class="src-str">'DAVERAGE'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">42</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a273"></a>              <span class="src-str">'DMIN'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">43</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a274"></a>              <span class="src-str">'DMAX'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">44</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a275"></a>              <span class="src-str">'DSTDEV'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">45</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a276"></a>              <span class="src-str">'VAR'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">46</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a277"></a>              <span class="src-str">'DVAR'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">47</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a278"></a>              <span class="src-str">'TEXT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">48</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a279"></a>              <span class="src-str">'LINEST'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">49</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a280"></a>              <span class="src-str">'TREND'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">50</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a281"></a>              <span class="src-str">'LOGEST'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">51</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a282"></a>              <span class="src-str">'GROWTH'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">52</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a283"></a>              <span class="src-str">'PV'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">56</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a284"></a>              <span class="src-str">'FV'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">57</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a285"></a>              <span class="src-str">'NPER'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">58</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a286"></a>              <span class="src-str">'PMT'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">59</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a287"></a>              <span class="src-str">'RATE'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">60</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a288"></a>              <span class="src-str">'MIRR'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">61</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a289"></a>              <span class="src-str">'IRR'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">62</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a290"></a>              <span class="src-str">'RAND'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">63</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a291"></a>              <span class="src-str">'MATCH'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">64</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a292"></a>              <span class="src-str">'DATE'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">65</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a293"></a>              <span class="src-str">'TIME'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">66</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a294"></a>              <span class="src-str">'DAY'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">67</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a295"></a>              <span class="src-str">'MONTH'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">68</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a296"></a>              <span class="src-str">'YEAR'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">69</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a297"></a>              <span class="src-str">'WEEKDAY'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">70</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a298"></a>              <span class="src-str">'HOUR'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">71</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a299"></a>              <span class="src-str">'MINUTE'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">72</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a300"></a>              <span class="src-str">'SECOND'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">73</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a301"></a>              <span class="src-str">'NOW'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">74</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a302"></a>              <span class="src-str">'AREAS'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">75</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a303"></a>              <span class="src-str">'ROWS'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">76</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a304"></a>              <span class="src-str">'COLUMNS'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">77</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a305"></a>              <span class="src-str">'OFFSET'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">78</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a306"></a>              <span class="src-str">'SEARCH'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">82</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a307"></a>              <span class="src-str">'TRANSPOSE'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">83</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a308"></a>              <span class="src-str">'TYPE'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">86</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a309"></a>              <span class="src-str">'ATAN2'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">97</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a310"></a>              <span class="src-str">'ASIN'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">98</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a311"></a>              <span class="src-str">'ACOS'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">(  </span><span class="src-num">99</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a312"></a>              <span class="src-str">'CHOOSE'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">100</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a313"></a>              <span class="src-str">'HLOOKUP'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">101</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a314"></a>              <span class="src-str">'VLOOKUP'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">102</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a315"></a>              <span class="src-str">'ISREF'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">105</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a316"></a>              <span class="src-str">'LOG'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">109</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a317"></a>              <span class="src-str">'CHAR'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">111</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a318"></a>              <span class="src-str">'LOWER'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">112</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a319"></a>              <span class="src-str">'UPPER'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">113</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a320"></a>              <span class="src-str">'PROPER'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">114</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a321"></a>              <span class="src-str">'LEFT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">115</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a322"></a>              <span class="src-str">'RIGHT'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">116</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a323"></a>              <span class="src-str">'EXACT'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">117</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a324"></a>              <span class="src-str">'TRIM'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">118</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a325"></a>              <span class="src-str">'REPLACE'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">119</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a326"></a>              <span class="src-str">'SUBSTITUTE'      </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">120</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a327"></a>              <span class="src-str">'CODE'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">121</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a328"></a>              <span class="src-str">'FIND'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">124</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a329"></a>              <span class="src-str">'CELL'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">125</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a330"></a>              <span class="src-str">'ISERR'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">126</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a331"></a>              <span class="src-str">'ISTEXT'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">127</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a332"></a>              <span class="src-str">'ISNUMBER'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">128</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a333"></a>              <span class="src-str">'ISBLANK'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">129</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a334"></a>              <span class="src-str">'T'               </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">130</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a335"></a>              <span class="src-str">'N'               </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">131</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a336"></a>              <span class="src-str">'DATEVALUE'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">140</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a337"></a>              <span class="src-str">'TIMEVALUE'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">141</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a338"></a>              <span class="src-str">'SLN'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">142</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a339"></a>              <span class="src-str">'SYD'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">143</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a340"></a>              <span class="src-str">'DDB'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">144</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a341"></a>              <span class="src-str">'INDIRECT'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">148</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a342"></a>              <span class="src-str">'CALL'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">150</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a343"></a>              <span class="src-str">'CLEAN'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">162</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a344"></a>              <span class="src-str">'MDETERM'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">163</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a345"></a>              <span class="src-str">'MINVERSE'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">164</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a346"></a>              <span class="src-str">'MMULT'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">165</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a347"></a>              <span class="src-str">'IPMT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">167</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a348"></a>              <span class="src-str">'PPMT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">168</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a349"></a>              <span class="src-str">'COUNTA'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">169</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a350"></a>              <span class="src-str">'PRODUCT'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">183</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a351"></a>              <span class="src-str">'FACT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">184</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a352"></a>              <span class="src-str">'DPRODUCT'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">189</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a353"></a>              <span class="src-str">'ISNONTEXT'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">190</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a354"></a>              <span class="src-str">'STDEVP'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">193</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a355"></a>              <span class="src-str">'VARP'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">194</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a356"></a>              <span class="src-str">'DSTDEVP'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">195</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a357"></a>              <span class="src-str">'DVARP'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">196</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a358"></a>              <span class="src-str">'TRUNC'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">197</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a359"></a>              <span class="src-str">'ISLOGICAL'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">198</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a360"></a>              <span class="src-str">'DCOUNTA'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">199</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a361"></a>              <span class="src-str">'ROUNDUP'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">212</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a362"></a>              <span class="src-str">'ROUNDDOWN'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">213</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a363"></a>              <span class="src-str">'RANK'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">216</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a364"></a>              <span class="src-str">'ADDRESS'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">219</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a365"></a>              <span class="src-str">'DAYS360'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">220</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a366"></a>              <span class="src-str">'TODAY'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">221</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a367"></a>              <span class="src-str">'VDB'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">222</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a368"></a>              <span class="src-str">'MEDIAN'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">227</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a369"></a>              <span class="src-str">'SUMPRODUCT'      </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">228</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a370"></a>              <span class="src-str">'SINH'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">229</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a371"></a>              <span class="src-str">'COSH'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">230</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a372"></a>              <span class="src-str">'TANH'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">231</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a373"></a>              <span class="src-str">'ASINH'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">232</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a374"></a>              <span class="src-str">'ACOSH'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">233</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a375"></a>              <span class="src-str">'ATANH'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">234</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a376"></a>              <span class="src-str">'DGET'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">235</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a377"></a>              <span class="src-str">'INFO'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">244</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a378"></a>              <span class="src-str">'DB'              </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">247</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a379"></a>              <span class="src-str">'FREQUENCY'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">252</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a380"></a>              <span class="src-str">'ERROR.TYPE'      </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">261</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a381"></a>              <span class="src-str">'REGISTER.ID'     </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">267</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a382"></a>              <span class="src-str">'AVEDEV'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">269</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a383"></a>              <span class="src-str">'BETADIST'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">270</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a384"></a>              <span class="src-str">'GAMMALN'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">271</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a385"></a>              <span class="src-str">'BETAINV'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">272</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a386"></a>              <span class="src-str">'BINOMDIST'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">273</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a387"></a>              <span class="src-str">'CHIDIST'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">274</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a388"></a>              <span class="src-str">'CHIINV'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">275</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a389"></a>              <span class="src-str">'COMBIN'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">276</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a390"></a>              <span class="src-str">'CONFIDENCE'      </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">277</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a391"></a>              <span class="src-str">'CRITBINOM'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">278</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a392"></a>              <span class="src-str">'EVEN'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">279</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a393"></a>              <span class="src-str">'EXPONDIST'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">280</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a394"></a>              <span class="src-str">'FDIST'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">281</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a395"></a>              <span class="src-str">'FINV'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">282</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a396"></a>              <span class="src-str">'FISHER'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">283</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a397"></a>              <span class="src-str">'FISHERINV'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">284</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a398"></a>              <span class="src-str">'FLOOR'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">285</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a399"></a>              <span class="src-str">'GAMMADIST'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">286</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a400"></a>              <span class="src-str">'GAMMAINV'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">287</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a401"></a>              <span class="src-str">'CEILING'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">288</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a402"></a>              <span class="src-str">'HYPGEOMDIST'     </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">289</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a403"></a>              <span class="src-str">'LOGNORMDIST'     </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">290</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a404"></a>              <span class="src-str">'LOGINV'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">291</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a405"></a>              <span class="src-str">'NEGBINOMDIST'    </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">292</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a406"></a>              <span class="src-str">'NORMDIST'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">293</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a407"></a>              <span class="src-str">'NORMSDIST'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">294</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a408"></a>              <span class="src-str">'NORMINV'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">295</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a409"></a>              <span class="src-str">'NORMSINV'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">296</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a410"></a>              <span class="src-str">'STANDARDIZE'     </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">297</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a411"></a>              <span class="src-str">'ODD'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">298</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a412"></a>              <span class="src-str">'PERMUT'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">299</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a413"></a>              <span class="src-str">'POISSON'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">300</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a414"></a>              <span class="src-str">'TDIST'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">301</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a415"></a>              <span class="src-str">'WEIBULL'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">302</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a416"></a>              <span class="src-str">'SUMXMY2'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">303</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a417"></a>              <span class="src-str">'SUMX2MY2'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">304</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a418"></a>              <span class="src-str">'SUMX2PY2'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">305</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a419"></a>              <span class="src-str">'CHITEST'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">306</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a420"></a>              <span class="src-str">'CORREL'          </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">307</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a421"></a>              <span class="src-str">'COVAR'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">308</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a422"></a>              <span class="src-str">'FORECAST'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">309</span><span class="src-sym">,    </span><span class="src-num">3</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a423"></a>              <span class="src-str">'FTEST'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">310</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a424"></a>              <span class="src-str">'INTERCEPT'       </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">311</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a425"></a>              <span class="src-str">'PEARSON'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">312</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a426"></a>              <span class="src-str">'RSQ'             </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">313</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a427"></a>              <span class="src-str">'STEYX'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">314</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a428"></a>              <span class="src-str">'SLOPE'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">315</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a429"></a>              <span class="src-str">'TTEST'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">316</span><span class="src-sym">,    </span><span class="src-num">4</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a430"></a>              <span class="src-str">'PROB'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">317</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a431"></a>              <span class="src-str">'DEVSQ'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">318</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a432"></a>              <span class="src-str">'GEOMEAN'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">319</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a433"></a>              <span class="src-str">'HARMEAN'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">320</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a434"></a>              <span class="src-str">'SUMSQ'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">321</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a435"></a>              <span class="src-str">'KURT'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">322</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a436"></a>              <span class="src-str">'SKEW'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">323</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a437"></a>              <span class="src-str">'ZTEST'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">324</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a438"></a>              <span class="src-str">'LARGE'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">325</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a439"></a>              <span class="src-str">'SMALL'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">326</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a440"></a>              <span class="src-str">'QUARTILE'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">327</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a441"></a>              <span class="src-str">'PERCENTILE'      </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">328</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a442"></a>              <span class="src-str">'PERCENTRANK'     </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">329</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a443"></a>              <span class="src-str">'MODE'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">330</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a444"></a>              <span class="src-str">'TRIMMEAN'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">331</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a445"></a>              <span class="src-str">'TINV'            </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">332</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a446"></a>              <span class="src-str">'CONCATENATE'     </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">336</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a447"></a>              <span class="src-str">'POWER'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">337</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a448"></a>              <span class="src-str">'RADIANS'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">342</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a449"></a>              <span class="src-str">'DEGREES'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">343</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a450"></a>              <span class="src-str">'SUBTOTAL'        </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">344</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a451"></a>              <span class="src-str">'SUMIF'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">345</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a452"></a>              <span class="src-str">'COUNTIF'         </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">346</span><span class="src-sym">,    </span><span class="src-num">2</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a453"></a>              <span class="src-str">'COUNTBLANK'      </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">347</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span><span class="src-sym">,</span></li>
<li><a name="a454"></a>              <span class="src-str">'ROMAN'           </span>=&gt; <span class="src-key">array</span><span class="src-sym">( </span><span class="src-num">354</span><span class="src-sym">,   </span>-<span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">1</span><span class="src-sym">,    </span><span class="src-num">0 </span><span class="src-sym">)</span></li>
<li><a name="a455"></a>              <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a456"></a>    <span class="src-sym">}</span></li>
<li><a name="a457"></a>&nbsp;</li>
<li><a name="a458"></a>    <span class="src-doc">/**</span></li>
<li><a name="a459"></a><span class="src-doc">    * Convert a token to the proper ptg value.</span></li>
<li><a name="a460"></a><span class="src-doc">    *</span></li>
<li><a name="a461"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a462"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">mixed </span><span class="src-doc-var">$token </span><span class="src-doc">The token to convert.</span></li>
<li><a name="a463"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">the converted token on success</span></li>
<li><a name="a464"></a><span class="src-doc">    */</span></li>
<li><a name="a465"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convert">_convert</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span></li>
<li><a name="a466"></a>    <span class="src-sym">{</span></li>
<li><a name="a467"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\&quot;<span class="src-sym">[</span>^\&quot;<span class="src-sym">]</span><span class="src-sym">{</span>0,255<span class="src-sym">}</span>\&quot;$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a468"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertString">_convertString</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a469"></a>&nbsp;</li>
<li><a name="a470"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a471"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertNumber">_convertNumber</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a472"></a>&nbsp;</li>
<li><a name="a473"></a>        <span class="src-comm">// match references like A1 or $A$1</span></li>
<li><a name="a474"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^\$?([A-Ia-i]?[A-Za-z])\$?(\d+)$/'</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a475"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRef2d">_convertRef2d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a476"></a>&nbsp;</li>
<li><a name="a477"></a>        <span class="src-comm">// match external references like Sheet1!A1 or Sheet1:Sheet2!A1</span></li>
<li><a name="a478"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\w+(\:\w+)?\!<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\d+)$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a479"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRef3d">_convertRef3d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a480"></a>&nbsp;</li>
<li><a name="a481"></a>        <span class="src-comm">// match external references like 'Sheet1'!A1 or 'Sheet1:Sheet2'!A1</span></li>
<li><a name="a482"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^'<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+(\:<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+)?'\!<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\d+)$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a483"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRef3d">_convertRef3d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a484"></a>&nbsp;</li>
<li><a name="a485"></a>        <span class="src-comm">// match ranges like A1:B2</span></li>
<li><a name="a486"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?(\d+)\:(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?(\d+)$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a487"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRange2d">_convertRange2d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a488"></a>&nbsp;</li>
<li><a name="a489"></a>        <span class="src-comm">// match ranges like A1..B2</span></li>
<li><a name="a490"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?(\d+)\.\.(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?(\d+)$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a491"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRange2d">_convertRange2d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a492"></a>&nbsp;</li>
<li><a name="a493"></a>        <span class="src-comm">// match external ranges like Sheet1!A1 or Sheet1:Sheet2!A1:B2</span></li>
<li><a name="a494"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\w+(\:\w+)?\!(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?(\d+)\:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?(\d+)$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a495"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRange3d">_convertRange3d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a496"></a>&nbsp;</li>
<li><a name="a497"></a>        <span class="src-comm">// match external ranges like 'Sheet1'!A1 or 'Sheet1:Sheet2'!A1:B2</span></li>
<li><a name="a498"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^'<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+(\:<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+)?'\!(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?(\d+)\:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?(\d+)$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a499"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRange3d">_convertRange3d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a500"></a>&nbsp;</li>
<li><a name="a501"></a>        <span class="src-comm">// operators (including parentheses)</span></li>
<li><a name="a502"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-var">$token</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a503"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-var">$token</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a504"></a>&nbsp;</li>
<li><a name="a505"></a>        <span class="src-comm">// commented so argument number can be processed correctly. See toReversePolish().</span></li>
<li><a name="a506"></a>        <span class="src-comm">/*elseif (preg_match(&quot;/[A-Z0-9\xc0-\xdc\.]+/&quot;,$token))</span></li>
<li><a name="a507"></a><span class="src-comm">        {</span></li>
<li><a name="a508"></a><span class="src-comm">            return($this-&gt;_convertFunction($token,$this-&gt;_func_args));</span></li>
<li><a name="a509"></a><span class="src-comm">        }*/</span></li>
<li><a name="a510"></a>&nbsp;</li>
<li><a name="a511"></a>        <span class="src-comm">// if it's an argument, ignore the token (the argument remains)</span></li>
<li><a name="a512"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$token </span>== <span class="src-str">'arg'</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a513"></a>            <span class="src-key">return </span><span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a514"></a>        <span class="src-sym">}</span></li>
<li><a name="a515"></a>        <span class="src-comm">// TODO: use real error codes</span></li>
<li><a name="a516"></a>        throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">token</span> <span class="src-var">$token</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a517"></a>    <span class="src-sym">}</span></li>
<li><a name="a518"></a>&nbsp;</li>
<li><a name="a519"></a>    <span class="src-doc">/**</span></li>
<li><a name="a520"></a><span class="src-doc">    * Convert a number token to ptgInt or ptgNum</span></li>
<li><a name="a521"></a><span class="src-doc">    *</span></li>
<li><a name="a522"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a523"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">mixed </span><span class="src-doc-var">$num </span><span class="src-doc">an integer or double for conversion to its ptg value</span></li>
<li><a name="a524"></a><span class="src-doc">    */</span></li>
<li><a name="a525"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertNumber">_convertNumber</a><span class="src-sym">(</span><span class="src-var">$num</span><span class="src-sym">)</span></li>
<li><a name="a526"></a>    <span class="src-sym">{</span></li>
<li><a name="a527"></a>        <span class="src-comm">// Integer in the range 0..2**16-1</span></li>
<li><a name="a528"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\d+$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$num</span><span class="src-sym">)) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$num </span>&lt;= <span class="src-num">65535</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a529"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;Cv&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgInt'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$num</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a530"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-comm">// A float</span></li>
<li><a name="a531"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_byte_order">_byte_order</a><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-comm">// if it's Big Endian</span></li>
<li><a name="a532"></a>                <span class="src-var">$num </span>= <a href="http://www.php.net/strrev">strrev</a><span class="src-sym">(</span><span class="src-var">$num</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a533"></a>            <span class="src-sym">}</span></li>
<li><a name="a534"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;Cd&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgNum'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$num</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a535"></a>        <span class="src-sym">}</span></li>
<li><a name="a536"></a>    <span class="src-sym">}</span></li>
<li><a name="a537"></a>&nbsp;</li>
<li><a name="a538"></a>    <span class="src-doc">/**</span></li>
<li><a name="a539"></a><span class="src-doc">    * Convert a string token to ptgStr</span></li>
<li><a name="a540"></a><span class="src-doc">    *</span></li>
<li><a name="a541"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a542"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$string </span><span class="src-doc">A string for conversion to its ptg value.</span></li>
<li><a name="a543"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">the converted token on success</span></li>
<li><a name="a544"></a><span class="src-doc">    */</span></li>
<li><a name="a545"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertString">_convertString</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span></li>
<li><a name="a546"></a>    <span class="src-sym">{</span></li>
<li><a name="a547"></a>        <span class="src-comm">// chop away beggining and ending quotes</span></li>
<li><a name="a548"></a>        <span class="src-var">$string </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">) </span>- <span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a549"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">) </span>&gt; <span class="src-num">255</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a550"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;String is too long&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a551"></a>        <span class="src-sym">}</span></li>
<li><a name="a552"></a>&nbsp;</li>
<li><a name="a553"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0500</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a554"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;CC&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgStr'</span><span class="src-sym">]</span><span class="src-sym">, </span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">))</span>.<span class="src-var">$string</span><span class="src-sym">;</span></li>
<li><a name="a555"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0600</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a556"></a>            <span class="src-var">$encoding </span>= <span class="src-num">0</span><span class="src-sym">;   </span><span class="src-comm">// TODO: Unicode support</span></li>
<li><a name="a557"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;CCC&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgStr'</span><span class="src-sym">]</span><span class="src-sym">, </span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$encoding</span><span class="src-sym">)</span>.<span class="src-var">$string</span><span class="src-sym">;</span></li>
<li><a name="a558"></a>        <span class="src-sym">}</span></li>
<li><a name="a559"></a>    <span class="src-sym">}</span></li>
<li><a name="a560"></a>&nbsp;</li>
<li><a name="a561"></a>    <span class="src-doc">/**</span></li>
<li><a name="a562"></a><span class="src-doc">    * Convert a function to a ptgFunc or ptgFuncVarV depending on the number of</span></li>
<li><a name="a563"></a><span class="src-doc">    * args that it takes.</span></li>
<li><a name="a564"></a><span class="src-doc">    *</span></li>
<li><a name="a565"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a566"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc"> </span><span class="src-doc-var">$token </span><span class="src-doc">   The name of the function for convertion to ptg value.</span></li>
<li><a name="a567"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">integer </span><span class="src-doc-var">$num_args </span><span class="src-doc">The number of arguments the function receives.</span></li>
<li><a name="a568"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span><span class="src-doc">The packed ptg for the function</span></li>
<li><a name="a569"></a><span class="src-doc">    */</span></li>
<li><a name="a570"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertFunction">_convertFunction</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">, </span><span class="src-var">$num_args</span><span class="src-sym">)</span></li>
<li><a name="a571"></a>    <span class="src-sym">{</span></li>
<li><a name="a572"></a>        <span class="src-var">$args     </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">_functions</span><span class="src-sym">[</span><span class="src-var">$token</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a573"></a>        <span class="src-var">$volatile </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">_functions</span><span class="src-sym">[</span><span class="src-var">$token</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a574"></a>&nbsp;</li>
<li><a name="a575"></a>        <span class="src-comm">// Fixed number of args eg. TIME($i,$j,$k).</span></li>
<li><a name="a576"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$args </span>&gt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a577"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;Cv&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgFuncV'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">_functions</span><span class="src-sym">[</span><span class="src-var">$token</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a578"></a>        <span class="src-sym">}</span></li>
<li><a name="a579"></a>        <span class="src-comm">// Variable number of args eg. SUM($i,$j,$k, ..).</span></li>
<li><a name="a580"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$args </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a581"></a>            <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;CCv&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgFuncVarV'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$num_args</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">_functions</span><span class="src-sym">[</span><span class="src-var">$token</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a582"></a>        <span class="src-sym">}</span></li>
<li><a name="a583"></a>    <span class="src-sym">}</span></li>
<li><a name="a584"></a>&nbsp;</li>
<li><a name="a585"></a>    <span class="src-doc">/**</span></li>
<li><a name="a586"></a><span class="src-doc">    * Convert an Excel range such as A1:D4 to a ptgRefV.</span></li>
<li><a name="a587"></a><span class="src-doc">    *</span></li>
<li><a name="a588"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a589"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$range </span><span class="src-doc">An Excel range in the A1:A2 or A1..A2 format.</span></li>
<li><a name="a590"></a><span class="src-doc">    */</span></li>
<li><a name="a591"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRange2d">_convertRange2d</a><span class="src-sym">(</span><span class="src-var">$range</span><span class="src-sym">, </span><span class="src-var">$class</span>=<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a592"></a>    <span class="src-sym">{</span></li>
<li><a name="a593"></a>&nbsp;</li>
<li><a name="a594"></a>        <span class="src-comm">// TODO: possible class value 0,1,2 check Formula.pm</span></li>
<li><a name="a595"></a>        <span class="src-comm">// Split the range into 2 cell refs</span></li>
<li><a name="a596"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)(\d+)\:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)(\d+)$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a597"></a>            list<span class="src-sym">(</span><span class="src-var">$cell1</span><span class="src-sym">, </span><span class="src-var">$cell2</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">':'</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a598"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)(\d+)\.\.(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)(\d+)$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a599"></a>            list<span class="src-sym">(</span><span class="src-var">$cell1</span><span class="src-sym">, </span><span class="src-var">$cell2</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">'\.\.'</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a600"></a>&nbsp;</li>
<li><a name="a601"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a602"></a>            <span class="src-comm">// TODO: use real error codes</span></li>
<li><a name="a603"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;Unknown range separator&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a604"></a>        <span class="src-sym">}</span></li>
<li><a name="a605"></a>&nbsp;</li>
<li><a name="a606"></a>        <span class="src-comm">// Convert the cell references</span></li>
<li><a name="a607"></a>        <span class="src-var">$cell_array1 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a608"></a>        list<span class="src-sym">(</span><span class="src-var">$row1</span><span class="src-sym">, </span><span class="src-var">$col1</span><span class="src-sym">) </span>= <span class="src-var">$cell_array1</span><span class="src-sym">;</span></li>
<li><a name="a609"></a>        <span class="src-var">$cell_array2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a610"></a>        list<span class="src-sym">(</span><span class="src-var">$row2</span><span class="src-sym">, </span><span class="src-var">$col2</span><span class="src-sym">) </span>= <span class="src-var">$cell_array2</span><span class="src-sym">;</span></li>
<li><a name="a611"></a>&nbsp;</li>
<li><a name="a612"></a>        <span class="src-comm">// The ptg value depends on the class of the ptg.</span></li>
<li><a name="a613"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a614"></a>            <span class="src-var">$ptgArea </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgArea'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a615"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a616"></a>            <span class="src-var">$ptgArea </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgAreaV'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a617"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a618"></a>            <span class="src-var">$ptgArea </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgAreaA'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a619"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a620"></a>            <span class="src-comm">// TODO: use real error codes</span></li>
<li><a name="a621"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">class</span> <span class="src-var">$class</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a622"></a>        <span class="src-sym">}</span></li>
<li><a name="a623"></a>        <span class="src-key">return </span><span class="src-var">$ptgArea </span>. <span class="src-var">$row1 </span>. <span class="src-var">$row2 </span>. <span class="src-var">$col1</span>. <span class="src-var">$col2</span><span class="src-sym">;</span></li>
<li><a name="a624"></a>    <span class="src-sym">}</span></li>
<li><a name="a625"></a>&nbsp;</li>
<li><a name="a626"></a>    <span class="src-doc">/**</span></li>
<li><a name="a627"></a><span class="src-doc">    * Convert an Excel 3d range such as &quot;Sheet1!A1:D4&quot; or &quot;Sheet1:Sheet2!A1:D4&quot; to</span></li>
<li><a name="a628"></a><span class="src-doc">    * a ptgArea3d.</span></li>
<li><a name="a629"></a><span class="src-doc">    *</span></li>
<li><a name="a630"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a631"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$token </span><span class="src-doc">An Excel range in the Sheet1!A1:A2 format.</span></li>
<li><a name="a632"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The packed ptgArea3d token on success.</span></li>
<li><a name="a633"></a><span class="src-doc">    */</span></li>
<li><a name="a634"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRange3d">_convertRange3d</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span></li>
<li><a name="a635"></a>    <span class="src-sym">{</span></li>
<li><a name="a636"></a>        <span class="src-var">$class </span>= <span class="src-num">2</span><span class="src-sym">; </span><span class="src-comm">// as far as I know, this is magick.</span></li>
<li><a name="a637"></a>&nbsp;</li>
<li><a name="a638"></a>        <span class="src-comm">// Split the ref at the ! symbol</span></li>
<li><a name="a639"></a>        list<span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">'!'</span><span class="src-sym">, </span><span class="src-var">$token</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a640"></a>&nbsp;</li>
<li><a name="a641"></a>        <span class="src-comm">// Convert the external reference part (different for BIFF8)</span></li>
<li><a name="a642"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0500</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a643"></a>            <span class="src-var">$ext_ref </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_packExtRef">_packExtRef</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a644"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0600</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a645"></a>             <span class="src-var">$ext_ref </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getRefIndex">_getRefIndex</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a646"></a>        <span class="src-sym">}</span></li>
<li><a name="a647"></a>&nbsp;</li>
<li><a name="a648"></a>        <span class="src-comm">// Split the range into 2 cell refs</span></li>
<li><a name="a649"></a>        list<span class="src-sym">(</span><span class="src-var">$cell1</span><span class="src-sym">, </span><span class="src-var">$cell2</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">':'</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a650"></a>&nbsp;</li>
<li><a name="a651"></a>        <span class="src-comm">// Convert the cell references</span></li>
<li><a name="a652"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?(\d+)$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$cell1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a653"></a>            <span class="src-var">$cell_array1 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a654"></a>            list<span class="src-sym">(</span><span class="src-var">$row1</span><span class="src-sym">, </span><span class="src-var">$col1</span><span class="src-sym">) </span>= <span class="src-var">$cell_array1</span><span class="src-sym">;</span></li>
<li><a name="a655"></a>            <span class="src-var">$cell_array2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a656"></a>            list<span class="src-sym">(</span><span class="src-var">$row2</span><span class="src-sym">, </span><span class="src-var">$col2</span><span class="src-sym">) </span>= <span class="src-var">$cell_array2</span><span class="src-sym">;</span></li>
<li><a name="a657"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-comm">// It's a rows range (like 26:27)</span></li>
<li><a name="a658"></a>             <span class="src-var">$cells_array </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_rangeToPackedRange">_rangeToPackedRange</a><span class="src-sym">(</span><span class="src-var">$cell1</span>.<span class="src-str">':'</span>.<span class="src-var">$cell2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a659"></a>             list<span class="src-sym">(</span><span class="src-var">$row1</span><span class="src-sym">, </span><span class="src-var">$col1</span><span class="src-sym">, </span><span class="src-var">$row2</span><span class="src-sym">, </span><span class="src-var">$col2</span><span class="src-sym">) </span>= <span class="src-var">$cells_array</span><span class="src-sym">;</span></li>
<li><a name="a660"></a>        <span class="src-sym">}</span></li>
<li><a name="a661"></a>&nbsp;</li>
<li><a name="a662"></a>        <span class="src-comm">// The ptg value depends on the class of the ptg.</span></li>
<li><a name="a663"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a664"></a>            <span class="src-var">$ptgArea </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgArea3d'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a665"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a666"></a>            <span class="src-var">$ptgArea </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgArea3dV'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a667"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a668"></a>            <span class="src-var">$ptgArea </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgArea3dA'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a669"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a670"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">class</span> <span class="src-var">$class</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a671"></a>        <span class="src-sym">}</span></li>
<li><a name="a672"></a>&nbsp;</li>
<li><a name="a673"></a>        <span class="src-key">return </span><span class="src-var">$ptgArea </span>. <span class="src-var">$ext_ref </span>. <span class="src-var">$row1 </span>. <span class="src-var">$row2 </span>. <span class="src-var">$col1</span>. <span class="src-var">$col2</span><span class="src-sym">;</span></li>
<li><a name="a674"></a>    <span class="src-sym">}</span></li>
<li><a name="a675"></a>&nbsp;</li>
<li><a name="a676"></a>    <span class="src-doc">/**</span></li>
<li><a name="a677"></a><span class="src-doc">    * Convert an Excel reference such as A1, $B2, C$3 or $D$4 to a ptgRefV.</span></li>
<li><a name="a678"></a><span class="src-doc">    *</span></li>
<li><a name="a679"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a680"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$cell </span><span class="src-doc">An Excel cell reference</span></li>
<li><a name="a681"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span><span class="src-doc">The cell in packed() format with the corresponding ptg</span></li>
<li><a name="a682"></a><span class="src-doc">    */</span></li>
<li><a name="a683"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRef2d">_convertRef2d</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span></li>
<li><a name="a684"></a>    <span class="src-sym">{</span></li>
<li><a name="a685"></a>        <span class="src-var">$class </span>= <span class="src-num">2</span><span class="src-sym">; </span><span class="src-comm">// as far as I know, this is magick.</span></li>
<li><a name="a686"></a>&nbsp;</li>
<li><a name="a687"></a>        <span class="src-comm">// Convert the cell reference</span></li>
<li><a name="a688"></a>        <span class="src-var">$cell_array </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a689"></a>        list<span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">) </span>= <span class="src-var">$cell_array</span><span class="src-sym">;</span></li>
<li><a name="a690"></a>&nbsp;</li>
<li><a name="a691"></a>        <span class="src-comm">// The ptg value depends on the class of the ptg.</span></li>
<li><a name="a692"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a693"></a>            <span class="src-var">$ptgRef </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgRef'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a694"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a695"></a>            <span class="src-var">$ptgRef </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgRefV'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a696"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a697"></a>            <span class="src-var">$ptgRef </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgRefA'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a698"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a699"></a>            <span class="src-comm">// TODO: use real error codes</span></li>
<li><a name="a700"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">class</span> <span class="src-var">$class</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a701"></a>        <span class="src-sym">}</span></li>
<li><a name="a702"></a>        <span class="src-key">return </span><span class="src-var">$ptgRef</span>.<span class="src-var">$row</span>.<span class="src-var">$col</span><span class="src-sym">;</span></li>
<li><a name="a703"></a>    <span class="src-sym">}</span></li>
<li><a name="a704"></a>&nbsp;</li>
<li><a name="a705"></a>    <span class="src-doc">/**</span></li>
<li><a name="a706"></a><span class="src-doc">    * Convert an Excel 3d reference such as &quot;Sheet1!A1&quot; or &quot;Sheet1:Sheet2!A1&quot; to a</span></li>
<li><a name="a707"></a><span class="src-doc">    * ptgRef3d.</span></li>
<li><a name="a708"></a><span class="src-doc">    *</span></li>
<li><a name="a709"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a710"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$cell </span><span class="src-doc">An Excel cell reference</span></li>
<li><a name="a711"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The packed ptgRef3d token on success.</span></li>
<li><a name="a712"></a><span class="src-doc">    */</span></li>
<li><a name="a713"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertRef3d">_convertRef3d</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span></li>
<li><a name="a714"></a>    <span class="src-sym">{</span></li>
<li><a name="a715"></a>        <span class="src-var">$class </span>= <span class="src-num">2</span><span class="src-sym">; </span><span class="src-comm">// as far as I know, this is magick.</span></li>
<li><a name="a716"></a>&nbsp;</li>
<li><a name="a717"></a>        <span class="src-comm">// Split the ref at the ! symbol</span></li>
<li><a name="a718"></a>        list<span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">, </span><span class="src-var">$cell</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">'!'</span><span class="src-sym">, </span><span class="src-var">$cell</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a719"></a>&nbsp;</li>
<li><a name="a720"></a>        <span class="src-comm">// Convert the external reference part (different for BIFF8)</span></li>
<li><a name="a721"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0500</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a722"></a>            <span class="src-var">$ext_ref </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_packExtRef">_packExtRef</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a723"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0600</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a724"></a>            <span class="src-var">$ext_ref </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getRefIndex">_getRefIndex</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a725"></a>        <span class="src-sym">}</span></li>
<li><a name="a726"></a>&nbsp;</li>
<li><a name="a727"></a>        <span class="src-comm">// Convert the cell reference part</span></li>
<li><a name="a728"></a>        list<span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">) </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a729"></a>&nbsp;</li>
<li><a name="a730"></a>        <span class="src-comm">// The ptg value depends on the class of the ptg.</span></li>
<li><a name="a731"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a732"></a>            <span class="src-var">$ptgRef </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgRef3d'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a733"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a734"></a>            <span class="src-var">$ptgRef </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgRef3dV'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a735"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$class </span>== <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a736"></a>            <span class="src-var">$ptgRef </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">&quot;C&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">ptg</span><span class="src-sym">[</span><span class="src-str">'ptgRef3dA'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a737"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a738"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">class</span> <span class="src-var">$class</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a739"></a>        <span class="src-sym">}</span></li>
<li><a name="a740"></a>&nbsp;</li>
<li><a name="a741"></a>        <span class="src-key">return </span><span class="src-var">$ptgRef </span>. <span class="src-var">$ext_ref</span>. <span class="src-var">$row </span>. <span class="src-var">$col</span><span class="src-sym">;</span></li>
<li><a name="a742"></a>    <span class="src-sym">}</span></li>
<li><a name="a743"></a>&nbsp;</li>
<li><a name="a744"></a>    <span class="src-doc">/**</span></li>
<li><a name="a745"></a><span class="src-doc">    * Convert the sheet name part of an external reference, for example &quot;Sheet1&quot; or</span></li>
<li><a name="a746"></a><span class="src-doc">    * &quot;Sheet1:Sheet2&quot;, to a packed structure.</span></li>
<li><a name="a747"></a><span class="src-doc">    *</span></li>
<li><a name="a748"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a749"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$ext_ref </span><span class="src-doc">The name of the external reference</span></li>
<li><a name="a750"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span><span class="src-doc">The reference index in packed() format</span></li>
<li><a name="a751"></a><span class="src-doc">    */</span></li>
<li><a name="a752"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_packExtRef">_packExtRef</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span></li>
<li><a name="a753"></a>    <span class="src-sym">{</span></li>
<li><a name="a754"></a>        <span class="src-var">$ext_ref </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/^'/&quot;</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-comm">// Remove leading  ' if any.</span></li>
<li><a name="a755"></a>        <span class="src-var">$ext_ref </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/'$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-comm">// Remove trailing ' if any.</span></li>
<li><a name="a756"></a>&nbsp;</li>
<li><a name="a757"></a>        <span class="src-comm">// Check if there is a sheet range eg., Sheet1:Sheet2.</span></li>
<li><a name="a758"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/:/&quot;</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a759"></a>            list<span class="src-sym">(</span><span class="src-var">$sheet_name1</span><span class="src-sym">, </span><span class="src-var">$sheet_name2</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">':'</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a760"></a>&nbsp;</li>
<li><a name="a761"></a>            <span class="src-var">$sheet1 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$sheet_name1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a762"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet1 </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a763"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">sheet</span> <span class="src-id">name</span> <span class="src-var">$sheet_name1</span> <span class="src-id">in</span> <span class="src-id">formula</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a764"></a>            <span class="src-sym">}</span></li>
<li><a name="a765"></a>            <span class="src-var">$sheet2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$sheet_name2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a766"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet2 </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a767"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">sheet</span> <span class="src-id">name</span> <span class="src-var">$sheet_name2</span> <span class="src-id">in</span> <span class="src-id">formula</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a768"></a>            <span class="src-sym">}</span></li>
<li><a name="a769"></a>&nbsp;</li>
<li><a name="a770"></a>            <span class="src-comm">// Reverse max and min sheet numbers if necessary</span></li>
<li><a name="a771"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet1 </span>&gt; <span class="src-var">$sheet2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a772"></a>                list<span class="src-sym">(</span><span class="src-var">$sheet1</span><span class="src-sym">, </span><span class="src-var">$sheet2</span><span class="src-sym">) </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$sheet2</span><span class="src-sym">, </span><span class="src-var">$sheet1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a773"></a>            <span class="src-sym">}</span></li>
<li><a name="a774"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-comm">// Single sheet name only.</span></li>
<li><a name="a775"></a>            <span class="src-var">$sheet1 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a776"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet1 </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a777"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">sheet</span> <span class="src-id">name</span> <span class="src-var">$ext_ref</span> <span class="src-id">in</span> <span class="src-id">formula</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a778"></a>            <span class="src-sym">}</span></li>
<li><a name="a779"></a>            <span class="src-var">$sheet2 </span>= <span class="src-var">$sheet1</span><span class="src-sym">;</span></li>
<li><a name="a780"></a>        <span class="src-sym">}</span></li>
<li><a name="a781"></a>&nbsp;</li>
<li><a name="a782"></a>        <span class="src-comm">// References are stored relative to 0xFFFF.</span></li>
<li><a name="a783"></a>        <span class="src-var">$offset </span>= -<span class="src-num">1 </span>- <span class="src-var">$sheet1</span><span class="src-sym">;</span></li>
<li><a name="a784"></a>&nbsp;</li>
<li><a name="a785"></a>        <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'vdvv'</span><span class="src-sym">, </span><span class="src-var">$offset</span><span class="src-sym">, </span><span class="src-num">0x00</span><span class="src-sym">, </span><span class="src-var">$sheet1</span><span class="src-sym">, </span><span class="src-var">$sheet2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a786"></a>    <span class="src-sym">}</span></li>
<li><a name="a787"></a>&nbsp;</li>
<li><a name="a788"></a>    <span class="src-doc">/**</span></li>
<li><a name="a789"></a><span class="src-doc">    * Look up the REF index that corresponds to an external sheet name</span></li>
<li><a name="a790"></a><span class="src-doc">    * (or range). If it doesn't exist yet add it to the workbook's references</span></li>
<li><a name="a791"></a><span class="src-doc">    * array. It assumes all sheet names given must exist.</span></li>
<li><a name="a792"></a><span class="src-doc">    *</span></li>
<li><a name="a793"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a794"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$ext_ref </span><span class="src-doc">The name of the external reference</span></li>
<li><a name="a795"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The reference index in packed() format on success</span></li>
<li><a name="a796"></a><span class="src-doc">    */</span></li>
<li><a name="a797"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getRefIndex">_getRefIndex</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span></li>
<li><a name="a798"></a>    <span class="src-sym">{</span></li>
<li><a name="a799"></a>        <span class="src-var">$ext_ref </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/^'/&quot;</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-comm">// Remove leading  ' if any.</span></li>
<li><a name="a800"></a>        <span class="src-var">$ext_ref </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/'$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-comm">// Remove trailing ' if any.</span></li>
<li><a name="a801"></a>&nbsp;</li>
<li><a name="a802"></a>        <span class="src-comm">// Check if there is a sheet range eg., Sheet1:Sheet2.</span></li>
<li><a name="a803"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/:/&quot;</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a804"></a>            list<span class="src-sym">(</span><span class="src-var">$sheet_name1</span><span class="src-sym">, </span><span class="src-var">$sheet_name2</span><span class="src-sym">) </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">':'</span><span class="src-sym">, </span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a805"></a>&nbsp;</li>
<li><a name="a806"></a>            <span class="src-var">$sheet1 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$sheet_name1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a807"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet1 </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a808"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">sheet</span> <span class="src-id">name</span> <span class="src-var">$sheet_name1</span> <span class="src-id">in</span> <span class="src-id">formula</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a809"></a>            <span class="src-sym">}</span></li>
<li><a name="a810"></a>            <span class="src-var">$sheet2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$sheet_name2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a811"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet2 </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a812"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">sheet</span> <span class="src-id">name</span> <span class="src-var">$sheet_name2</span> <span class="src-id">in</span> <span class="src-id">formula</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a813"></a>            <span class="src-sym">}</span></li>
<li><a name="a814"></a>&nbsp;</li>
<li><a name="a815"></a>            <span class="src-comm">// Reverse max and min sheet numbers if necessary</span></li>
<li><a name="a816"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet1 </span>&gt; <span class="src-var">$sheet2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a817"></a>                list<span class="src-sym">(</span><span class="src-var">$sheet1</span><span class="src-sym">, </span><span class="src-var">$sheet2</span><span class="src-sym">) </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$sheet2</span><span class="src-sym">, </span><span class="src-var">$sheet1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a818"></a>            <span class="src-sym">}</span></li>
<li><a name="a819"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-comm">// Single sheet name only.</span></li>
<li><a name="a820"></a>            <span class="src-var">$sheet1 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$ext_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a821"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sheet1 </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a822"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Unknown</span> <span class="src-id">sheet</span> <span class="src-id">name</span> <span class="src-var">$ext_ref</span> <span class="src-id">in</span> <span class="src-id">formula</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a823"></a>            <span class="src-sym">}</span></li>
<li><a name="a824"></a>            <span class="src-var">$sheet2 </span>= <span class="src-var">$sheet1</span><span class="src-sym">;</span></li>
<li><a name="a825"></a>        <span class="src-sym">}</span></li>
<li><a name="a826"></a>&nbsp;</li>
<li><a name="a827"></a>        <span class="src-comm">// assume all references belong to this document</span></li>
<li><a name="a828"></a>        <span class="src-var">$supbook_index </span>= <span class="src-num">0x00</span><span class="src-sym">;</span></li>
<li><a name="a829"></a>        <span class="src-var">$ref </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'vvv'</span><span class="src-sym">, </span><span class="src-var">$supbook_index</span><span class="src-sym">, </span><span class="src-var">$sheet1</span><span class="src-sym">, </span><span class="src-var">$sheet2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a830"></a>        <span class="src-var">$total_references </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_references">_references</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a831"></a>        <span class="src-var">$index </span>= -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a832"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-var">$total_references</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a833"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ref </span>== <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_references">_references</a><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a834"></a>                <span class="src-var">$index </span>= <span class="src-var">$i</span><span class="src-sym">;</span></li>
<li><a name="a835"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a836"></a>            <span class="src-sym">}</span></li>
<li><a name="a837"></a>        <span class="src-sym">}</span></li>
<li><a name="a838"></a>        <span class="src-comm">// if REF was not found add it to references array</span></li>
<li><a name="a839"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$index </span>== -<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a840"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_references">_references</a><span class="src-sym">[</span><span class="src-var">$total_references</span><span class="src-sym">] </span>= <span class="src-var">$ref</span><span class="src-sym">;</span></li>
<li><a name="a841"></a>            <span class="src-var">$index </span>= <span class="src-var">$total_references</span><span class="src-sym">;</span></li>
<li><a name="a842"></a>        <span class="src-sym">}</span></li>
<li><a name="a843"></a>&nbsp;</li>
<li><a name="a844"></a>        <span class="src-key">return </span><a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$index</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a845"></a>    <span class="src-sym">}</span></li>
<li><a name="a846"></a>&nbsp;</li>
<li><a name="a847"></a>    <span class="src-doc">/**</span></li>
<li><a name="a848"></a><span class="src-doc">    * Look up the index that corresponds to an external sheet name. The hash of</span></li>
<li><a name="a849"></a><span class="src-doc">    * sheet names is updated by the addworksheet() method of the</span></li>
<li><a name="a850"></a><span class="src-doc">    * PHPExcel_Writer_Excel5_Workbook class.</span></li>
<li><a name="a851"></a><span class="src-doc">    *</span></li>
<li><a name="a852"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a853"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">integer </span><span class="src-doc">The sheet index, -1 if the sheet was not found</span></li>
<li><a name="a854"></a><span class="src-doc">    */</span></li>
<li><a name="a855"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_getSheetIndex">_getSheetIndex</a><span class="src-sym">(</span><span class="src-var">$sheet_name</span><span class="src-sym">)</span></li>
<li><a name="a856"></a>    <span class="src-sym">{</span></li>
<li><a name="a857"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_ext_sheets">_ext_sheets</a><span class="src-sym">[</span><span class="src-var">$sheet_name</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a858"></a>            <span class="src-key">return </span>-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a859"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a860"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_ext_sheets">_ext_sheets</a><span class="src-sym">[</span><span class="src-var">$sheet_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a861"></a>        <span class="src-sym">}</span></li>
<li><a name="a862"></a>    <span class="src-sym">}</span></li>
<li><a name="a863"></a>&nbsp;</li>
<li><a name="a864"></a>    <span class="src-doc">/**</span></li>
<li><a name="a865"></a><span class="src-doc">    * This method is used to update the array of sheet names. It is</span></li>
<li><a name="a866"></a><span class="src-doc">    * called by the addWorksheet() method of the</span></li>
<li><a name="a867"></a><span class="src-doc">    * PHPExcel_Writer_Excel5_Workbook class.</span></li>
<li><a name="a868"></a><span class="src-doc">    *</span></li>
<li><a name="a869"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> public</span></li>
<li><a name="a870"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@see</span><span class="src-doc"> PHPExcel_Writer_Excel5_Workbook::addWorksheet()</span></li>
<li><a name="a871"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc"> </span><span class="src-doc-var">$name </span><span class="src-doc"> The name of the worksheet being added</span></li>
<li><a name="a872"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">integer </span><span class="src-doc-var">$index </span><span class="src-doc">The index of the worksheet being added</span></li>
<li><a name="a873"></a><span class="src-doc">    */</span></li>
<li><a name="a874"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodsetExtSheet">setExtSheet</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">, </span><span class="src-var">$index</span><span class="src-sym">)</span></li>
<li><a name="a875"></a>    <span class="src-sym">{</span></li>
<li><a name="a876"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_ext_sheets">_ext_sheets</a><span class="src-sym">[</span><span class="src-var">$name</span><span class="src-sym">] </span>= <span class="src-var">$index</span><span class="src-sym">;</span></li>
<li><a name="a877"></a>    <span class="src-sym">}</span></li>
<li><a name="a878"></a>&nbsp;</li>
<li><a name="a879"></a>    <span class="src-doc">/**</span></li>
<li><a name="a880"></a><span class="src-doc">    * pack() row and column into the required 3 or 4 byte format.</span></li>
<li><a name="a881"></a><span class="src-doc">    *</span></li>
<li><a name="a882"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a883"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$cell </span><span class="src-doc">The Excel cell reference to be packed</span></li>
<li><a name="a884"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">array </span><span class="src-doc">Array containing the row and column in packed() format</span></li>
<li><a name="a885"></a><span class="src-doc">    */</span></li>
<li><a name="a886"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToPackedRowcol">_cellToPackedRowcol</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span></li>
<li><a name="a887"></a>    <span class="src-sym">{</span></li>
<li><a name="a888"></a>        <span class="src-var">$cell </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a889"></a>        list<span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">, </span><span class="src-var">$row_rel</span><span class="src-sym">, </span><span class="src-var">$col_rel</span><span class="src-sym">) </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToRowcol">_cellToRowcol</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a890"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$col </span>&gt;= <span class="src-num">256</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a891"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Column</span> <span class="src-id">in</span>: <span class="src-var">$cell</span> <span class="src-id">greater</span> <span class="src-id">than</span> 255</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a892"></a>        <span class="src-sym">}</span></li>
<li><a name="a893"></a>        <span class="src-comm">// FIXME: change for BIFF8</span></li>
<li><a name="a894"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$row </span>&gt;= <span class="src-num">16384</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a895"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Row</span> <span class="src-id">in</span>: <span class="src-var">$cell</span> <span class="src-id">greater</span> <span class="src-id">than</span> 16384 </span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a896"></a>        <span class="src-sym">}</span></li>
<li><a name="a897"></a>&nbsp;</li>
<li><a name="a898"></a>        <span class="src-comm">// Set the high bits to indicate if row or col are relative.</span></li>
<li><a name="a899"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0500</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a900"></a>            <span class="src-var">$row    </span>|= <span class="src-var">$col_rel </span>&lt;&lt; <span class="src-num">14</span><span class="src-sym">;</span></li>
<li><a name="a901"></a>            <span class="src-var">$row    </span>|= <span class="src-var">$row_rel </span>&lt;&lt; <span class="src-num">15</span><span class="src-sym">;</span></li>
<li><a name="a902"></a>            <span class="src-var">$col     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'C'</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a903"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0600</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a904"></a>            <span class="src-var">$col    </span>|= <span class="src-var">$col_rel </span>&lt;&lt; <span class="src-num">14</span><span class="src-sym">;</span></li>
<li><a name="a905"></a>            <span class="src-var">$col    </span>|= <span class="src-var">$row_rel </span>&lt;&lt; <span class="src-num">15</span><span class="src-sym">;</span></li>
<li><a name="a906"></a>            <span class="src-var">$col     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a907"></a>        <span class="src-sym">}</span></li>
<li><a name="a908"></a>        <span class="src-var">$row     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$row</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a909"></a>&nbsp;</li>
<li><a name="a910"></a>        <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a911"></a>    <span class="src-sym">}</span></li>
<li><a name="a912"></a>&nbsp;</li>
<li><a name="a913"></a>    <span class="src-doc">/**</span></li>
<li><a name="a914"></a><span class="src-doc">    * pack() row range into the required 3 or 4 byte format.</span></li>
<li><a name="a915"></a><span class="src-doc">    * Just using maximum col/rows, which is probably not the correct solution</span></li>
<li><a name="a916"></a><span class="src-doc">    *</span></li>
<li><a name="a917"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a918"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$range </span><span class="src-doc">The Excel range to be packed</span></li>
<li><a name="a919"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">array </span><span class="src-doc">Array containing (row1,col1,row2,col2) in packed() format</span></li>
<li><a name="a920"></a><span class="src-doc">    */</span></li>
<li><a name="a921"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_rangeToPackedRange">_rangeToPackedRange</a><span class="src-sym">(</span><span class="src-var">$range</span><span class="src-sym">)</span></li>
<li><a name="a922"></a>    <span class="src-sym">{</span></li>
<li><a name="a923"></a>        <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/(\$)?(\d+)\:(\$)?(\d+)/'</span><span class="src-sym">, </span><span class="src-var">$range</span><span class="src-sym">, </span><span class="src-var">$match</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a924"></a>        <span class="src-comm">// return absolute rows if there is a $ in the ref</span></li>
<li><a name="a925"></a>        <span class="src-var">$row1_rel </span>= <span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">) </span>? <span class="src-num">1 </span>: <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a926"></a>        <span class="src-var">$row1     </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a927"></a>        <span class="src-var">$row2_rel </span>= <span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>? <span class="src-num">1 </span>: <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a928"></a>        <span class="src-var">$row2     </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a929"></a>        <span class="src-comm">// Convert 1-index to zero-index</span></li>
<li><a name="a930"></a>        <span class="src-var">$row1</span>--<span class="src-sym">;</span></li>
<li><a name="a931"></a>        <span class="src-var">$row2</span>--<span class="src-sym">;</span></li>
<li><a name="a932"></a>        <span class="src-comm">// Trick poor inocent Excel</span></li>
<li><a name="a933"></a>        <span class="src-var">$col1 </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a934"></a>        <span class="src-var">$col2 </span>= <span class="src-num">16383</span><span class="src-sym">; </span><span class="src-comm">// FIXME: maximum possible value for Excel 5 (change this!!!)</span></li>
<li><a name="a935"></a>&nbsp;</li>
<li><a name="a936"></a>        <span class="src-comm">// FIXME: this changes for BIFF8</span></li>
<li><a name="a937"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$row1 </span>&gt;= <span class="src-num">16384</span><span class="src-sym">) </span><span class="src-key">or </span><span class="src-sym">(</span><span class="src-var">$row2 </span>&gt;= <span class="src-num">16384</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a938"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Row</span> <span class="src-id">in</span>: <span class="src-var">$range</span> <span class="src-id">greater</span> <span class="src-id">than</span> 16384 </span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a939"></a>        <span class="src-sym">}</span></li>
<li><a name="a940"></a>&nbsp;</li>
<li><a name="a941"></a>        <span class="src-comm">// Set the high bits to indicate if rows are relative.</span></li>
<li><a name="a942"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0500</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a943"></a>            <span class="src-var">$row1    </span>|= <span class="src-var">$row1_rel </span>&lt;&lt; <span class="src-num">14</span><span class="src-sym">; </span><span class="src-comm">// FIXME: probably a bug</span></li>
<li><a name="a944"></a>            <span class="src-var">$row2    </span>|= <span class="src-var">$row2_rel </span>&lt;&lt; <span class="src-num">15</span><span class="src-sym">;</span></li>
<li><a name="a945"></a>            <span class="src-var">$col1     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'C'</span><span class="src-sym">, </span><span class="src-var">$col1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a946"></a>            <span class="src-var">$col2     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'C'</span><span class="src-sym">, </span><span class="src-var">$col2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a947"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_BIFF_version">_BIFF_version</a> == <span class="src-num">0x0600</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a948"></a>            <span class="src-var">$col1    </span>|= <span class="src-var">$row1_rel </span>&lt;&lt; <span class="src-num">15</span><span class="src-sym">;</span></li>
<li><a name="a949"></a>            <span class="src-var">$col2    </span>|= <span class="src-var">$row2_rel </span>&lt;&lt; <span class="src-num">15</span><span class="src-sym">;</span></li>
<li><a name="a950"></a>            <span class="src-var">$col1     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$col1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a951"></a>            <span class="src-var">$col2     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$col2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a952"></a>        <span class="src-sym">}</span></li>
<li><a name="a953"></a>        <span class="src-var">$row1     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$row1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a954"></a>        <span class="src-var">$row2     </span>= <a href="http://www.php.net/pack">pack</a><span class="src-sym">(</span><span class="src-str">'v'</span><span class="src-sym">, </span><span class="src-var">$row2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a955"></a>&nbsp;</li>
<li><a name="a956"></a>        <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$row1</span><span class="src-sym">, </span><span class="src-var">$col1</span><span class="src-sym">, </span><span class="src-var">$row2</span><span class="src-sym">, </span><span class="src-var">$col2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a957"></a>    <span class="src-sym">}</span></li>
<li><a name="a958"></a>&nbsp;</li>
<li><a name="a959"></a>    <span class="src-doc">/**</span></li>
<li><a name="a960"></a><span class="src-doc">    * Convert an Excel cell reference such as A1 or $B2 or C$3 or $D$4 to a zero</span></li>
<li><a name="a961"></a><span class="src-doc">    * indexed row and column number. Also returns two (0,1) values to indicate</span></li>
<li><a name="a962"></a><span class="src-doc">    * whether the row or column are relative references.</span></li>
<li><a name="a963"></a><span class="src-doc">    *</span></li>
<li><a name="a964"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a965"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$cell </span><span class="src-doc">The Excel cell reference in A1 format.</span></li>
<li><a name="a966"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">array </span></li>
<li><a name="a967"></a><span class="src-doc">    */</span></li>
<li><a name="a968"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_cellToRowcol">_cellToRowcol</a><span class="src-sym">(</span><span class="src-var">$cell</span><span class="src-sym">)</span></li>
<li><a name="a969"></a>    <span class="src-sym">{</span></li>
<li><a name="a970"></a>        <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/(\$)?([A-I]?[A-Z])(\$)?(\d+)/'</span><span class="src-sym">,</span><span class="src-var">$cell</span><span class="src-sym">,</span><span class="src-var">$match</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a971"></a>        <span class="src-comm">// return absolute column if there is a $ in the ref</span></li>
<li><a name="a972"></a>        <span class="src-var">$col_rel </span>= <span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">) </span>? <span class="src-num">1 </span>: <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a973"></a>        <span class="src-var">$col_ref </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a974"></a>        <span class="src-var">$row_rel </span>= <span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>? <span class="src-num">1 </span>: <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a975"></a>        <span class="src-var">$row     </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a976"></a>&nbsp;</li>
<li><a name="a977"></a>        <span class="src-comm">// Convert base26 column string to a number.</span></li>
<li><a name="a978"></a>        <span class="src-var">$expn   </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$col_ref</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a979"></a>        <span class="src-var">$col    </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a980"></a>        <span class="src-var">$col_ref_length </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$col_ref</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a981"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-var">$col_ref_length</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a982"></a>            <span class="src-var">$col </span>+= <span class="src-sym">(</span><a href="http://www.php.net/ord">ord</a><span class="src-sym">(</span><span class="src-var">$col_ref</span><span class="src-sym">{</span><span class="src-var">$i</span><span class="src-sym">}</span><span class="src-sym">) </span>- <a href="http://www.php.net/ord">ord</a><span class="src-sym">(</span><span class="src-str">'A'</span><span class="src-sym">) </span>+ <span class="src-num">1</span><span class="src-sym">) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">26</span><span class="src-sym">, </span><span class="src-var">$expn</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a983"></a>            <span class="src-var">$expn</span>--<span class="src-sym">;</span></li>
<li><a name="a984"></a>        <span class="src-sym">}</span></li>
<li><a name="a985"></a>&nbsp;</li>
<li><a name="a986"></a>        <span class="src-comm">// Convert 1-index to zero-index</span></li>
<li><a name="a987"></a>        <span class="src-var">$row</span>--<span class="src-sym">;</span></li>
<li><a name="a988"></a>        <span class="src-var">$col</span>--<span class="src-sym">;</span></li>
<li><a name="a989"></a>&nbsp;</li>
<li><a name="a990"></a>        <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">, </span><span class="src-var">$col</span><span class="src-sym">, </span><span class="src-var">$row_rel</span><span class="src-sym">, </span><span class="src-var">$col_rel</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a991"></a>    <span class="src-sym">}</span></li>
<li><a name="a992"></a>&nbsp;</li>
<li><a name="a993"></a>    <span class="src-doc">/**</span></li>
<li><a name="a994"></a><span class="src-doc">    * Advance to the next valid token.</span></li>
<li><a name="a995"></a><span class="src-doc">    *</span></li>
<li><a name="a996"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a997"></a><span class="src-doc">    */</span></li>
<li><a name="a998"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a999"></a>    <span class="src-sym">{</span></li>
<li><a name="a1000"></a>        <span class="src-var">$i </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_char">_current_char</a><span class="src-sym">;</span></li>
<li><a name="a1001"></a>        <span class="src-var">$formula_length </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1002"></a>        <span class="src-comm">// eat up white spaces</span></li>
<li><a name="a1003"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>&lt; <span class="src-var">$formula_length</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1004"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a><span class="src-sym">{</span><span class="src-var">$i</span><span class="src-sym">} </span>== <span class="src-str">&quot; &quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1005"></a>                <span class="src-var">$i</span>++<span class="src-sym">;</span></li>
<li><a name="a1006"></a>            <span class="src-sym">}</span></li>
<li><a name="a1007"></a>&nbsp;</li>
<li><a name="a1008"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>&lt; <span class="src-sym">(</span><span class="src-var">$formula_length </span>- <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1009"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> = <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a><span class="src-sym">{</span><span class="src-var">$i</span>+<span class="src-num">1</span><span class="src-sym">}</span><span class="src-sym">;</span></li>
<li><a name="a1010"></a>            <span class="src-sym">}</span></li>
<li><a name="a1011"></a>            <span class="src-var">$token </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a1012"></a>        <span class="src-sym">}</span></li>
<li><a name="a1013"></a>&nbsp;</li>
<li><a name="a1014"></a>        <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$i </span>&lt; <span class="src-var">$formula_length</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1015"></a>            <span class="src-var">$token </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a></span><span class="src-sym">{</span><span class="src-var">$i</span><span class="src-sym">}</span><span class="src-sym">;</span></li>
<li><a name="a1016"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>&lt; <span class="src-sym">(</span><span class="src-var">$formula_length </span>- <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1017"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a></span><span class="src-sym">{</span><span class="src-var">$i</span>+<span class="src-num">1</span><span class="src-sym">}</span><span class="src-sym">;</span></li>
<li><a name="a1018"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1019"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a1020"></a>            <span class="src-sym">}</span></li>
<li><a name="a1021"></a>&nbsp;</li>
<li><a name="a1022"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_match">_match</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">) </span>!= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1023"></a>                <span class="src-comm">//if ($i &lt; strlen($this-&gt;_formula) - 1) {</span></li>
<li><a name="a1024"></a><span class="src-comm">//    $this-&gt;_lookahead = $this-&gt;_formula{$i+1};</span></li>
<li><a name="a1025"></a>                <span class="src-comm">//}</span></li>
<li><a name="a1025"></a>                </li>
<li><a name="a1026"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_char">_current_char</a> </span>= <span class="src-var">$i </span>+ <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1027"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>= <span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1028"></a>                <span class="src-key">return </span><span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1029"></a>            <span class="src-sym">}</span></li>
<li><a name="a1030"></a>&nbsp;</li>
<li><a name="a1031"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>&lt; <span class="src-sym">(</span><span class="src-var">$formula_length </span>- <span class="src-num">2</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1032"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a></span><span class="src-sym">{</span><span class="src-var">$i</span>+<span class="src-num">2</span><span class="src-sym">}</span><span class="src-sym">;</span></li>
<li><a name="a1033"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-comm">// if we run out of characters _lookahead becomes empty</span></li>
<li><a name="a1034"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a1035"></a>            <span class="src-sym">}</span></li>
<li><a name="a1036"></a>            <span class="src-var">$i</span>++<span class="src-sym">;</span></li>
<li><a name="a1037"></a>        <span class="src-sym">}</span></li>
<li><a name="a1038"></a>        <span class="src-comm">//die(&quot;Lexical error &quot;.$this-&gt;_current_char);</span></li>
<li><a name="a1039"></a>    <span class="src-sym">}</span></li>
<li><a name="a1040"></a>&nbsp;</li>
<li><a name="a1041"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1042"></a><span class="src-doc">    * Checks if it's a valid token.</span></li>
<li><a name="a1043"></a><span class="src-doc">    *</span></li>
<li><a name="a1044"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1045"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">mixed </span><span class="src-doc-var">$token </span><span class="src-doc">The token to check.</span></li>
<li><a name="a1046"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">      The checked token or false on failure</span></li>
<li><a name="a1047"></a><span class="src-doc">    */</span></li>
<li><a name="a1048"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_match">_match</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">)</span></li>
<li><a name="a1049"></a>    <span class="src-sym">{</span></li>
<li><a name="a1050"></a>        <span class="src-key">switch</span><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1051"></a>            <span class="src-key">case </span><span class="src-str">&quot;+&quot;</span>:</li>
<li><a name="a1052"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1053"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1054"></a>            <span class="src-key">case </span><span class="src-str">&quot;-&quot;</span>:</li>
<li><a name="a1055"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1056"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1057"></a>            <span class="src-key">case </span><span class="src-str">&quot;*&quot;</span>:</li>
<li><a name="a1058"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1059"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1060"></a>            <span class="src-key">case </span><span class="src-str">&quot;/&quot;</span>:</li>
<li><a name="a1061"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1062"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1063"></a>            <span class="src-key">case </span><span class="src-str">&quot;(&quot;</span>:</li>
<li><a name="a1064"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1065"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1066"></a>            <span class="src-key">case </span><span class="src-str">&quot;)&quot;</span>:</li>
<li><a name="a1067"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1068"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1069"></a>            <span class="src-key">case </span><span class="src-str">&quot;,&quot;</span>:</li>
<li><a name="a1070"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1071"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1072"></a>            <span class="src-key">case </span><span class="src-str">&quot;;&quot;</span>:</li>
<li><a name="a1073"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1074"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1075"></a>            <span class="src-key">case </span><span class="src-str">&quot;&gt;&quot;</span>:</li>
<li><a name="a1076"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>== <span class="src-str">'='</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-comm">// it's a GE token</span></li>
<li><a name="a1077"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1078"></a>                <span class="src-sym">}</span></li>
<li><a name="a1079"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1080"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1081"></a>            <span class="src-key">case </span><span class="src-str">&quot;&lt;&quot;</span>:</li>
<li><a name="a1082"></a>                <span class="src-comm">// it's a LE or a NE token</span></li>
<li><a name="a1083"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>== <span class="src-str">'='</span><span class="src-sym">) </span><span class="src-key">or </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>== <span class="src-str">'&gt;'</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1084"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1085"></a>                <span class="src-sym">}</span></li>
<li><a name="a1086"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1087"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1088"></a>            <span class="src-key">case </span><span class="src-str">&quot;&gt;=&quot;</span>:</li>
<li><a name="a1089"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1090"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1091"></a>            <span class="src-key">case </span><span class="src-str">&quot;&lt;=&quot;</span>:</li>
<li><a name="a1092"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1093"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1094"></a>            <span class="src-key">case </span><span class="src-str">&quot;=&quot;</span>:</li>
<li><a name="a1095"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1096"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1097"></a>            <span class="src-key">case </span><span class="src-str">&quot;&lt;&gt;&quot;</span>:</li>
<li><a name="a1098"></a>                <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1099"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1100"></a>            <span class="src-key">default</span>:</li>
<li><a name="a1101"></a>                <span class="src-comm">// if it's a reference</span></li>
<li><a name="a1102"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^\$?[A-Ia-i]?[A-Za-z]\$?[0-9]+$/'</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1103"></a>                   <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">) </span><span class="src-key">and </span></li>
<li><a name="a1104"></a>                   <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">':'</span><span class="src-sym">) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">'.'</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1105"></a>                   <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">'!'</span><span class="src-sym">))</span></li>
<li><a name="a1106"></a>                <span class="src-sym">{</span></li>
<li><a name="a1107"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1108"></a>                <span class="src-sym">}</span></li>
<li><a name="a1109"></a>                <span class="src-comm">// If it's an external reference (Sheet1!A1 or Sheet1:Sheet2!A1)</span></li>
<li><a name="a1110"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\w+(\:\w+)?\!<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1111"></a>                       <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1112"></a>                       <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">':'</span><span class="src-sym">) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">'.'</span><span class="src-sym">))</span></li>
<li><a name="a1113"></a>                <span class="src-sym">{</span></li>
<li><a name="a1114"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1115"></a>                <span class="src-sym">}</span></li>
<li><a name="a1116"></a>                <span class="src-comm">// If it's an external reference ('Sheet1'!A1 or 'Sheet1:Sheet2'!A1)</span></li>
<li><a name="a1117"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^'<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+(\:<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+)?'\!<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1118"></a>                       <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1119"></a>                       <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">':'</span><span class="src-sym">) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">'.'</span><span class="src-sym">))</span></li>
<li><a name="a1120"></a>                <span class="src-sym">{</span></li>
<li><a name="a1121"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1122"></a>                <span class="src-sym">}</span></li>
<li><a name="a1123"></a>                <span class="src-comm">// if it's a range (A1:A2)</span></li>
<li><a name="a1124"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+:(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and </span></li>
<li><a name="a1125"></a>                       <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">))</span></li>
<li><a name="a1126"></a>                <span class="src-sym">{</span></li>
<li><a name="a1127"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1128"></a>                <span class="src-sym">}</span></li>
<li><a name="a1129"></a>                <span class="src-comm">// if it's a range (A1..A2)</span></li>
<li><a name="a1130"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+\.\.(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and </span></li>
<li><a name="a1131"></a>                       <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">))</span></li>
<li><a name="a1132"></a>                <span class="src-sym">{</span></li>
<li><a name="a1133"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1134"></a>                <span class="src-sym">}</span></li>
<li><a name="a1135"></a>                <span class="src-comm">// If it's an external range like Sheet1!A1 or Sheet1:Sheet2!A1:B2</span></li>
<li><a name="a1136"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\w+(\:\w+)?\!(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1137"></a>                       <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">))</span></li>
<li><a name="a1138"></a>                <span class="src-sym">{</span></li>
<li><a name="a1139"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1140"></a>                <span class="src-sym">}</span></li>
<li><a name="a1141"></a>                <span class="src-comm">// If it's an external range like 'Sheet1'!A1 or 'Sheet1:Sheet2'!A1:B2</span></li>
<li><a name="a1142"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^'<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+(\:<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+)?'\!(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1143"></a>                       <span class="src-sym">!</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;[0-9]&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">))</span></li>
<li><a name="a1144"></a>                <span class="src-sym">{</span></li>
<li><a name="a1145"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1146"></a>                <span class="src-sym">}</span></li>
<li><a name="a1147"></a>                <span class="src-comm">// If it's a number (check that it's not a sheet name or range)</span></li>
<li><a name="a1148"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and </span></li>
<li><a name="a1149"></a>                        <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$token</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span><span class="src-sym">) </span><span class="src-key">or </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>== <span class="src-str">''</span><span class="src-sym">)) </span><span class="src-key">and</span></li>
<li><a name="a1150"></a>                        <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">'!'</span><span class="src-sym">) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>!= <span class="src-str">':'</span><span class="src-sym">))</span></li>
<li><a name="a1151"></a>                <span class="src-sym">{</span></li>
<li><a name="a1152"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1153"></a>                <span class="src-sym">}</span></li>
<li><a name="a1154"></a>                <span class="src-comm">// If it's a string (of maximum 255 characters)</span></li>
<li><a name="a1155"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">^\&quot;<span class="src-sym">[</span>^\&quot;<span class="src-sym">]</span><span class="src-sym">{</span>0,255<span class="src-sym">}</span>\&quot;$</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">))</span></li>
<li><a name="a1156"></a>                <span class="src-sym">{</span></li>
<li><a name="a1157"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1158"></a>                <span class="src-sym">}</span></li>
<li><a name="a1159"></a>                <span class="src-comm">// if it's a function call</span></li>
<li><a name="a1160"></a>                <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/eregi">eregi</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">^<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Z0</span>-9\xc0-\xdc\.<span class="src-sym">]</span>+$</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$token</span><span class="src-sym">) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a> </span>== <span class="src-str">&quot;(&quot;</span><span class="src-sym">))</span></li>
<li><a name="a1161"></a>                <span class="src-sym">{</span></li>
<li><a name="a1162"></a>                    <span class="src-key">return </span><span class="src-var">$token</span><span class="src-sym">;</span></li>
<li><a name="a1163"></a>                <span class="src-sym">}</span></li>
<li><a name="a1164"></a>                <span class="src-key">return </span><span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a1165"></a>        <span class="src-sym">}</span></li>
<li><a name="a1166"></a>    <span class="src-sym">}</span></li>
<li><a name="a1167"></a>&nbsp;</li>
<li><a name="a1168"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1169"></a><span class="src-doc">    * The parsing method. It parses a formula.</span></li>
<li><a name="a1170"></a><span class="src-doc">    *</span></li>
<li><a name="a1171"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> public</span></li>
<li><a name="a1172"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$formula </span><span class="src-doc">The formula to parse, without the initial equal</span></li>
<li><a name="a1173"></a><span class="src-doc">    *                         sign (=).</span></li>
<li><a name="a1174"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">true on success</span></li>
<li><a name="a1175"></a><span class="src-doc">    */</span></li>
<li><a name="a1176"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodparse">parse</a><span class="src-sym">(</span><span class="src-var">$formula</span><span class="src-sym">)</span></li>
<li><a name="a1177"></a>    <span class="src-sym">{</span></li>
<li><a name="a1178"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_char">_current_char</a> </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1179"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_formula">_formula</a>      </span>= <span class="src-var">$formula</span><span class="src-sym">;</span></li>
<li><a name="a1180"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a>    </span>= <span class="src-var">$formula</span><span class="src-sym">{</span><span class="src-num">1</span><span class="src-sym">}</span><span class="src-sym">;</span></li>
<li><a name="a1181"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1182"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_parse_tree">_parse_tree</a>   </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_condition">_condition</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1183"></a>        <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1184"></a>    <span class="src-sym">}</span></li>
<li><a name="a1185"></a>&nbsp;</li>
<li><a name="a1186"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1187"></a><span class="src-doc">    * It parses a condition. It assumes the following rule:</span></li>
<li><a name="a1188"></a><span class="src-doc">    * Cond -&gt; Expr [(&quot;&gt;&quot; | &quot;&lt;&quot;) Expr]</span></li>
<li><a name="a1189"></a><span class="src-doc">    *</span></li>
<li><a name="a1190"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1191"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The parsed ptg'd tree on success</span></li>
<li><a name="a1192"></a><span class="src-doc">    */</span></li>
<li><a name="a1193"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_condition">_condition</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a1194"></a>    <span class="src-sym">{</span></li>
<li><a name="a1195"></a>        <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1196"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;&lt;&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1197"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1198"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1199"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgLT'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1200"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;&gt;&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1201"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1202"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1203"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgGT'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1204"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;&lt;=&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1205"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1206"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1207"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgLE'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1208"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;&gt;=&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1209"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1210"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1211"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgGE'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1212"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;=&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1213"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1214"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1215"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgEQ'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1216"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;&lt;&gt;&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1217"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1218"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1219"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgNE'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1220"></a>        <span class="src-sym">}</span></li>
<li><a name="a1221"></a>        <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1222"></a>    <span class="src-sym">}</span></li>
<li><a name="a1223"></a>&nbsp;</li>
<li><a name="a1224"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1225"></a><span class="src-doc">    * It parses a expression. It assumes the following rule:</span></li>
<li><a name="a1226"></a><span class="src-doc">    * Expr -&gt; Term [(&quot;+&quot; | &quot;-&quot;) Term]</span></li>
<li><a name="a1227"></a><span class="src-doc">    *      -&gt; &quot;string&quot;</span></li>
<li><a name="a1228"></a><span class="src-doc">    *      -&gt; &quot;-&quot; Term</span></li>
<li><a name="a1229"></a><span class="src-doc">    *</span></li>
<li><a name="a1230"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1231"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The parsed ptg'd tree on success</span></li>
<li><a name="a1232"></a><span class="src-doc">    */</span></li>
<li><a name="a1233"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a1234"></a>    <span class="src-sym">{</span></li>
<li><a name="a1235"></a>        <span class="src-comm">// If it's a string return a string node</span></li>
<li><a name="a1236"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">^\&quot;<span class="src-sym">[</span>^\&quot;<span class="src-sym">]</span><span class="src-sym">{</span>0,255<span class="src-sym">}</span>\&quot;$</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1237"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1238"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1239"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1240"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;-&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1241"></a>            <span class="src-comm">// catch &quot;-&quot; Term</span></li>
<li><a name="a1242"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1243"></a>            <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1244"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgUminus'</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1245"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1246"></a>        <span class="src-sym">}</span></li>
<li><a name="a1247"></a>        <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_term">_term</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1248"></a>        <span class="src-key">while </span><span class="src-sym">((</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;+&quot;</span><span class="src-sym">) </span><span class="src-key">or</span></li>
<li><a name="a1249"></a>               <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;-&quot;</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1250"></a>        <span class="src-comm">/**/</span></li>
<li><a name="a1251"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;+&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1252"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1253"></a>                <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_term">_term</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1254"></a>                <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgAdd'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1255"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1256"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1257"></a>                <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_term">_term</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1258"></a>                <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgSub'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1259"></a>            <span class="src-sym">}</span></li>
<li><a name="a1260"></a>        <span class="src-sym">}</span></li>
<li><a name="a1261"></a>        <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1262"></a>    <span class="src-sym">}</span></li>
<li><a name="a1263"></a>&nbsp;</li>
<li><a name="a1264"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1265"></a><span class="src-doc">    * This function just introduces a ptgParen element in the tree, so that Excel</span></li>
<li><a name="a1266"></a><span class="src-doc">    * doesn't get confused when working with a parenthesized formula afterwards.</span></li>
<li><a name="a1267"></a><span class="src-doc">    *</span></li>
<li><a name="a1268"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1269"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@see</span><span class="src-doc"> _fact()</span></li>
<li><a name="a1270"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">array </span><span class="src-doc">The parsed ptg'd tree</span></li>
<li><a name="a1271"></a><span class="src-doc">    */</span></li>
<li><a name="a1272"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_parenthesizedExpression">_parenthesizedExpression</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a1273"></a>    <span class="src-sym">{</span></li>
<li><a name="a1274"></a>        <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgParen'</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_expression">_expression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1275"></a>        <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1276"></a>    <span class="src-sym">}</span></li>
<li><a name="a1277"></a>&nbsp;</li>
<li><a name="a1278"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1279"></a><span class="src-doc">    * It parses a term. It assumes the following rule:</span></li>
<li><a name="a1280"></a><span class="src-doc">    * Term -&gt; Fact [(&quot;*&quot; | &quot;/&quot;) Fact]</span></li>
<li><a name="a1281"></a><span class="src-doc">    *</span></li>
<li><a name="a1282"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1283"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The parsed ptg'd tree on success</span></li>
<li><a name="a1284"></a><span class="src-doc">    */</span></li>
<li><a name="a1285"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_term">_term</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a1286"></a>    <span class="src-sym">{</span></li>
<li><a name="a1287"></a>        <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_fact">_fact</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1288"></a>        <span class="src-key">while </span><span class="src-sym">((</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;*&quot;</span><span class="src-sym">) </span><span class="src-key">or</span></li>
<li><a name="a1289"></a>               <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;/&quot;</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1290"></a>        <span class="src-comm">/**/</span></li>
<li><a name="a1291"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;*&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1292"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1293"></a>                <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_fact">_fact</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1294"></a>                <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgMul'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1295"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1296"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1297"></a>                <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_fact">_fact</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1298"></a>                <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'ptgDiv'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1299"></a>            <span class="src-sym">}</span></li>
<li><a name="a1300"></a>        <span class="src-sym">}</span></li>
<li><a name="a1301"></a>        <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1302"></a>    <span class="src-sym">}</span></li>
<li><a name="a1303"></a>&nbsp;</li>
<li><a name="a1304"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1305"></a><span class="src-doc">    * It parses a factor. It assumes the following rule:</span></li>
<li><a name="a1306"></a><span class="src-doc">    * Fact -&gt; ( Expr )</span></li>
<li><a name="a1307"></a><span class="src-doc">    *       | CellRef</span></li>
<li><a name="a1308"></a><span class="src-doc">    *       | CellRange</span></li>
<li><a name="a1309"></a><span class="src-doc">    *       | Number</span></li>
<li><a name="a1310"></a><span class="src-doc">    *       | Function</span></li>
<li><a name="a1311"></a><span class="src-doc">    *</span></li>
<li><a name="a1312"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1313"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The parsed ptg'd tree on success</span></li>
<li><a name="a1314"></a><span class="src-doc">    */</span></li>
<li><a name="a1315"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_fact">_fact</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a1316"></a>    <span class="src-sym">{</span></li>
<li><a name="a1317"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;(&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1318"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;         </span><span class="src-comm">// eat the &quot;(&quot;</span></li>
<li><a name="a1319"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_parenthesizedExpression">_parenthesizedExpression</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1320"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>!= <span class="src-str">&quot;)&quot;</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1321"></a>                throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;')' token expected.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1322"></a>            <span class="src-sym">}</span></li>
<li><a name="a1323"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;         </span><span class="src-comm">// eat the &quot;)&quot;</span></li>
<li><a name="a1324"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1325"></a>        <span class="src-sym">}</span></li>
<li><a name="a1326"></a>        <span class="src-comm">// if it's a reference</span></li>
<li><a name="a1327"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^\$?[A-Ia-i]?[A-Za-z]\$?[0-9]+$/'</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1328"></a>        <span class="src-sym">{</span></li>
<li><a name="a1329"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1330"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1331"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1332"></a>        <span class="src-sym">}</span></li>
<li><a name="a1333"></a>        <span class="src-comm">// If it's an external reference (Sheet1!A1 or Sheet1:Sheet2!A1)</span></li>
<li><a name="a1334"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\w+(\:\w+)?\!<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1335"></a>        <span class="src-sym">{</span></li>
<li><a name="a1336"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1337"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1338"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1339"></a>        <span class="src-sym">}</span></li>
<li><a name="a1340"></a>        <span class="src-comm">// If it's an external reference ('Sheet1'!A1 or 'Sheet1:Sheet2'!A1)</span></li>
<li><a name="a1341"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^'<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+(\:<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+)?'\!<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1342"></a>        <span class="src-sym">{</span></li>
<li><a name="a1343"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1344"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1345"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1346"></a>        <span class="src-sym">}</span></li>
<li><a name="a1347"></a>        <span class="src-comm">// if it's a range</span></li>
<li><a name="a1348"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+:(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">) </span><span class="src-key">or </span></li>
<li><a name="a1349"></a>                <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+\.\.(\$)?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\$)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1350"></a>        <span class="src-sym">{</span></li>
<li><a name="a1351"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">;</span></li>
<li><a name="a1352"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1353"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1354"></a>        <span class="src-sym">}</span></li>
<li><a name="a1355"></a>        <span class="src-comm">// If it's an external range (Sheet1!A1 or Sheet1!A1:B2)</span></li>
<li><a name="a1356"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^\w+(\:\w+)?\!(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1357"></a>        <span class="src-sym">{</span></li>
<li><a name="a1358"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">;</span></li>
<li><a name="a1359"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1360"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1361"></a>        <span class="src-sym">}</span></li>
<li><a name="a1362"></a>        <span class="src-comm">// If it's an external range ('Sheet1'!A1 or 'Sheet1'!A1:B2)</span></li>
<li><a name="a1363"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^'<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+(\:<span class="src-sym">[</span>\w -<span class="src-sym">]</span>+)?'\!(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+:(<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>)?<span class="src-sym">[</span>0-9<span class="src-sym">]</span>+$/<span class="src-id">u</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1364"></a>        <span class="src-sym">{</span></li>
<li><a name="a1365"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">;</span></li>
<li><a name="a1366"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1367"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1368"></a>        <span class="src-sym">}</span></li>
<li><a name="a1369"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1370"></a>        <span class="src-sym">{</span></li>
<li><a name="a1371"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1372"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1373"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1374"></a>        <span class="src-sym">}</span></li>
<li><a name="a1375"></a>        <span class="src-comm">// if it's a function call</span></li>
<li><a name="a1376"></a>        <span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/eregi">eregi</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">^<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Z0</span>-9\xc0-\xdc\.<span class="src-sym">]</span>+$</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">))</span></li>
<li><a name="a1377"></a>        <span class="src-sym">{</span></li>
<li><a name="a1378"></a>            <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_func">_func</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1379"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1380"></a>        <span class="src-sym">}</span></li>
<li><a name="a1381"></a>        throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;Syntax error: &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span>.</li>
<li><a name="a1382"></a>                                 <span class="src-str">&quot;, lookahead: &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_lookahead">_lookahead</a></span>.</li>
<li><a name="a1383"></a>                                 <span class="src-str">&quot;, current char: &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_char">_current_char</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1384"></a>    <span class="src-sym">}</span></li>
<li><a name="a1385"></a>&nbsp;</li>
<li><a name="a1386"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1387"></a><span class="src-doc">    * It parses a function call. It assumes the following rule:</span></li>
<li><a name="a1388"></a><span class="src-doc">    * Func -&gt; ( Expr [,Expr]* )</span></li>
<li><a name="a1389"></a><span class="src-doc">    *</span></li>
<li><a name="a1390"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1391"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">mixed </span><span class="src-doc">The parsed ptg'd tree on success</span></li>
<li><a name="a1392"></a><span class="src-doc">    */</span></li>
<li><a name="a1393"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_func">_func</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a1394"></a>    <span class="src-sym">{</span></li>
<li><a name="a1395"></a>        <span class="src-var">$num_args </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-comm">// number of arguments received</span></li>
<li><a name="a1396"></a>        <span class="src-var">$function </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a></span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1397"></a>        <span class="src-var">$result   </span>= <span class="src-str">''</span><span class="src-sym">; </span><span class="src-comm">// initialize result</span></li>
<li><a name="a1398"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1399"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;         </span><span class="src-comm">// eat the &quot;(&quot;</span></li>
<li><a name="a1400"></a>        <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>!= <span class="src-str">')'</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1401"></a>        <span class="src-comm">/**/</span></li>
<li><a name="a1402"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$num_args </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1403"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;,&quot; </span><span class="src-key">or</span></li>
<li><a name="a1404"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_current_token">_current_token</a> </span>== <span class="src-str">&quot;;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1405"></a>                <span class="src-sym">{</span></li>
<li><a name="a1406"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;  </span><span class="src-comm">// eat the &quot;,&quot; or &quot;;&quot;</span></li>
<li><a name="a1407"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1408"></a>                    throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;Syntax error: comma expected in &quot;</span>.</li>
<li><a name="a1409"></a>                                      <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">function</span> <span class="src-var">$function</span>, <span class="src-id">arg</span> #{<span class="src-var">$num_args</span><span class="src-sym">}</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1410"></a>                <span class="src-sym">}</span></li>
<li><a name="a1411"></a>                <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_condition">_condition</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1412"></a>                <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'arg'</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1413"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{ </span><span class="src-comm">// first argument</span></li>
<li><a name="a1414"></a>                <span class="src-var">$result2 </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_condition">_condition</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1415"></a>                <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-str">'arg'</span><span class="src-sym">, </span><span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$result2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1416"></a>            <span class="src-sym">}</span></li>
<li><a name="a1417"></a>            <span class="src-var">$num_args</span>++<span class="src-sym">;</span></li>
<li><a name="a1418"></a>        <span class="src-sym">}</span></li>
<li><a name="a1419"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">_functions</span><span class="src-sym">[</span><span class="src-var">$function</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1420"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Function</span> <span class="src-var">$function</span>() <span class="src-id">doesn</span>'<span class="src-id">t</span> <span class="src-id">exist</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1421"></a>        <span class="src-sym">}</span></li>
<li><a name="a1422"></a>        <span class="src-var">$args </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">_functions</span><span class="src-sym">[</span><span class="src-var">$function</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1423"></a>        <span class="src-comm">// If fixed number of args eg. TIME($i,$j,$k). Check that the number of args is valid.</span></li>
<li><a name="a1424"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$args </span>&gt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-key">and </span><span class="src-sym">(</span><span class="src-var">$args </span>!= <span class="src-var">$num_args</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1425"></a>            throw <span class="src-key">new </span><span class="src-id">Exception</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Incorrect</span> <span class="src-id">number</span> <span class="src-id">of</span> <span class="src-id">arguments</span> <span class="src-id">in</span> <span class="src-id">function</span> <span class="src-var">$function</span>() </span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1426"></a>        <span class="src-sym">}</span></li>
<li><a name="a1427"></a>&nbsp;</li>
<li><a name="a1428"></a>        <span class="src-var">$result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$function</span><span class="src-sym">, </span><span class="src-var">$result</span><span class="src-sym">, </span><span class="src-var">$num_args</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1429"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_advance">_advance</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;         </span><span class="src-comm">// eat the &quot;)&quot;</span></li>
<li><a name="a1430"></a>        <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1431"></a>    <span class="src-sym">}</span></li>
<li><a name="a1432"></a>&nbsp;</li>
<li><a name="a1433"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1434"></a><span class="src-doc">    * Creates a tree. In fact an array which may have one or two arrays (sub-trees)</span></li>
<li><a name="a1435"></a><span class="src-doc">    * as elements.</span></li>
<li><a name="a1436"></a><span class="src-doc">    *</span></li>
<li><a name="a1437"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> private</span></li>
<li><a name="a1438"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">mixed </span><span class="src-doc-var">$value </span><span class="src-doc">The value of this node.</span></li>
<li><a name="a1439"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">mixed </span><span class="src-doc-var">$left </span><span class="src-doc"> The left array (sub-tree) or a final node.</span></li>
<li><a name="a1440"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">mixed </span><span class="src-doc-var">$right </span><span class="src-doc">The right array (sub-tree) or a final node.</span></li>
<li><a name="a1441"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">array </span><span class="src-doc">A tree</span></li>
<li><a name="a1442"></a><span class="src-doc">    */</span></li>
<li><a name="a1443"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_createTree">_createTree</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$left</span><span class="src-sym">, </span><span class="src-var">$right</span><span class="src-sym">)</span></li>
<li><a name="a1444"></a>    <span class="src-sym">{</span></li>
<li><a name="a1445"></a>        <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'value' </span>=&gt; <span class="src-var">$value</span><span class="src-sym">, </span><span class="src-str">'left' </span>=&gt; <span class="src-var">$left</span><span class="src-sym">, </span><span class="src-str">'right' </span>=&gt; <span class="src-var">$right</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1446"></a>    <span class="src-sym">}</span></li>
<li><a name="a1447"></a>&nbsp;</li>
<li><a name="a1448"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1449"></a><span class="src-doc">    * Builds a string containing the tree in reverse polish notation (What you</span></li>
<li><a name="a1450"></a><span class="src-doc">    * would use in a HP calculator stack).</span></li>
<li><a name="a1451"></a><span class="src-doc">    * The following tree:</span></li>
<li><a name="a1452"></a><span class="src-doc">    *</span></li>
<li><a name="a1453"></a><span class="src-doc">    *    +</span></li>
<li><a name="a1454"></a><span class="src-doc">    *   / \</span></li>
<li><a name="a1455"></a><span class="src-doc">    *  2   3</span></li>
<li><a name="a1456"></a><span class="src-doc">    *</span></li>
<li><a name="a1457"></a><span class="src-doc">    * produces: &quot;23+&quot;</span></li>
<li><a name="a1458"></a><span class="src-doc">    *</span></li>
<li><a name="a1459"></a><span class="src-doc">    * The following tree:</span></li>
<li><a name="a1460"></a><span class="src-doc">    *</span></li>
<li><a name="a1461"></a><span class="src-doc">    *    +</span></li>
<li><a name="a1462"></a><span class="src-doc">    *   / \</span></li>
<li><a name="a1463"></a><span class="src-doc">    *  3   *</span></li>
<li><a name="a1464"></a><span class="src-doc">    *     / \</span></li>
<li><a name="a1465"></a><span class="src-doc">    *    6   A1</span></li>
<li><a name="a1466"></a><span class="src-doc">    *</span></li>
<li><a name="a1467"></a><span class="src-doc">    * produces: &quot;36A1*+&quot;</span></li>
<li><a name="a1468"></a><span class="src-doc">    *</span></li>
<li><a name="a1469"></a><span class="src-doc">    * In fact all operands, functions, references, etc... are written as ptg's</span></li>
<li><a name="a1470"></a><span class="src-doc">    *</span></li>
<li><a name="a1471"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@access</span><span class="src-doc"> public</span></li>
<li><a name="a1472"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">array </span><span class="src-doc-var">$tree </span><span class="src-doc">The optional tree to convert.</span></li>
<li><a name="a1473"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span><span class="src-doc">The tree in reverse polish notation</span></li>
<li><a name="a1474"></a><span class="src-doc">    */</span></li>
<li><a name="a1475"></a>    <span class="src-key">function </span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodtoReversePolish">toReversePolish</a><span class="src-sym">(</span><span class="src-var">$tree </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1476"></a>    <span class="src-sym">{</span></li>
<li><a name="a1477"></a>        <span class="src-var">$polish </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">; </span><span class="src-comm">// the string we are going to return</span></li>
<li><a name="a1478"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">)) </span><span class="src-sym">{ </span><span class="src-comm">// If it's the first call use _parse_tree</span></li>
<li><a name="a1479"></a>            <span class="src-var">$tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#var$_parse_tree">_parse_tree</a></span><span class="src-sym">;</span></li>
<li><a name="a1480"></a>        <span class="src-sym">}</span></li>
<li><a name="a1481"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'left'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1482"></a>            <span class="src-var">$converted_tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodtoReversePolish">toReversePolish</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'left'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1483"></a>            <span class="src-var">$polish </span>.= <span class="src-var">$converted_tree</span><span class="src-sym">;</span></li>
<li><a name="a1484"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'left'</span><span class="src-sym">] </span>!= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-comm">// It's a final node</span></li>
<li><a name="a1485"></a>            <span class="src-var">$converted_tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convert">_convert</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'left'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1486"></a>            <span class="src-var">$polish </span>.= <span class="src-var">$converted_tree</span><span class="src-sym">;</span></li>
<li><a name="a1487"></a>        <span class="src-sym">}</span></li>
<li><a name="a1488"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'right'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1489"></a>            <span class="src-var">$converted_tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodtoReversePolish">toReversePolish</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'right'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1490"></a>            <span class="src-var">$polish </span>.= <span class="src-var">$converted_tree</span><span class="src-sym">;</span></li>
<li><a name="a1491"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'right'</span><span class="src-sym">] </span>!= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-comm">// It's a final node</span></li>
<li><a name="a1492"></a>            <span class="src-var">$converted_tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convert">_convert</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'right'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1493"></a>            <span class="src-var">$polish </span>.= <span class="src-var">$converted_tree</span><span class="src-sym">;</span></li>
<li><a name="a1494"></a>        <span class="src-sym">}</span></li>
<li><a name="a1495"></a>        <span class="src-comm">// if it's a function convert it here (so we can set it's arguments)</span></li>
<li><a name="a1496"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Z0</span>-9\xc0-\xdc\.<span class="src-sym">]</span>+$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1497"></a>            <span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^([A-Ia-i]?[A-Za-z])(\d+)$/'</span><span class="src-sym">,</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1498"></a>            <span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\d+)\.\.<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Ia</span>-<span class="src-id">i</span><span class="src-sym">]</span>?<span class="src-sym">[</span><span class="src-id">A</span>-<span class="src-id">Za</span>-<span class="src-id">z</span><span class="src-sym">]</span>(\d+)$/</span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1499"></a>            <span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-key">and</span></li>
<li><a name="a1500"></a>            <span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">ptg</span><span class="src-sym">[</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]]</span><span class="src-sym">))</span></li>
<li><a name="a1501"></a>        <span class="src-sym">{</span></li>
<li><a name="a1502"></a>            <span class="src-comm">// left subtree for a function is always an array.</span></li>
<li><a name="a1503"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'left'</span><span class="src-sym">] </span>!= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1504"></a>                <span class="src-var">$left_tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#methodtoReversePolish">toReversePolish</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'left'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1505"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1506"></a>                <span class="src-var">$left_tree </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a1507"></a>            <span class="src-sym">}</span></li>
<li><a name="a1508"></a>            <span class="src-comm">// add it's left subtree and return.</span></li>
<li><a name="a1509"></a>            <span class="src-key">return </span><span class="src-var">$left_tree</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convertFunction">_convertFunction</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'right'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1510"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1511"></a>            <span class="src-var">$converted_tree </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../PHPExcel_Writer_Excel5_Writer/PHPExcel_Writer_Excel5_Parser.html#method_convert">_convert</a><span class="src-sym">(</span><span class="src-var">$tree</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1512"></a>        <span class="src-sym">}</span></li>
<li><a name="a1513"></a>        <span class="src-var">$polish </span>.= <span class="src-var">$converted_tree</span><span class="src-sym">;</span></li>
<li><a name="a1514"></a>        <span class="src-key">return </span><span class="src-var">$polish</span><span class="src-sym">;</span></li>
<li><a name="a1515"></a>    <span class="src-sym">}</span></li>
<li><a name="a1516"></a><span class="src-sym">}</span></li>
</ol></pre></div>
</div>
        <div class="credit">
		    <hr />
		    Documentation generated on Mon, 24 Dec 2007 13:19:23 +0100 by <a href="http://www.phpdoc.org">phpDocumentor 1.3.0RC3</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>