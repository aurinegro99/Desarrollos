<html>
<head>
<title>File Source for Functions.php</title>
<link rel="stylesheet" type="text/css" href="../media/style.css">
</head>
<body>

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
    <td class="header_top">PHPExcel_Calculation</td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td class="header_menu">
  		  [ <a href="../classtrees_PHPExcel_Calculation.html" class="menu">class tree: PHPExcel_Calculation</a> ]
		  [ <a href="../elementindex_PHPExcel_Calculation.html" class="menu">index: PHPExcel_Calculation</a> ]
		  [ <a href="../elementindex.html" class="menu">all elements</a> ]
    </td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="200" class="menu">
	<div id="todolist">
			<p><a href="../todolist.html">Todo List</a></p>
	</div>
      <b>Packages:</b><br />
              <a href="../li_OLE.html">OLE</a><br />
              <a href="../li_PHPExcel.html">PHPExcel</a><br />
              <a href="../li_PHPExcel_Calculation.html">PHPExcel_Calculation</a><br />
              <a href="../li_PHPExcel_Cell.html">PHPExcel_Cell</a><br />
              <a href="../li_PHPExcel_Reader.html">PHPExcel_Reader</a><br />
              <a href="../li_PHPExcel_RichText.html">PHPExcel_RichText</a><br />
              <a href="../li_PHPExcel_Shared.html">PHPExcel_Shared</a><br />
              <a href="../li_PHPExcel_Shared_OLE.html">PHPExcel_Shared_OLE</a><br />
              <a href="../li_PHPExcel_Style.html">PHPExcel_Style</a><br />
              <a href="../li_PHPExcel_Worksheet.html">PHPExcel_Worksheet</a><br />
              <a href="../li_PHPExcel_Worksheet_Drawing.html">PHPExcel_Worksheet_Drawing</a><br />
              <a href="../li_PHPExcel_Writer.html">PHPExcel_Writer</a><br />
              <a href="../li_PHPExcel_Writer_Excel5_Writer.html">PHPExcel_Writer_Excel5_Writer</a><br />
              <a href="../li_PHPExcel_Writer_Excel2007.html">PHPExcel_Writer_Excel2007</a><br />
            <br /><br />
                  
                </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<h1 align="center">Source for file Functions.php</h1>
<p>Documentation is available at <a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html">Functions.php</a></p>
<div class="php">
<div class="listing"><pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a><span class="src-doc">/**</span></li>
<li><a name="a3"></a><span class="src-doc"> * PHPExcel</span></li>
<li><a name="a4"></a><span class="src-doc"> *</span></li>
<li><a name="a5"></a><span class="src-doc"> * Copyright (c) 2006 - 2007 PHPExcel</span></li>
<li><a name="a6"></a><span class="src-doc"> *</span></li>
<li><a name="a7"></a><span class="src-doc"> * This library is free software; you can redistribute it and/or</span></li>
<li><a name="a8"></a><span class="src-doc"> * modify it under the terms of the GNU Lesser General Public</span></li>
<li><a name="a9"></a><span class="src-doc"> * License as published by the Free Software Foundation; either</span></li>
<li><a name="a10"></a><span class="src-doc"> * version 2.1 of the License, or (at your option) any later version.</span></li>
<li><a name="a11"></a><span class="src-doc"> *</span></li>
<li><a name="a12"></a><span class="src-doc"> * This library is distributed in the hope that it will be useful,</span></li>
<li><a name="a13"></a><span class="src-doc"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></li>
<li><a name="a14"></a><span class="src-doc"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></li>
<li><a name="a15"></a><span class="src-doc"> * Lesser General Public License for more details.</span></li>
<li><a name="a16"></a><span class="src-doc"> *</span></li>
<li><a name="a17"></a><span class="src-doc"> * You should have received a copy of the GNU Lesser General Public</span></li>
<li><a name="a18"></a><span class="src-doc"> * License along with this library; if not, write to the Free Software</span></li>
<li><a name="a19"></a><span class="src-doc"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></li>
<li><a name="a20"></a><span class="src-doc"> *</span></li>
<li><a name="a21"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@category</span><span class="src-doc">   PHPExcel</span></li>
<li><a name="a22"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc">    PHPExcel_Calculation</span></li>
<li><a name="a23"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@copyright</span><span class="src-doc">  Copyright (c) 2006 - 2007 PHPExcel (http://www.codeplex.com/PHPExcel)</span></li>
<li><a name="a24"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@license</span><span class="src-doc">    http://www.gnu.org/licenses/lgpl.txt    LGPL</span></li>
<li><a name="a25"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@version</span><span class="src-doc">    1.5.5, 2007-12-24</span></li>
<li><a name="a26"></a><span class="src-doc"> */</span></li>
<li><a name="a27"></a>&nbsp;</li>
<li><a name="a28"></a>&nbsp;</li>
<li><a name="a29"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'EPS'</span><span class="src-sym">, </span><span class="src-num">2.22e-16</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a30"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'MAX_VALUE'</span><span class="src-sym">, </span><span class="src-num">1.2e308</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a31"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'LOG_GAMMA_X_MAX_VALUE'</span><span class="src-sym">, </span><span class="src-num">2.55e305</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a32"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'SQRT2PI'</span><span class="src-sym">, </span><span class="src-num">2.5066282746310005024157652848110452530069867406099</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a33"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'XMININ'</span><span class="src-sym">, </span><span class="src-num">2.23e-308</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a34"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'MAX_ITERATIONS'</span><span class="src-sym">, </span><span class="src-num">150</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a35"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'PRECISION'</span><span class="src-sym">, </span><span class="src-num">8.88E-016</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a36"></a>&nbsp;</li>
<li><a name="a37"></a>&nbsp;</li>
<li><a name="a38"></a><span class="src-doc">/** PHPExcel_Cell */</span></li>
<li><a name="a38"></a>&nbsp;</li>
<li><a name="a39"></a><span class="src-inc">require_once </span><span class="src-str">'PHPExcel/Cell.php'</span><span class="src-sym">;</span></li>
<li><a name="a40"></a>&nbsp;</li>
<li><a name="a41"></a><span class="src-doc">/** PHPExcel_Cell_DataType */</span></li>
<li><a name="a41"></a>&nbsp;</li>
<li><a name="a42"></a><span class="src-inc">require_once </span><span class="src-str">'PHPExcel/Cell/DataType.php'</span><span class="src-sym">;</span></li>
<li><a name="a43"></a>&nbsp;</li>
<li><a name="a44"></a><span class="src-doc">/** PHPExcel_Shared_Date */</span></li>
<li><a name="a44"></a>&nbsp;</li>
<li><a name="a45"></a><span class="src-inc">require_once </span><span class="src-str">'PHPExcel/Shared/Date.php'</span><span class="src-sym">;</span></li>
<li><a name="a46"></a>&nbsp;</li>
<li><a name="a47"></a>&nbsp;</li>
<li><a name="a48"></a><span class="src-doc">/**</span></li>
<li><a name="a49"></a><span class="src-doc"> * PHPExcel_Calculation_Functions</span></li>
<li><a name="a50"></a><span class="src-doc"> *</span></li>
<li><a name="a51"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@category</span><span class="src-doc">   PHPExcel</span></li>
<li><a name="a52"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc">    PHPExcel_Calculation</span></li>
<li><a name="a53"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@copyright</span><span class="src-doc">  Copyright (c) 2006 - 2007 PHPExcel (http://www.codeplex.com/PHPExcel)</span></li>
<li><a name="a54"></a><span class="src-doc"> */</span></li>
<li><a name="a55"></a><span class="src-key">class </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a> <span class="src-sym">{</span></li>
<li><a name="a56"></a>&nbsp;</li>
<li><a name="a57"></a>    <span class="src-doc">/** constants */</span></li>
<li><a name="a57"></a>&nbsp;</li>
<li><a name="a58"></a>    <span class="src-key">const </span><span class="src-id">COMPATIBILITY_EXCEL        </span>= <span class="src-str">'Excel'</span><span class="src-sym">;</span></li>
<li><a name="a59"></a>    <span class="src-key">const </span><span class="src-id">COMPATIBILITY_GNUMERIC    </span>= <span class="src-str">'Gnumeric'</span><span class="src-sym">;</span></li>
<li><a name="a60"></a>    <span class="src-key">const </span><span class="src-id">COMPATIBILITY_OPENOFFICE    </span>= <span class="src-str">'OpenOfficeCalc'</span><span class="src-sym">;</span></li>
<li><a name="a61"></a>&nbsp;</li>
<li><a name="a62"></a>&nbsp;</li>
<li><a name="a63"></a>    <span class="src-doc">/**</span></li>
<li><a name="a64"></a><span class="src-doc">     * Compatibility mode to use for error checking and responses</span></li>
<li><a name="a65"></a><span class="src-doc">     *</span></li>
<li><a name="a66"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">string </span></li>
<li><a name="a67"></a><span class="src-doc">     */</span></li>
<li><a name="a68"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$compatibilityMode    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_EXCEL</span><span class="src-sym">;</span></li>
<li><a name="a69"></a>&nbsp;</li>
<li><a name="a70"></a>    <span class="src-doc">/**</span></li>
<li><a name="a71"></a><span class="src-doc">     * List of error codes</span></li>
<li><a name="a72"></a><span class="src-doc">     *</span></li>
<li><a name="a73"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">array </span></li>
<li><a name="a74"></a><span class="src-doc">     */</span></li>
<li><a name="a75"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$_errorCodes    </span>= <span class="src-key">array</span><span class="src-sym">( </span><span class="src-str">'null'                </span>=&gt; <span class="src-str">'#NULL!'</span><span class="src-sym">,</span></li>
<li><a name="a76"></a>                                         <span class="src-str">'divisionbyzero'    </span>=&gt; <span class="src-str">'#DIV/0!'</span><span class="src-sym">,</span></li>
<li><a name="a77"></a>                                         <span class="src-str">'value'            </span>=&gt; <span class="src-str">'#VALUE!'</span><span class="src-sym">,</span></li>
<li><a name="a78"></a>                                         <span class="src-str">'reference'        </span>=&gt; <span class="src-str">'#REF!'</span><span class="src-sym">,</span></li>
<li><a name="a79"></a>                                         <span class="src-str">'name'                </span>=&gt; <span class="src-str">'#NAME?'</span><span class="src-sym">,</span></li>
<li><a name="a80"></a>                                         <span class="src-str">'num'                </span>=&gt; <span class="src-str">'#NUM!'</span><span class="src-sym">,</span></li>
<li><a name="a81"></a>                                         <span class="src-str">'na'                </span>=&gt; <span class="src-str">'#N/A'</span></li>
<li><a name="a82"></a>                                       <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a83"></a>&nbsp;</li>
<li><a name="a84"></a>&nbsp;</li>
<li><a name="a85"></a>    <span class="src-doc">/**</span></li>
<li><a name="a86"></a><span class="src-doc">     * Set the Compatibility Mode</span></li>
<li><a name="a87"></a><span class="src-doc">     *</span></li>
<li><a name="a88"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">    </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$compatibilityMode </span><span class="src-doc">       Compatibility Mode</span></li>
<li><a name="a89"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">    </span><span class="src-doc-type">boolean </span><span class="src-doc">   (Success or Failure)</span></li>
<li><a name="a90"></a><span class="src-doc">     */</span></li>
<li><a name="a91"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodsetCompatibilityMode">setCompatibilityMode</a><span class="src-sym">(</span><span class="src-var">$compatibilityMode</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a92"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_EXCEL</span><span class="src-sym">) </span>||</li>
<li><a name="a93"></a>            <span class="src-sym">(</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span>||</li>
<li><a name="a94"></a>            <span class="src-sym">(</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a95"></a>            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>= <span class="src-var">$compatibilityMode</span><span class="src-sym">;</span></li>
<li><a name="a96"></a>            <span class="src-key">return </span><span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a97"></a>        <span class="src-sym">}</span></li>
<li><a name="a98"></a>        <span class="src-key">return </span><span class="src-id">False</span><span class="src-sym">;</span></li>
<li><a name="a99"></a>    <span class="src-sym">}</span></li>
<li><a name="a100"></a>&nbsp;</li>
<li><a name="a101"></a>    <span class="src-doc">/**</span></li>
<li><a name="a102"></a><span class="src-doc">     * Return the Compatibility Mode</span></li>
<li><a name="a103"></a><span class="src-doc">     *</span></li>
<li><a name="a104"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">    </span><span class="src-doc-type">string </span><span class="src-doc">       $compatibilityMode        Compatibility Mode</span></li>
<li><a name="a105"></a><span class="src-doc">     */</span></li>
<li><a name="a106"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodgetCompatibilityMode">getCompatibilityMode</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a107"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode</span><span class="src-sym">;</span></li>
<li><a name="a108"></a>    <span class="src-sym">}</span></li>
<li><a name="a109"></a>&nbsp;</li>
<li><a name="a110"></a>    <span class="src-doc">/**</span></li>
<li><a name="a111"></a><span class="src-doc">     * DUMMY</span></li>
<li><a name="a112"></a><span class="src-doc">     *</span></li>
<li><a name="a113"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span><span class="src-doc">   #NAME?</span></li>
<li><a name="a114"></a><span class="src-doc">     */</span></li>
<li><a name="a115"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDUMMY">DUMMY</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a116"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a117"></a>    <span class="src-sym">}</span></li>
<li><a name="a118"></a>&nbsp;</li>
<li><a name="a119"></a>    <span class="src-doc">/**</span></li>
<li><a name="a120"></a><span class="src-doc">     * NA</span></li>
<li><a name="a121"></a><span class="src-doc">     *</span></li>
<li><a name="a122"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span><span class="src-doc">   #N/A!</span></li>
<li><a name="a123"></a><span class="src-doc">     */</span></li>
<li><a name="a124"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodNA">NA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a125"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'na'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a126"></a>    <span class="src-sym">}</span></li>
<li><a name="a127"></a>&nbsp;</li>
<li><a name="a128"></a>    <span class="src-doc">/**</span></li>
<li><a name="a129"></a><span class="src-doc">     * LOGICAL_AND</span></li>
<li><a name="a130"></a><span class="src-doc">     *</span></li>
<li><a name="a131"></a><span class="src-doc">     * Returns boolean TRUE if all its arguments are TRUE; returns FALSE if one or more argument is FALSE.</span></li>
<li><a name="a132"></a><span class="src-doc">     *</span></li>
<li><a name="a133"></a><span class="src-doc">     *    Booleans arguments are treated as True or False as appropriate</span></li>
<li><a name="a134"></a><span class="src-doc">     *    Integer or floating point arguments are treated as True, except for 0 or 0.0 which are False</span></li>
<li><a name="a135"></a><span class="src-doc">     *    If any argument value is a string, or a Null, it is ignored</span></li>
<li><a name="a136"></a><span class="src-doc">     *</span></li>
<li><a name="a137"></a><span class="src-doc">     *    Quirk of Excel:</span></li>
<li><a name="a138"></a><span class="src-doc">     *        String values passed directly to the function rather than through a cell reference</span></li>
<li><a name="a139"></a><span class="src-doc">     *            e.g.=AND(1,&quot;A&quot;,1)</span></li>
<li><a name="a140"></a><span class="src-doc">     *        will return a #VALUE! error, _not_ ignoring the string.</span></li>
<li><a name="a141"></a><span class="src-doc">     *        This behaviour is not replicated</span></li>
<li><a name="a142"></a><span class="src-doc">     *</span></li>
<li><a name="a143"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a144"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a145"></a><span class="src-doc">     */</span></li>
<li><a name="a146"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLOGICAL_AND">LOGICAL_AND</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a147"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a148"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a149"></a>&nbsp;</li>
<li><a name="a150"></a>        <span class="src-comm">// Loop through the arguments</span></li>
<li><a name="a151"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a152"></a>        <span class="src-var">$argCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a153"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a154"></a>            <span class="src-comm">// Is it a boolean value?</span></li>
<li><a name="a155"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a156"></a>                <span class="src-var">$returnValue </span>= <span class="src-var">$returnValue </span>&amp;&amp; <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a157"></a>                <span class="src-var">$argCount</span>++<span class="src-sym">;</span></li>
<li><a name="a158"></a>            <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a159"></a>                <span class="src-var">$returnValue </span>= <span class="src-var">$returnValue </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a160"></a>                <span class="src-var">$argCount</span>++<span class="src-sym">;</span></li>
<li><a name="a161"></a>            <span class="src-sym">}</span></li>
<li><a name="a162"></a>        <span class="src-sym">}</span></li>
<li><a name="a163"></a>&nbsp;</li>
<li><a name="a164"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a165"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$argCount </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a166"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a167"></a>        <span class="src-sym">}</span></li>
<li><a name="a168"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a169"></a>    <span class="src-sym">}</span></li>
<li><a name="a170"></a>&nbsp;</li>
<li><a name="a171"></a>    <span class="src-doc">/**</span></li>
<li><a name="a172"></a><span class="src-doc">     * LOGICAL_OR</span></li>
<li><a name="a173"></a><span class="src-doc">     *</span></li>
<li><a name="a174"></a><span class="src-doc">     * Returns boolean TRUE if any argument is TRUE; returns FALSE if all arguments are FALSE.</span></li>
<li><a name="a175"></a><span class="src-doc">     *</span></li>
<li><a name="a176"></a><span class="src-doc">     *    Booleans arguments are treated as True or False as appropriate</span></li>
<li><a name="a177"></a><span class="src-doc">     *    Integer or floating point arguments are treated as True, except for 0 or 0.0 which are False</span></li>
<li><a name="a178"></a><span class="src-doc">     *    If any argument value is a string, or a Null, it is ignored</span></li>
<li><a name="a179"></a><span class="src-doc">     *</span></li>
<li><a name="a180"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a181"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a182"></a><span class="src-doc">     */</span></li>
<li><a name="a183"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLOGICAL_OR">LOGICAL_OR</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a184"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a185"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">False</span><span class="src-sym">;</span></li>
<li><a name="a186"></a>&nbsp;</li>
<li><a name="a187"></a>        <span class="src-comm">// Loop through the arguments</span></li>
<li><a name="a188"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a189"></a>        <span class="src-var">$argCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a190"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a191"></a>            <span class="src-comm">// Is it a boolean value?</span></li>
<li><a name="a192"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a193"></a>                <span class="src-var">$returnValue </span>= <span class="src-var">$returnValue </span>|| <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a194"></a>                <span class="src-var">$argCount</span>++<span class="src-sym">;</span></li>
<li><a name="a195"></a>            <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a196"></a>                <span class="src-var">$returnValue </span>= <span class="src-var">$returnValue </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a197"></a>                <span class="src-var">$argCount</span>++<span class="src-sym">;</span></li>
<li><a name="a198"></a>            <span class="src-sym">}</span></li>
<li><a name="a199"></a>        <span class="src-sym">}</span></li>
<li><a name="a200"></a>&nbsp;</li>
<li><a name="a201"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a202"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$argCount </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a203"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a204"></a>        <span class="src-sym">}</span></li>
<li><a name="a205"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a206"></a>    <span class="src-sym">}</span></li>
<li><a name="a207"></a>&nbsp;</li>
<li><a name="a208"></a>    <span class="src-doc">/**</span></li>
<li><a name="a209"></a><span class="src-doc">     * LOGICAL_FALSE</span></li>
<li><a name="a210"></a><span class="src-doc">     *</span></li>
<li><a name="a211"></a><span class="src-doc">     * Returns FALSE.</span></li>
<li><a name="a212"></a><span class="src-doc">     *</span></li>
<li><a name="a213"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a214"></a><span class="src-doc">     */</span></li>
<li><a name="a215"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLOGICAL_FALSE">LOGICAL_FALSE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a216"></a>        <span class="src-key">return </span><span class="src-id">False</span><span class="src-sym">;</span></li>
<li><a name="a217"></a>    <span class="src-sym">}</span></li>
<li><a name="a218"></a>&nbsp;</li>
<li><a name="a219"></a>    <span class="src-doc">/**</span></li>
<li><a name="a220"></a><span class="src-doc">     * LOGICAL_TRUE</span></li>
<li><a name="a221"></a><span class="src-doc">     *</span></li>
<li><a name="a222"></a><span class="src-doc">     * Returns TRUE.</span></li>
<li><a name="a223"></a><span class="src-doc">     *</span></li>
<li><a name="a224"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a225"></a><span class="src-doc">     */</span></li>
<li><a name="a226"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLOGICAL_TRUE">LOGICAL_TRUE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a227"></a>        <span class="src-key">return </span><span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a228"></a>    <span class="src-sym">}</span></li>
<li><a name="a229"></a>&nbsp;</li>
<li><a name="a230"></a>    <span class="src-doc">/**</span></li>
<li><a name="a231"></a><span class="src-doc">     * SUM</span></li>
<li><a name="a232"></a><span class="src-doc">     *</span></li>
<li><a name="a233"></a><span class="src-doc">     * SUM computes the sum of all the values and cells referenced in the argument list.</span></li>
<li><a name="a234"></a><span class="src-doc">     *</span></li>
<li><a name="a235"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a236"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a237"></a><span class="src-doc">     */</span></li>
<li><a name="a238"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSUM">SUM</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a239"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a240"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a241"></a>&nbsp;</li>
<li><a name="a242"></a>        <span class="src-comm">// Loop through the arguments</span></li>
<li><a name="a243"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a244"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a245"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a246"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a247"></a>                <span class="src-var">$returnValue </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a248"></a>            <span class="src-sym">}</span></li>
<li><a name="a249"></a>        <span class="src-sym">}</span></li>
<li><a name="a250"></a>&nbsp;</li>
<li><a name="a251"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a252"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a253"></a>    <span class="src-sym">}</span></li>
<li><a name="a254"></a>&nbsp;</li>
<li><a name="a255"></a>    <span class="src-doc">/**</span></li>
<li><a name="a256"></a><span class="src-doc">     * SUMSQ</span></li>
<li><a name="a257"></a><span class="src-doc">     *</span></li>
<li><a name="a258"></a><span class="src-doc">     * Returns the sum of the squares of the arguments</span></li>
<li><a name="a259"></a><span class="src-doc">     *</span></li>
<li><a name="a260"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a261"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a262"></a><span class="src-doc">     */</span></li>
<li><a name="a263"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSUMSQ">SUMSQ</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a264"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a265"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a266"></a>&nbsp;</li>
<li><a name="a267"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a268"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a269"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a270"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a271"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a272"></a>                <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a273"></a>            <span class="src-sym">}</span></li>
<li><a name="a274"></a>        <span class="src-sym">}</span></li>
<li><a name="a275"></a>&nbsp;</li>
<li><a name="a276"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a277"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a278"></a>    <span class="src-sym">}</span></li>
<li><a name="a279"></a>&nbsp;</li>
<li><a name="a280"></a>    <span class="src-doc">/**</span></li>
<li><a name="a281"></a><span class="src-doc">     * PRODUCT</span></li>
<li><a name="a282"></a><span class="src-doc">     *</span></li>
<li><a name="a283"></a><span class="src-doc">     * PRODUCT returns the product of all the values and cells referenced in the argument list.</span></li>
<li><a name="a284"></a><span class="src-doc">     *</span></li>
<li><a name="a285"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a286"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a287"></a><span class="src-doc">     */</span></li>
<li><a name="a288"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodPRODUCT">PRODUCT</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a289"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a290"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a291"></a>&nbsp;</li>
<li><a name="a292"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a293"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a294"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a295"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a296"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a297"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a298"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a299"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a300"></a>                    <span class="src-var">$returnValue </span>*= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a301"></a>                <span class="src-sym">}</span></li>
<li><a name="a302"></a>            <span class="src-sym">}</span></li>
<li><a name="a303"></a>        <span class="src-sym">}</span></li>
<li><a name="a304"></a>&nbsp;</li>
<li><a name="a305"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a306"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a307"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a308"></a>        <span class="src-sym">}</span></li>
<li><a name="a309"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a310"></a>    <span class="src-sym">}</span></li>
<li><a name="a311"></a>&nbsp;</li>
<li><a name="a312"></a>    <span class="src-doc">/**</span></li>
<li><a name="a313"></a><span class="src-doc">     * QUOTIENT</span></li>
<li><a name="a314"></a><span class="src-doc">     *</span></li>
<li><a name="a315"></a><span class="src-doc">     * QUOTIENT function returns the integer portion of a division.numerator is the divided number</span></li>
<li><a name="a316"></a><span class="src-doc">     * and denominator is the divisor.</span></li>
<li><a name="a317"></a><span class="src-doc">     *</span></li>
<li><a name="a318"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a319"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a320"></a><span class="src-doc">     */</span></li>
<li><a name="a321"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodQUOTIENT">QUOTIENT</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a322"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a323"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a324"></a>&nbsp;</li>
<li><a name="a325"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a326"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a327"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a328"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a329"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a330"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a331"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$returnValue </span>== <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a332"></a>                        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a333"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a334"></a>                        <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a335"></a>                    <span class="src-sym">}</span></li>
<li><a name="a336"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a337"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$returnValue </span>== <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a338"></a>                        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a339"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a340"></a>                        <span class="src-var">$returnValue </span>/= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a341"></a>                    <span class="src-sym">}</span></li>
<li><a name="a342"></a>                <span class="src-sym">}</span></li>
<li><a name="a343"></a>            <span class="src-sym">}</span></li>
<li><a name="a344"></a>        <span class="src-sym">}</span></li>
<li><a name="a345"></a>&nbsp;</li>
<li><a name="a346"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a347"></a>        <span class="src-key">return </span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a348"></a>    <span class="src-sym">}</span></li>
<li><a name="a349"></a>&nbsp;</li>
<li><a name="a350"></a>    <span class="src-doc">/**</span></li>
<li><a name="a351"></a><span class="src-doc">     * MIN</span></li>
<li><a name="a352"></a><span class="src-doc">     *</span></li>
<li><a name="a353"></a><span class="src-doc">     * MIN returns the value of the element of the values passed that has the smallest value,</span></li>
<li><a name="a354"></a><span class="src-doc">     * with negative numbers considered smaller than positive numbers.</span></li>
<li><a name="a355"></a><span class="src-doc">     *</span></li>
<li><a name="a356"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a357"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a358"></a><span class="src-doc">     */</span></li>
<li><a name="a359"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMIN">MIN</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a360"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a361"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a362"></a>&nbsp;</li>
<li><a name="a363"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a364"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a365"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a366"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a367"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a368"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>&lt; <span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a369"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a370"></a>                <span class="src-sym">}</span></li>
<li><a name="a371"></a>            <span class="src-sym">}</span></li>
<li><a name="a372"></a>        <span class="src-sym">}</span></li>
<li><a name="a373"></a>&nbsp;</li>
<li><a name="a374"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a375"></a>        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a376"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a377"></a>        <span class="src-sym">}</span></li>
<li><a name="a378"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a379"></a>    <span class="src-sym">}</span></li>
<li><a name="a380"></a>&nbsp;</li>
<li><a name="a381"></a>    <span class="src-doc">/**</span></li>
<li><a name="a382"></a><span class="src-doc">     * MINA</span></li>
<li><a name="a383"></a><span class="src-doc">     *</span></li>
<li><a name="a384"></a><span class="src-doc">     * Returns the smallest value in a list of arguments, including numbers, text, and logical values</span></li>
<li><a name="a385"></a><span class="src-doc">     *</span></li>
<li><a name="a386"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a387"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a388"></a><span class="src-doc">     */</span></li>
<li><a name="a389"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMINA">MINA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a390"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a391"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a392"></a>&nbsp;</li>
<li><a name="a393"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a394"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a395"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a396"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a397"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a398"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a399"></a>                    <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a400"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a401"></a>                    <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a402"></a>                <span class="src-sym">}</span></li>
<li><a name="a403"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>&lt; <span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a404"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a405"></a>                <span class="src-sym">}</span></li>
<li><a name="a406"></a>            <span class="src-sym">}</span></li>
<li><a name="a407"></a>        <span class="src-sym">}</span></li>
<li><a name="a408"></a>&nbsp;</li>
<li><a name="a409"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a410"></a>        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a411"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a412"></a>        <span class="src-sym">}</span></li>
<li><a name="a413"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a414"></a>    <span class="src-sym">}</span></li>
<li><a name="a415"></a>&nbsp;</li>
<li><a name="a416"></a>    <span class="src-doc">/**</span></li>
<li><a name="a417"></a><span class="src-doc">     * SMALL</span></li>
<li><a name="a418"></a><span class="src-doc">     *</span></li>
<li><a name="a419"></a><span class="src-doc">     * Returns the nth smallest value in a data set. You can use this function to</span></li>
<li><a name="a420"></a><span class="src-doc">     * select a value based on its relative standing.</span></li>
<li><a name="a421"></a><span class="src-doc">     *</span></li>
<li><a name="a422"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a423"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   Entry in the series to return</span></li>
<li><a name="a424"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a425"></a><span class="src-doc">     */</span></li>
<li><a name="a426"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSMALL">SMALL</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a427"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a428"></a>&nbsp;</li>
<li><a name="a429"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a430"></a>        <span class="src-var">$n </span>= <a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a431"></a>&nbsp;</li>
<li><a name="a432"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a433"></a>            <span class="src-var">$mArgs </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a434"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a435"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a436"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a437"></a>                    <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a438"></a>                <span class="src-sym">}</span></li>
<li><a name="a439"></a>            <span class="src-sym">}</span></li>
<li><a name="a440"></a>            <span class="src-var">$count </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COUNT</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a441"></a>            <span class="src-var">$n </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span>--<span class="src-var">$n</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a442"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$n </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$n </span>&gt;= <span class="src-var">$count</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$count </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a443"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a444"></a>            <span class="src-sym">}</span></li>
<li><a name="a445"></a>            <span class="src-id">sort</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a446"></a>            <span class="src-key">return </span><span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$n</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a447"></a>        <span class="src-sym">}</span></li>
<li><a name="a448"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a449"></a>    <span class="src-sym">}</span></li>
<li><a name="a450"></a>&nbsp;</li>
<li><a name="a451"></a>    <span class="src-doc">/**</span></li>
<li><a name="a452"></a><span class="src-doc">     * MAX</span></li>
<li><a name="a453"></a><span class="src-doc">     *</span></li>
<li><a name="a454"></a><span class="src-doc">     * MAX returns the value of the element of the values passed that has the highest value,</span></li>
<li><a name="a455"></a><span class="src-doc">     * with negative numbers considered smaller than positive numbers.</span></li>
<li><a name="a456"></a><span class="src-doc">     *</span></li>
<li><a name="a457"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a458"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a459"></a><span class="src-doc">     */</span></li>
<li><a name="a460"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMAX">MAX</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a461"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a462"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a463"></a>&nbsp;</li>
<li><a name="a464"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a465"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a466"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a467"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a468"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a469"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>&gt; <span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a470"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a471"></a>                <span class="src-sym">}</span></li>
<li><a name="a472"></a>            <span class="src-sym">}</span></li>
<li><a name="a473"></a>        <span class="src-sym">}</span></li>
<li><a name="a474"></a>&nbsp;</li>
<li><a name="a475"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a476"></a>        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a477"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a478"></a>        <span class="src-sym">}</span></li>
<li><a name="a479"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a480"></a>    <span class="src-sym">}</span></li>
<li><a name="a481"></a>&nbsp;</li>
<li><a name="a482"></a>    <span class="src-doc">/**</span></li>
<li><a name="a483"></a><span class="src-doc">     * MAXA</span></li>
<li><a name="a484"></a><span class="src-doc">     *</span></li>
<li><a name="a485"></a><span class="src-doc">     * Returns the greatest value in a list of arguments, including numbers, text, and logical values</span></li>
<li><a name="a486"></a><span class="src-doc">     *</span></li>
<li><a name="a487"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a488"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a489"></a><span class="src-doc">     */</span></li>
<li><a name="a490"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMAXA">MAXA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a491"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a492"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a493"></a>&nbsp;</li>
<li><a name="a494"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a495"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a496"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a497"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a498"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a499"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a500"></a>                    <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a501"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a502"></a>                    <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a503"></a>                <span class="src-sym">}</span></li>
<li><a name="a504"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$arg </span>&gt; <span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a505"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a506"></a>                <span class="src-sym">}</span></li>
<li><a name="a507"></a>            <span class="src-sym">}</span></li>
<li><a name="a508"></a>        <span class="src-sym">}</span></li>
<li><a name="a509"></a>&nbsp;</li>
<li><a name="a510"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a511"></a>        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a512"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a513"></a>        <span class="src-sym">}</span></li>
<li><a name="a514"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a515"></a>    <span class="src-sym">}</span></li>
<li><a name="a516"></a>&nbsp;</li>
<li><a name="a517"></a>    <span class="src-doc">/**</span></li>
<li><a name="a518"></a><span class="src-doc">     * LARGE</span></li>
<li><a name="a519"></a><span class="src-doc">     *</span></li>
<li><a name="a520"></a><span class="src-doc">     * Returns the nth largest value in a data set. You can use this function to</span></li>
<li><a name="a521"></a><span class="src-doc">     * select a value based on its relative standing.</span></li>
<li><a name="a522"></a><span class="src-doc">     *</span></li>
<li><a name="a523"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a524"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   Entry in the series to return</span></li>
<li><a name="a525"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a526"></a><span class="src-doc">     *</span></li>
<li><a name="a527"></a><span class="src-doc">     */</span></li>
<li><a name="a528"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLARGE">LARGE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a529"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a530"></a>&nbsp;</li>
<li><a name="a531"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a532"></a>        <span class="src-var">$n </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a533"></a>&nbsp;</li>
<li><a name="a534"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a535"></a>            <span class="src-var">$mArgs </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a536"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a537"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a538"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a539"></a>                    <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a540"></a>                <span class="src-sym">}</span></li>
<li><a name="a541"></a>            <span class="src-sym">}</span></li>
<li><a name="a542"></a>            <span class="src-var">$count </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COUNT</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a543"></a>            <span class="src-var">$n </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span>--<span class="src-var">$n</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a544"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$n </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$n </span>&gt;= <span class="src-var">$count</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$count </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a545"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a546"></a>            <span class="src-sym">}</span></li>
<li><a name="a547"></a>            <span class="src-id">rsort</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a548"></a>            <span class="src-key">return </span><span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$n</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a549"></a>        <span class="src-sym">}</span></li>
<li><a name="a550"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a551"></a>    <span class="src-sym">}</span></li>
<li><a name="a552"></a>&nbsp;</li>
<li><a name="a553"></a>    <span class="src-doc">/**</span></li>
<li><a name="a554"></a><span class="src-doc">     * PERCENTILE</span></li>
<li><a name="a555"></a><span class="src-doc">     *</span></li>
<li><a name="a556"></a><span class="src-doc">     * Returns the nth percentile of values in a range..</span></li>
<li><a name="a557"></a><span class="src-doc">     *</span></li>
<li><a name="a558"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a559"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$entry </span><span class="src-doc">       Entry in the series to return</span></li>
<li><a name="a560"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a561"></a><span class="src-doc">     */</span></li>
<li><a name="a562"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodPERCENTILE">PERCENTILE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a563"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a564"></a>&nbsp;</li>
<li><a name="a565"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a566"></a>        <span class="src-var">$entry </span>= <a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a567"></a>&nbsp;</li>
<li><a name="a568"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$entry</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$entry</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a569"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$entry </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$entry </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a570"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a571"></a>            <span class="src-sym">}</span></li>
<li><a name="a572"></a>            <span class="src-var">$mArgs </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a573"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a574"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a575"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a576"></a>                    <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a577"></a>                <span class="src-sym">}</span></li>
<li><a name="a578"></a>            <span class="src-sym">}</span></li>
<li><a name="a579"></a>            <span class="src-var">$mValueCount </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a580"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mValueCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a581"></a>                <a href="http://www.php.net/sort">sort</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a582"></a>                <span class="src-var">$count </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COUNT</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a583"></a>                <span class="src-var">$index </span>= <span class="src-var">$entry </span>* <span class="src-sym">(</span><span class="src-var">$count</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a584"></a>                <span class="src-var">$iBase </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$index</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a585"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$index </span>== <span class="src-var">$iBase</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a586"></a>                    <span class="src-key">return </span><span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$index</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a587"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a588"></a>                    <span class="src-var">$iNext </span>= <span class="src-var">$iBase </span>+ <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a589"></a>                    <span class="src-var">$iProportion </span>= <span class="src-var">$index </span>- <span class="src-var">$iBase</span><span class="src-sym">;</span></li>
<li><a name="a590"></a>                    <span class="src-key">return </span><span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$iBase</span><span class="src-sym">] </span>+ <span class="src-sym">((</span><span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$iNext</span><span class="src-sym">] </span>- <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$iBase</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$iProportion</span><span class="src-sym">) </span><span class="src-sym">;</span></li>
<li><a name="a591"></a>                <span class="src-sym">}</span></li>
<li><a name="a592"></a>            <span class="src-sym">}</span></li>
<li><a name="a593"></a>        <span class="src-sym">}</span></li>
<li><a name="a594"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a595"></a>    <span class="src-sym">}</span></li>
<li><a name="a596"></a>&nbsp;</li>
<li><a name="a597"></a>    <span class="src-doc">/**</span></li>
<li><a name="a598"></a><span class="src-doc">     * QUARTILE</span></li>
<li><a name="a599"></a><span class="src-doc">     *</span></li>
<li><a name="a600"></a><span class="src-doc">     * Returns the quartile of a data set.</span></li>
<li><a name="a601"></a><span class="src-doc">     *</span></li>
<li><a name="a602"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a603"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$entry </span><span class="src-doc">       Entry in the series to return</span></li>
<li><a name="a604"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a605"></a><span class="src-doc">     */</span></li>
<li><a name="a606"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodQUARTILE">QUARTILE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a607"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a608"></a>&nbsp;</li>
<li><a name="a609"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a610"></a>        <span class="src-var">$entry </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a611"></a>&nbsp;</li>
<li><a name="a612"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$entry</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$entry</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a613"></a>            <span class="src-var">$entry </span>/= <span class="src-num">4</span><span class="src-sym">;</span></li>
<li><a name="a614"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$entry </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$entry </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a615"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a616"></a>            <span class="src-sym">}</span></li>
<li><a name="a617"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">PERCENTILE</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">,</span><span class="src-var">$entry</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a618"></a>        <span class="src-sym">}</span></li>
<li><a name="a619"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a620"></a>    <span class="src-sym">}</span></li>
<li><a name="a621"></a>&nbsp;</li>
<li><a name="a622"></a>    <span class="src-doc">/**</span></li>
<li><a name="a623"></a><span class="src-doc">     * COUNT</span></li>
<li><a name="a624"></a><span class="src-doc">     *</span></li>
<li><a name="a625"></a><span class="src-doc">     * Counts the number of cells that contain numbers within the list of arguments</span></li>
<li><a name="a626"></a><span class="src-doc">     *</span></li>
<li><a name="a627"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a628"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a629"></a><span class="src-doc">     */</span></li>
<li><a name="a630"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCOUNT">COUNT</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a631"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a632"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a633"></a>&nbsp;</li>
<li><a name="a634"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a635"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a636"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a637"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))  </span>&amp;&amp; <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a638"></a>                <span class="src-var">$arg </span>= (int) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a639"></a>            <span class="src-sym">}</span></li>
<li><a name="a640"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a641"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a642"></a>                ++<span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a643"></a>            <span class="src-sym">}</span></li>
<li><a name="a644"></a>        <span class="src-sym">}</span></li>
<li><a name="a645"></a>&nbsp;</li>
<li><a name="a646"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a647"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a648"></a>    <span class="src-sym">}</span></li>
<li><a name="a649"></a>&nbsp;</li>
<li><a name="a650"></a>    <span class="src-doc">/**</span></li>
<li><a name="a651"></a><span class="src-doc">     * COUNTBLANK</span></li>
<li><a name="a652"></a><span class="src-doc">     *</span></li>
<li><a name="a653"></a><span class="src-doc">     * Counts the number of empty cells within the list of arguments</span></li>
<li><a name="a654"></a><span class="src-doc">     *</span></li>
<li><a name="a655"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a656"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a657"></a><span class="src-doc">     */</span></li>
<li><a name="a658"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCOUNTBLANK">COUNTBLANK</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a659"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a660"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a661"></a>&nbsp;</li>
<li><a name="a662"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a663"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a664"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a665"></a>            <span class="src-comm">// Is it a blank cell?</span></li>
<li><a name="a666"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$arg </span>== <span class="src-str">''</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a667"></a>                ++<span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a668"></a>            <span class="src-sym">}</span></li>
<li><a name="a669"></a>        <span class="src-sym">}</span></li>
<li><a name="a670"></a>&nbsp;</li>
<li><a name="a671"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a672"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a673"></a>    <span class="src-sym">}</span></li>
<li><a name="a674"></a>&nbsp;</li>
<li><a name="a675"></a>    <span class="src-doc">/**</span></li>
<li><a name="a676"></a><span class="src-doc">     * COUNTA</span></li>
<li><a name="a677"></a><span class="src-doc">     *</span></li>
<li><a name="a678"></a><span class="src-doc">     * Counts the number of cells that are not empty within the list of arguments</span></li>
<li><a name="a679"></a><span class="src-doc">     *</span></li>
<li><a name="a680"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a681"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a682"></a><span class="src-doc">     */</span></li>
<li><a name="a683"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCOUNTA">COUNTA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a684"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a685"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a686"></a>&nbsp;</li>
<li><a name="a687"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a688"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a689"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a690"></a>            <span class="src-comm">// Is it a numeric, boolean or string value?</span></li>
<li><a name="a691"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a692"></a>                ++<span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a693"></a>            <span class="src-sym">}</span></li>
<li><a name="a694"></a>        <span class="src-sym">}</span></li>
<li><a name="a695"></a>&nbsp;</li>
<li><a name="a696"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a697"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a698"></a>    <span class="src-sym">}</span></li>
<li><a name="a699"></a>&nbsp;</li>
<li><a name="a700"></a>    <span class="src-doc">/**</span></li>
<li><a name="a701"></a><span class="src-doc">     * AVERAGE</span></li>
<li><a name="a702"></a><span class="src-doc">     *</span></li>
<li><a name="a703"></a><span class="src-doc">     * Returns the average (arithmetic mean) of the arguments</span></li>
<li><a name="a704"></a><span class="src-doc">     *</span></li>
<li><a name="a705"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a706"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a707"></a><span class="src-doc">     */</span></li>
<li><a name="a708"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a709"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a710"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a711"></a>&nbsp;</li>
<li><a name="a712"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a713"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a714"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a715"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a716"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))  </span>&amp;&amp; <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a717"></a>                <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a718"></a>            <span class="src-sym">}</span></li>
<li><a name="a719"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a720"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a721"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a722"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a723"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a724"></a>                    <span class="src-var">$returnValue </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a725"></a>                <span class="src-sym">}</span></li>
<li><a name="a726"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a727"></a>            <span class="src-sym">}</span></li>
<li><a name="a728"></a>        <span class="src-sym">}</span></li>
<li><a name="a729"></a>&nbsp;</li>
<li><a name="a730"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a731"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a732"></a>            <span class="src-key">return </span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a733"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a734"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a735"></a>        <span class="src-sym">}</span></li>
<li><a name="a736"></a>    <span class="src-sym">}</span></li>
<li><a name="a737"></a>&nbsp;</li>
<li><a name="a738"></a>    <span class="src-doc">/**</span></li>
<li><a name="a739"></a><span class="src-doc">     * AVERAGEA</span></li>
<li><a name="a740"></a><span class="src-doc">     *</span></li>
<li><a name="a741"></a><span class="src-doc">     * Returns the average of its arguments, including numbers, text, and logical values</span></li>
<li><a name="a742"></a><span class="src-doc">     *</span></li>
<li><a name="a743"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a744"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a745"></a><span class="src-doc">     */</span></li>
<li><a name="a746"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGEA">AVERAGEA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a747"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a748"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a749"></a>&nbsp;</li>
<li><a name="a750"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a751"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a752"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a753"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a754"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a755"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a756"></a>                    <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a757"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a758"></a>                    <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a759"></a>                <span class="src-sym">}</span></li>
<li><a name="a760"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a761"></a>                    <span class="src-var">$returnValue </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a762"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a763"></a>                    <span class="src-var">$returnValue </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a764"></a>                <span class="src-sym">}</span></li>
<li><a name="a765"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a766"></a>            <span class="src-sym">}</span></li>
<li><a name="a767"></a>        <span class="src-sym">}</span></li>
<li><a name="a768"></a>&nbsp;</li>
<li><a name="a769"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a770"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a771"></a>            <span class="src-key">return </span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a772"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a773"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a774"></a>        <span class="src-sym">}</span></li>
<li><a name="a775"></a>    <span class="src-sym">}</span></li>
<li><a name="a776"></a>&nbsp;</li>
<li><a name="a777"></a>    <span class="src-doc">/**</span></li>
<li><a name="a778"></a><span class="src-doc">     * MEDIAN</span></li>
<li><a name="a779"></a><span class="src-doc">     *</span></li>
<li><a name="a780"></a><span class="src-doc">     * Returns the median of the given numbers. The median is the number in the middle of a set of numbers.</span></li>
<li><a name="a781"></a><span class="src-doc">     *</span></li>
<li><a name="a782"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a783"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a784"></a><span class="src-doc">     */</span></li>
<li><a name="a785"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMEDIAN">MEDIAN</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a786"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a787"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a788"></a>&nbsp;</li>
<li><a name="a789"></a>        <span class="src-var">$mArgs </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a790"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a791"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a792"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a793"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a794"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a795"></a>                <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a796"></a>            <span class="src-sym">}</span></li>
<li><a name="a797"></a>        <span class="src-sym">}</span></li>
<li><a name="a798"></a>&nbsp;</li>
<li><a name="a799"></a>        <span class="src-var">$mValueCount </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a800"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mValueCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a801"></a>            <a href="http://www.php.net/sort">sort</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">,</span><span class="src-id">SORT_NUMERIC</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a802"></a>            <span class="src-var">$mValueCount </span>= <span class="src-var">$mValueCount </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a803"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mValueCount </span>== <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$mValueCount</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a804"></a>                <span class="src-var">$returnValue </span>= <span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$mValueCount</span>--<span class="src-sym">] </span>+ <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$mValueCount</span><span class="src-sym">]</span><span class="src-sym">) </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a805"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a806"></a>                <span class="src-var">$mValueCount </span>== <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$mValueCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a807"></a>                <span class="src-var">$returnValue </span>= <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-var">$mValueCount</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a808"></a>            <span class="src-sym">}</span></li>
<li><a name="a809"></a>        <span class="src-sym">}</span></li>
<li><a name="a810"></a>&nbsp;</li>
<li><a name="a811"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a812"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a813"></a>    <span class="src-sym">}</span></li>
<li><a name="a814"></a>&nbsp;</li>
<li><a name="a815"></a>    <span class="src-comm">//</span></li>
<li><a name="a816"></a>    <span class="src-comm">//    Special variant of array_count_values that isn't limited to strings and integers,</span></li>
<li><a name="a817"></a>    <span class="src-comm">//        but can work with floating point numbers as values</span></li>
<li><a name="a818"></a>    <span class="src-comm">//</span></li>
<li><a name="a818"></a>    </li>
<li><a name="a819"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodmodeCalc">modeCalc</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a820"></a>        <span class="src-var">$frequencyArray </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a821"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$data </span><span class="src-key">as </span><span class="src-var">$datum</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a822"></a>            <span class="src-var">$found </span>= <span class="src-id">False</span><span class="src-sym">;</span></li>
<li><a name="a823"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$frequencyArray </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a824"></a>                <span class="src-key">if </span><span class="src-sym">(</span>(string)<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">] </span>== (string)<span class="src-var">$datum</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a825"></a>                    ++<span class="src-var">$frequencyArray</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'frequency'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a826"></a>                    <span class="src-var">$found </span>= <span class="src-id">True</span><span class="src-sym">;</span></li>
<li><a name="a827"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a828"></a>                <span class="src-sym">}</span></li>
<li><a name="a829"></a>            <span class="src-sym">}</span></li>
<li><a name="a830"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$found</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a831"></a>                <span class="src-var">$frequencyArray</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'value'        </span>=&gt; <span class="src-var">$datum</span><span class="src-sym">,</span></li>
<li><a name="a832"></a>                                          <span class="src-str">'frequency'    </span>=&gt;    <span class="src-num">1 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a833"></a>            <span class="src-sym">}</span></li>
<li><a name="a834"></a>        <span class="src-sym">}</span></li>
<li><a name="a835"></a>&nbsp;</li>
<li><a name="a836"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$frequencyArray </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a837"></a>            <span class="src-var">$frequencyList</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">] </span>= <span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'frequency'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a838"></a>            <span class="src-var">$valueList</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">] </span>= <span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a839"></a>        <span class="src-sym">}</span></li>
<li><a name="a840"></a>        <a href="http://www.php.net/array_multisort">array_multisort</a><span class="src-sym">(</span><span class="src-var">$frequencyList</span><span class="src-sym">, </span><span class="src-id">SORT_DESC</span><span class="src-sym">, </span><span class="src-var">$valueList</span><span class="src-sym">, </span><span class="src-id">SORT_ASC</span><span class="src-sym">, </span><span class="src-id">SORT_NUMERIC</span><span class="src-sym">, </span><span class="src-var">$frequencyArray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a841"></a>&nbsp;</li>
<li><a name="a842"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$frequencyArray</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'frequency'</span><span class="src-sym">] </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a843"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NA</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a844"></a>        <span class="src-sym">}</span></li>
<li><a name="a845"></a>        <span class="src-key">return </span><span class="src-var">$frequencyArray</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a846"></a>    <span class="src-sym">}</span></li>
<li><a name="a847"></a>&nbsp;</li>
<li><a name="a848"></a>    <span class="src-doc">/**</span></li>
<li><a name="a849"></a><span class="src-doc">     * MODE</span></li>
<li><a name="a850"></a><span class="src-doc">     *</span></li>
<li><a name="a851"></a><span class="src-doc">     * Returns the most frequently occurring, or repetitive, value in an array or range of data</span></li>
<li><a name="a852"></a><span class="src-doc">     *</span></li>
<li><a name="a853"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a854"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a855"></a><span class="src-doc">     */</span></li>
<li><a name="a856"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMODE">MODE</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a857"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a858"></a>        <span class="src-var">$returnValue </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodNA">NA</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a859"></a>&nbsp;</li>
<li><a name="a860"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a861"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a862"></a>&nbsp;</li>
<li><a name="a863"></a>        <span class="src-var">$mArgs </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a864"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a865"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a866"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a867"></a>                <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a868"></a>            <span class="src-sym">}</span></li>
<li><a name="a869"></a>        <span class="src-sym">}</span></li>
<li><a name="a870"></a>&nbsp;</li>
<li><a name="a871"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">) </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a872"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">modeCalc</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a873"></a>        <span class="src-sym">}</span></li>
<li><a name="a874"></a>&nbsp;</li>
<li><a name="a875"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a876"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a877"></a>    <span class="src-sym">}</span></li>
<li><a name="a878"></a>&nbsp;</li>
<li><a name="a879"></a>    <span class="src-doc">/**</span></li>
<li><a name="a880"></a><span class="src-doc">     * DEVSQ</span></li>
<li><a name="a881"></a><span class="src-doc">     *</span></li>
<li><a name="a882"></a><span class="src-doc">     * Returns the sum of squares of deviations of data points from their sample mean.</span></li>
<li><a name="a883"></a><span class="src-doc">     *</span></li>
<li><a name="a884"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a885"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a886"></a><span class="src-doc">     */</span></li>
<li><a name="a887"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDEVSQ">DEVSQ</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a888"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a889"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a890"></a>&nbsp;</li>
<li><a name="a891"></a>        <span class="src-var">$aMean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a892"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a893"></a>            <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a894"></a>&nbsp;</li>
<li><a name="a895"></a>            <span class="src-var">$aCount </span>= -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a896"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a897"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a898"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))  </span>&amp;&amp; <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a899"></a>                    <span class="src-var">$arg </span>= (int) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a900"></a>                <span class="src-sym">}</span></li>
<li><a name="a901"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a902"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a903"></a>                        <span class="src-var">$returnValue </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a904"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a905"></a>                        <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a906"></a>                    <span class="src-sym">}</span></li>
<li><a name="a907"></a>                    ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a908"></a>                <span class="src-sym">}</span></li>
<li><a name="a909"></a>            <span class="src-sym">}</span></li>
<li><a name="a910"></a>&nbsp;</li>
<li><a name="a911"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a912"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a913"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a914"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a915"></a>                <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a916"></a>            <span class="src-sym">}</span></li>
<li><a name="a917"></a>        <span class="src-sym">}</span></li>
<li><a name="a918"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NA</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a919"></a>    <span class="src-sym">}</span></li>
<li><a name="a920"></a>&nbsp;</li>
<li><a name="a921"></a>    <span class="src-doc">/**</span></li>
<li><a name="a922"></a><span class="src-doc">     * AVEDEV</span></li>
<li><a name="a923"></a><span class="src-doc">     *</span></li>
<li><a name="a924"></a><span class="src-doc">     * Returns the average of the absolute deviations of data points from their mean.</span></li>
<li><a name="a925"></a><span class="src-doc">     * AVEDEV is a measure of the variability in a data set.</span></li>
<li><a name="a926"></a><span class="src-doc">     *</span></li>
<li><a name="a927"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a928"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a929"></a><span class="src-doc">     */</span></li>
<li><a name="a930"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVEDEV">AVEDEV</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a931"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a932"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a933"></a>&nbsp;</li>
<li><a name="a934"></a>        <span class="src-var">$aMean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a935"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aMean </span>!= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a936"></a>            <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a937"></a>&nbsp;</li>
<li><a name="a938"></a>            <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a939"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a940"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))  </span>&amp;&amp; <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a941"></a>                    <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a942"></a>                <span class="src-sym">}</span></li>
<li><a name="a943"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a944"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a945"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a946"></a>                        <span class="src-var">$returnValue </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a947"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a948"></a>                        <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a949"></a>                    <span class="src-sym">}</span></li>
<li><a name="a950"></a>                    ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a951"></a>                <span class="src-sym">}</span></li>
<li><a name="a952"></a>            <span class="src-sym">}</span></li>
<li><a name="a953"></a>&nbsp;</li>
<li><a name="a954"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a955"></a>            <span class="src-key">return </span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount </span><span class="src-sym">;</span></li>
<li><a name="a956"></a>        <span class="src-sym">}</span></li>
<li><a name="a957"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a958"></a>    <span class="src-sym">}</span></li>
<li><a name="a959"></a>&nbsp;</li>
<li><a name="a960"></a>    <span class="src-doc">/**</span></li>
<li><a name="a961"></a><span class="src-doc">     * GEOMEAN</span></li>
<li><a name="a962"></a><span class="src-doc">     *</span></li>
<li><a name="a963"></a><span class="src-doc">     * Returns the geometric mean of an array or range of positive data. For example, you</span></li>
<li><a name="a964"></a><span class="src-doc">     * can use GEOMEAN to calculate average growth rate given compound interest with</span></li>
<li><a name="a965"></a><span class="src-doc">     * variable rates.</span></li>
<li><a name="a966"></a><span class="src-doc">     *</span></li>
<li><a name="a967"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a968"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a969"></a><span class="src-doc">     */</span></li>
<li><a name="a970"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodGEOMEAN">GEOMEAN</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a971"></a>        <span class="src-var">$aMean </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">PRODUCT</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a972"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$aMean </span>&gt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a973"></a>            <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a974"></a>            <span class="src-var">$aCount </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCOUNT">COUNT</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">) </span><span class="src-sym">;</span></li>
<li><a name="a975"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMIN">MIN</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">) </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a976"></a>                <span class="src-key">return </span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">, </span><span class="src-sym">(</span><span class="src-num">1 </span>/ <span class="src-var">$aCount</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a977"></a>            <span class="src-sym">}</span></li>
<li><a name="a978"></a>        <span class="src-sym">}</span></li>
<li><a name="a979"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a980"></a>    <span class="src-sym">}</span></li>
<li><a name="a981"></a>&nbsp;</li>
<li><a name="a982"></a>    <span class="src-doc">/**</span></li>
<li><a name="a983"></a><span class="src-doc">     * HARMEAN</span></li>
<li><a name="a984"></a><span class="src-doc">     *</span></li>
<li><a name="a985"></a><span class="src-doc">     * Returns the harmonic mean of a data set. The harmonic mean is the reciprocal of the</span></li>
<li><a name="a986"></a><span class="src-doc">     * arithmetic mean of reciprocals.</span></li>
<li><a name="a987"></a><span class="src-doc">     *</span></li>
<li><a name="a988"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a989"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a990"></a><span class="src-doc">     */</span></li>
<li><a name="a991"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodHARMEAN">HARMEAN</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a992"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a993"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NA</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a994"></a>&nbsp;</li>
<li><a name="a995"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a996"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a997"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMIN">MIN</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">) </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a998"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a999"></a>        <span class="src-sym">}</span></li>
<li><a name="a1000"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1001"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1002"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1003"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1004"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$arg </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1005"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1006"></a>                <span class="src-sym">}</span></li>
<li><a name="a1007"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1008"></a>                    <span class="src-var">$returnValue </span>= <span class="src-sym">(</span><span class="src-num">1 </span>/ <span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1009"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1010"></a>                    <span class="src-var">$returnValue </span>+= <span class="src-sym">(</span><span class="src-num">1 </span>/ <span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1011"></a>                <span class="src-sym">}</span></li>
<li><a name="a1012"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1013"></a>            <span class="src-sym">}</span></li>
<li><a name="a1014"></a>        <span class="src-sym">}</span></li>
<li><a name="a1015"></a>&nbsp;</li>
<li><a name="a1016"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a1017"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1018"></a>            <span class="src-key">return </span><span class="src-num">1 </span>/ <span class="src-sym">(</span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1019"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1020"></a>            <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1021"></a>        <span class="src-sym">}</span></li>
<li><a name="a1022"></a>    <span class="src-sym">}</span></li>
<li><a name="a1023"></a>&nbsp;</li>
<li><a name="a1024"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1025"></a><span class="src-doc">     * TRIMMEAN</span></li>
<li><a name="a1026"></a><span class="src-doc">     *</span></li>
<li><a name="a1027"></a><span class="src-doc">     * Returns the mean of the interior of a data set. TRIMMEAN calculates the mean</span></li>
<li><a name="a1028"></a><span class="src-doc">     * taken by excluding a percentage of data points from the top and bottom tails</span></li>
<li><a name="a1029"></a><span class="src-doc">     * of a data set.</span></li>
<li><a name="a1030"></a><span class="src-doc">     *</span></li>
<li><a name="a1031"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1032"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   Percentage to discard</span></li>
<li><a name="a1033"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a1034"></a><span class="src-doc">     */</span></li>
<li><a name="a1035"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodTRIMMEAN">TRIMMEAN</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1036"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1037"></a>&nbsp;</li>
<li><a name="a1038"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a1039"></a>        <span class="src-var">$percent </span>= <a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1040"></a>&nbsp;</li>
<li><a name="a1041"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$percent</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$percent</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1042"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$percent </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$percent </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1043"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1044"></a>            <span class="src-sym">}</span></li>
<li><a name="a1045"></a>            <span class="src-var">$mArgs </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1046"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1047"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1048"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1049"></a>                    <span class="src-var">$mArgs</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1050"></a>                <span class="src-sym">}</span></li>
<li><a name="a1051"></a>            <span class="src-sym">}</span></li>
<li><a name="a1052"></a>            <span class="src-var">$discard </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COUNT</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">) </span>* <span class="src-var">$percent </span>/ <span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1053"></a>            <a href="http://www.php.net/sort">sort</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1054"></a>            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-var">$discard</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1055"></a>                <a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1056"></a>                <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1057"></a>            <span class="src-sym">}</span></li>
<li><a name="a1058"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">AVERAGE</span><span class="src-sym">(</span><span class="src-var">$mArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1059"></a>        <span class="src-sym">}</span></li>
<li><a name="a1060"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1061"></a>    <span class="src-sym">}</span></li>
<li><a name="a1062"></a>&nbsp;</li>
<li><a name="a1063"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1064"></a><span class="src-doc">     * STDEV</span></li>
<li><a name="a1065"></a><span class="src-doc">     *</span></li>
<li><a name="a1066"></a><span class="src-doc">     * Estimates standard deviation based on a sample. The standard deviation is a measure of how</span></li>
<li><a name="a1067"></a><span class="src-doc">     * widely values are dispersed from the average value (the mean).</span></li>
<li><a name="a1068"></a><span class="src-doc">     *</span></li>
<li><a name="a1069"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1070"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1071"></a><span class="src-doc">     */</span></li>
<li><a name="a1072"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTDEV">STDEV</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1073"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1074"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a1075"></a>&nbsp;</li>
<li><a name="a1076"></a>        <span class="src-var">$aMean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1077"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1078"></a>            <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1079"></a>&nbsp;</li>
<li><a name="a1080"></a>            <span class="src-var">$aCount </span>= -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1081"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1082"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1083"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1084"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1085"></a>                        <span class="src-var">$returnValue </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1086"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1087"></a>                        <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1088"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1089"></a>                    ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1090"></a>                <span class="src-sym">}</span></li>
<li><a name="a1091"></a>            <span class="src-sym">}</span></li>
<li><a name="a1092"></a>&nbsp;</li>
<li><a name="a1093"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a1094"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$returnValue </span>&gt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1095"></a>                <span class="src-key">return </span><a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1096"></a>            <span class="src-sym">}</span></li>
<li><a name="a1097"></a>        <span class="src-sym">}</span></li>
<li><a name="a1098"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1099"></a>    <span class="src-sym">}</span></li>
<li><a name="a1100"></a>&nbsp;</li>
<li><a name="a1101"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1102"></a><span class="src-doc">     * STDEVA</span></li>
<li><a name="a1103"></a><span class="src-doc">     *</span></li>
<li><a name="a1104"></a><span class="src-doc">     * Estimates standard deviation based on a sample, including numbers, text, and logical values</span></li>
<li><a name="a1105"></a><span class="src-doc">     *</span></li>
<li><a name="a1106"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1107"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1108"></a><span class="src-doc">     */</span></li>
<li><a name="a1109"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTDEVA">STDEVA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1110"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1111"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a1112"></a>&nbsp;</li>
<li><a name="a1113"></a>        <span class="src-var">$aMean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGEA">AVERAGEA</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1114"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1115"></a>            <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1116"></a>&nbsp;</li>
<li><a name="a1117"></a>            <span class="src-var">$aCount </span>= -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1118"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1119"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1120"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">&amp; </span><span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a1121"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1122"></a>                        <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1123"></a>                    <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1124"></a>                        <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1125"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1126"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1127"></a>                        <span class="src-var">$returnValue </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1128"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1129"></a>                        <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1130"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1131"></a>                    ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1132"></a>                <span class="src-sym">}</span></li>
<li><a name="a1133"></a>            <span class="src-sym">}</span></li>
<li><a name="a1134"></a>&nbsp;</li>
<li><a name="a1135"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a1136"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$returnValue </span>&gt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1137"></a>                <span class="src-key">return </span><a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1138"></a>            <span class="src-sym">}</span></li>
<li><a name="a1139"></a>        <span class="src-sym">}</span></li>
<li><a name="a1140"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1141"></a>    <span class="src-sym">}</span></li>
<li><a name="a1142"></a>&nbsp;</li>
<li><a name="a1143"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1144"></a><span class="src-doc">     * STDEVP</span></li>
<li><a name="a1145"></a><span class="src-doc">     *</span></li>
<li><a name="a1146"></a><span class="src-doc">     * Calculates standard deviation based on the entire population</span></li>
<li><a name="a1147"></a><span class="src-doc">     *</span></li>
<li><a name="a1148"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1149"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1150"></a><span class="src-doc">     */</span></li>
<li><a name="a1151"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTDEVP">STDEVP</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1152"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1153"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a1154"></a>&nbsp;</li>
<li><a name="a1155"></a>        <span class="src-var">$aMean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1156"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1157"></a>            <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1158"></a>&nbsp;</li>
<li><a name="a1159"></a>            <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1160"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1161"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1162"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1163"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1164"></a>                        <span class="src-var">$returnValue </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1165"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1166"></a>                        <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1167"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1168"></a>                    ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1169"></a>                <span class="src-sym">}</span></li>
<li><a name="a1170"></a>            <span class="src-sym">}</span></li>
<li><a name="a1171"></a>&nbsp;</li>
<li><a name="a1172"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a1173"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$returnValue </span>&gt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1174"></a>                <span class="src-key">return </span><a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1175"></a>            <span class="src-sym">}</span></li>
<li><a name="a1176"></a>        <span class="src-sym">}</span></li>
<li><a name="a1177"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1178"></a>    <span class="src-sym">}</span></li>
<li><a name="a1179"></a>&nbsp;</li>
<li><a name="a1180"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1181"></a><span class="src-doc">     * STDEVPA</span></li>
<li><a name="a1182"></a><span class="src-doc">     *</span></li>
<li><a name="a1183"></a><span class="src-doc">     * Calculates standard deviation based on the entire population, including numbers, text, and logical values</span></li>
<li><a name="a1184"></a><span class="src-doc">     *</span></li>
<li><a name="a1185"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1186"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1187"></a><span class="src-doc">     */</span></li>
<li><a name="a1188"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTDEVPA">STDEVPA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1189"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1190"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a1191"></a>&nbsp;</li>
<li><a name="a1192"></a>        <span class="src-var">$aMean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGEA">AVERAGEA</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1193"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$aMean</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1194"></a>            <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1195"></a>&nbsp;</li>
<li><a name="a1196"></a>            <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1197"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1198"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1199"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">&amp; </span><span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a1200"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1201"></a>                        <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1202"></a>                    <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1203"></a>                        <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1204"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1205"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$returnValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1206"></a>                        <span class="src-var">$returnValue </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1207"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1208"></a>                        <span class="src-var">$returnValue </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">((</span><span class="src-var">$arg </span>- <span class="src-var">$aMean</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1209"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1210"></a>                    ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1211"></a>                <span class="src-sym">}</span></li>
<li><a name="a1212"></a>            <span class="src-sym">}</span></li>
<li><a name="a1213"></a>&nbsp;</li>
<li><a name="a1214"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a1215"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$returnValue </span>&gt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1216"></a>                <span class="src-key">return </span><a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$returnValue </span>/ <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1217"></a>            <span class="src-sym">}</span></li>
<li><a name="a1218"></a>        <span class="src-sym">}</span></li>
<li><a name="a1219"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1220"></a>    <span class="src-sym">}</span></li>
<li><a name="a1221"></a>&nbsp;</li>
<li><a name="a1222"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1223"></a><span class="src-doc">     * VARFunc</span></li>
<li><a name="a1224"></a><span class="src-doc">     *</span></li>
<li><a name="a1225"></a><span class="src-doc">     * Estimates variance based on a sample.</span></li>
<li><a name="a1226"></a><span class="src-doc">     *</span></li>
<li><a name="a1227"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1228"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1229"></a><span class="src-doc">     */</span></li>
<li><a name="a1230"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodVARFunc">VARFunc</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1231"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1232"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1233"></a>&nbsp;</li>
<li><a name="a1234"></a>        <span class="src-var">$summerA </span>= <span class="src-var">$summerB </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1235"></a>&nbsp;</li>
<li><a name="a1236"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a1237"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1238"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1239"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1240"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1241"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1242"></a>                <span class="src-var">$summerA </span>+= <span class="src-sym">(</span><span class="src-var">$arg </span>* <span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1243"></a>                <span class="src-var">$summerB </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1244"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1245"></a>            <span class="src-sym">}</span></li>
<li><a name="a1246"></a>        <span class="src-sym">}</span></li>
<li><a name="a1247"></a>&nbsp;</li>
<li><a name="a1248"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a1249"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1250"></a>            <span class="src-var">$summerA </span>= <span class="src-var">$summerA </span>* <span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1251"></a>            <span class="src-var">$summerB </span>= <span class="src-sym">(</span><span class="src-var">$summerB </span>* <span class="src-var">$summerB</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1252"></a>            <span class="src-var">$returnValue </span>= <span class="src-sym">(</span><span class="src-var">$summerA </span>- <span class="src-var">$summerB</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$aCount </span>* <span class="src-sym">(</span><span class="src-var">$aCount </span>- <span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1253"></a>        <span class="src-sym">}</span></li>
<li><a name="a1254"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1255"></a>    <span class="src-sym">}</span></li>
<li><a name="a1256"></a>&nbsp;</li>
<li><a name="a1257"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1258"></a><span class="src-doc">     * VARA</span></li>
<li><a name="a1259"></a><span class="src-doc">     *</span></li>
<li><a name="a1260"></a><span class="src-doc">     * Estimates variance based on a sample, including numbers, text, and logical values</span></li>
<li><a name="a1261"></a><span class="src-doc">     *</span></li>
<li><a name="a1262"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1263"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1264"></a><span class="src-doc">     */</span></li>
<li><a name="a1265"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodVARA">VARA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1266"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1267"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1268"></a>&nbsp;</li>
<li><a name="a1269"></a>        <span class="src-var">$summerA </span>= <span class="src-var">$summerB </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1270"></a>&nbsp;</li>
<li><a name="a1271"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a1272"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1273"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1274"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1275"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1276"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">&amp; </span><span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a1277"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1278"></a>                    <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1279"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1280"></a>                    <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1281"></a>                <span class="src-sym">}</span></li>
<li><a name="a1282"></a>                <span class="src-var">$summerA </span>+= <span class="src-sym">(</span><span class="src-var">$arg </span>* <span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1283"></a>                <span class="src-var">$summerB </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1284"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1285"></a>            <span class="src-sym">}</span></li>
<li><a name="a1286"></a>        <span class="src-sym">}</span></li>
<li><a name="a1287"></a>&nbsp;</li>
<li><a name="a1288"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a1289"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1290"></a>            <span class="src-var">$summerA </span>= <span class="src-var">$summerA </span>* <span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1291"></a>            <span class="src-var">$summerB </span>= <span class="src-sym">(</span><span class="src-var">$summerB </span>* <span class="src-var">$summerB</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1292"></a>            <span class="src-var">$returnValue </span>= <span class="src-sym">(</span><span class="src-var">$summerA </span>- <span class="src-var">$summerB</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$aCount </span>* <span class="src-sym">(</span><span class="src-var">$aCount </span>- <span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1293"></a>        <span class="src-sym">}</span></li>
<li><a name="a1294"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1295"></a>    <span class="src-sym">}</span></li>
<li><a name="a1296"></a>&nbsp;</li>
<li><a name="a1297"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1298"></a><span class="src-doc">     * VARP</span></li>
<li><a name="a1299"></a><span class="src-doc">     *</span></li>
<li><a name="a1300"></a><span class="src-doc">     * Calculates variance based on the entire population</span></li>
<li><a name="a1301"></a><span class="src-doc">     *</span></li>
<li><a name="a1302"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1303"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1304"></a><span class="src-doc">     */</span></li>
<li><a name="a1305"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodVARP">VARP</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1306"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1307"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1308"></a>&nbsp;</li>
<li><a name="a1309"></a>        <span class="src-var">$summerA </span>= <span class="src-var">$summerB </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1310"></a>&nbsp;</li>
<li><a name="a1311"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a1312"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1313"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1314"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1315"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1316"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1317"></a>                <span class="src-var">$summerA </span>+= <span class="src-sym">(</span><span class="src-var">$arg </span>* <span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1318"></a>                <span class="src-var">$summerB </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1319"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1320"></a>            <span class="src-sym">}</span></li>
<li><a name="a1321"></a>        <span class="src-sym">}</span></li>
<li><a name="a1322"></a>&nbsp;</li>
<li><a name="a1323"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a1324"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1325"></a>            <span class="src-var">$summerA </span>= <span class="src-var">$summerA </span>* <span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1326"></a>            <span class="src-var">$summerB </span>= <span class="src-sym">(</span><span class="src-var">$summerB </span>* <span class="src-var">$summerB</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1327"></a>            <span class="src-var">$returnValue </span>= <span class="src-sym">(</span><span class="src-var">$summerA </span>- <span class="src-var">$summerB</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$aCount </span>* <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1328"></a>        <span class="src-sym">}</span></li>
<li><a name="a1329"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1330"></a>    <span class="src-sym">}</span></li>
<li><a name="a1331"></a>&nbsp;</li>
<li><a name="a1332"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1333"></a><span class="src-doc">     * VARPA</span></li>
<li><a name="a1334"></a><span class="src-doc">     *</span></li>
<li><a name="a1335"></a><span class="src-doc">     * Calculates variance based on the entire population, including numbers, text, and logical values</span></li>
<li><a name="a1336"></a><span class="src-doc">     *</span></li>
<li><a name="a1337"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1338"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1339"></a><span class="src-doc">     */</span></li>
<li><a name="a1340"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodVARPA">VARPA</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1341"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1342"></a>        <span class="src-var">$returnValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1343"></a>&nbsp;</li>
<li><a name="a1344"></a>        <span class="src-var">$summerA </span>= <span class="src-var">$summerB </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1345"></a>&nbsp;</li>
<li><a name="a1346"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a1347"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1348"></a>        <span class="src-var">$aCount </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1349"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1350"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1351"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>|| <span class="src-sym">((</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">&amp; </span><span class="src-sym">(</span><span class="src-var">$arg </span>!= <span class="src-str">''</span><span class="src-sym">)))) </span><span class="src-sym">{</span></li>
<li><a name="a1352"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1353"></a>                    <span class="src-var">$arg </span>= (integer) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1354"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1355"></a>                    <span class="src-var">$arg </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1356"></a>                <span class="src-sym">}</span></li>
<li><a name="a1357"></a>                <span class="src-var">$summerA </span>+= <span class="src-sym">(</span><span class="src-var">$arg </span>* <span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1358"></a>                <span class="src-var">$summerB </span>+= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a1359"></a>                ++<span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1360"></a>            <span class="src-sym">}</span></li>
<li><a name="a1361"></a>        <span class="src-sym">}</span></li>
<li><a name="a1362"></a>&nbsp;</li>
<li><a name="a1363"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a1364"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$aCount </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1365"></a>            <span class="src-var">$summerA </span>= <span class="src-var">$summerA </span>* <span class="src-var">$aCount</span><span class="src-sym">;</span></li>
<li><a name="a1366"></a>            <span class="src-var">$summerB </span>= <span class="src-sym">(</span><span class="src-var">$summerB </span>* <span class="src-var">$summerB</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1367"></a>            <span class="src-var">$returnValue </span>= <span class="src-sym">(</span><span class="src-var">$summerA </span>- <span class="src-var">$summerB</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$aCount </span>* <span class="src-var">$aCount</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1368"></a>        <span class="src-sym">}</span></li>
<li><a name="a1369"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1370"></a>    <span class="src-sym">}</span></li>
<li><a name="a1371"></a>&nbsp;</li>
<li><a name="a1372"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1373"></a><span class="src-doc">     * SUBTOTAL</span></li>
<li><a name="a1374"></a><span class="src-doc">     *</span></li>
<li><a name="a1375"></a><span class="src-doc">     * Returns a subtotal in a list or database.</span></li>
<li><a name="a1376"></a><span class="src-doc">     *</span></li>
<li><a name="a1377"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       the number 1 to 11 that specifies which function to</span></li>
<li><a name="a1378"></a><span class="src-doc">     *                     use in calculating subtotals within a list.</span></li>
<li><a name="a1379"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1380"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a1381"></a><span class="src-doc">     */</span></li>
<li><a name="a1382"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSUBTOTAL">SUBTOTAL</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1383"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1384"></a>&nbsp;</li>
<li><a name="a1385"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a1386"></a>        <span class="src-var">$subtotal </span>= <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1387"></a>&nbsp;</li>
<li><a name="a1388"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$subtotal</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$subtotal</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1389"></a>            <span class="src-key">switch</span><span class="src-sym">(</span><span class="src-var">$subtotal</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1390"></a>                <span class="src-key">case </span><span class="src-num">1    </span>:</li>
<li><a name="a1391"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">AVERAGE</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1392"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1393"></a>                <span class="src-key">case </span><span class="src-num">2    </span>:</li>
<li><a name="a1394"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COUNT</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1395"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1396"></a>                <span class="src-key">case </span><span class="src-num">3    </span>:</li>
<li><a name="a1397"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COUNTA</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1398"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1399"></a>                <span class="src-key">case </span><span class="src-num">4    </span>:</li>
<li><a name="a1400"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">MAX</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1401"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1402"></a>                <span class="src-key">case </span><span class="src-num">5    </span>:</li>
<li><a name="a1403"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">MIN</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1404"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1405"></a>                <span class="src-key">case </span><span class="src-num">6    </span>:</li>
<li><a name="a1406"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">PRODUCT</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1407"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1408"></a>                <span class="src-key">case </span><span class="src-num">7    </span>:</li>
<li><a name="a1409"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">STDEV</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1410"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1411"></a>                <span class="src-key">case </span><span class="src-num">8    </span>:</li>
<li><a name="a1412"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">STDEVP</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1413"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1414"></a>                <span class="src-key">case </span><span class="src-num">9    </span>:</li>
<li><a name="a1415"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">SUM</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1416"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1417"></a>                <span class="src-key">case </span><span class="src-num">10    </span>:</li>
<li><a name="a1418"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">VARFunc</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1419"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1420"></a>                <span class="src-key">case </span><span class="src-num">11    </span>:</li>
<li><a name="a1421"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">VARP</span><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1422"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1423"></a>            <span class="src-sym">}</span></li>
<li><a name="a1424"></a>        <span class="src-sym">}</span></li>
<li><a name="a1425"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1426"></a>    <span class="src-sym">}</span></li>
<li><a name="a1427"></a>&nbsp;</li>
<li><a name="a1428"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1429"></a><span class="src-doc">     * SQRTPI</span></li>
<li><a name="a1430"></a><span class="src-doc">     *</span></li>
<li><a name="a1431"></a><span class="src-doc">     * Returns the square root of (number * pi).</span></li>
<li><a name="a1432"></a><span class="src-doc">     *</span></li>
<li><a name="a1433"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">       Number</span></li>
<li><a name="a1434"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Square Root of Number * Pi</span></li>
<li><a name="a1435"></a><span class="src-doc">     */</span></li>
<li><a name="a1436"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSQRTPI">SQRTPI</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1437"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1438"></a>&nbsp;</li>
<li><a name="a1439"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1440"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$number </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1441"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1442"></a>            <span class="src-sym">}</span></li>
<li><a name="a1443"></a>            <span class="src-key">return </span><span class="src-id">sqrt</span><span class="src-sym">(</span><span class="src-var">$number </span>* <a href="http://www.php.net/pi">pi</a><span class="src-sym">(</span><span class="src-sym">)) </span><span class="src-sym">;</span></li>
<li><a name="a1444"></a>        <span class="src-sym">}</span></li>
<li><a name="a1445"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1446"></a>    <span class="src-sym">}</span></li>
<li><a name="a1447"></a>&nbsp;</li>
<li><a name="a1448"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1449"></a><span class="src-doc">     * FACT</span></li>
<li><a name="a1450"></a><span class="src-doc">     *</span></li>
<li><a name="a1451"></a><span class="src-doc">     * Returns the factorial of a number.</span></li>
<li><a name="a1452"></a><span class="src-doc">     *</span></li>
<li><a name="a1453"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$factVal </span><span class="src-doc">   Factorial Value</span></li>
<li><a name="a1454"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Factorial</span></li>
<li><a name="a1455"></a><span class="src-doc">     */</span></li>
<li><a name="a1456"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodFACT">FACT</a><span class="src-sym">(</span><span class="src-var">$factVal</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1457"></a>        <span class="src-var">$factVal    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$factVal</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1458"></a>&nbsp;</li>
<li><a name="a1459"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$factVal</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1460"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$factVal </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1461"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1462"></a>            <span class="src-sym">}</span></li>
<li><a name="a1463"></a>            <span class="src-var">$factLoop </span>= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$factVal</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1464"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1465"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$factVal </span>&gt; <span class="src-var">$factLoop</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1466"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1467"></a>                <span class="src-sym">}</span></li>
<li><a name="a1468"></a>            <span class="src-sym">}</span></li>
<li><a name="a1469"></a>            <span class="src-var">$factorial </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1470"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$factLoop </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1471"></a>                <span class="src-var">$factorial </span>*= <span class="src-var">$factLoop</span>--<span class="src-sym">;</span></li>
<li><a name="a1472"></a>            <span class="src-sym">}</span></li>
<li><a name="a1473"></a>            <span class="src-key">return </span><span class="src-var">$factorial </span><span class="src-sym">;</span></li>
<li><a name="a1474"></a>        <span class="src-sym">}</span></li>
<li><a name="a1475"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1476"></a>    <span class="src-sym">}</span></li>
<li><a name="a1477"></a>&nbsp;</li>
<li><a name="a1478"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1479"></a><span class="src-doc">     * FACTDOUBLE</span></li>
<li><a name="a1480"></a><span class="src-doc">     *</span></li>
<li><a name="a1481"></a><span class="src-doc">     * Returns the double factorial of a number.</span></li>
<li><a name="a1482"></a><span class="src-doc">     *</span></li>
<li><a name="a1483"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$factVal </span><span class="src-doc">   Factorial Value</span></li>
<li><a name="a1484"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Double Factorial</span></li>
<li><a name="a1485"></a><span class="src-doc">     */</span></li>
<li><a name="a1486"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodFACTDOUBLE">FACTDOUBLE</a><span class="src-sym">(</span><span class="src-var">$factVal</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1487"></a>        <span class="src-var">$factLoop    </span>= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$factVal</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1488"></a>&nbsp;</li>
<li><a name="a1489"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$factLoop</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1490"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$factVal </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1491"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1492"></a>            <span class="src-sym">}</span></li>
<li><a name="a1493"></a>            <span class="src-var">$factorial </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1494"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$factLoop </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1495"></a>                <span class="src-var">$factorial </span>*= <span class="src-var">$factLoop</span>--<span class="src-sym">;</span></li>
<li><a name="a1496"></a>                --<span class="src-var">$factLoop</span><span class="src-sym">;</span></li>
<li><a name="a1497"></a>            <span class="src-sym">}</span></li>
<li><a name="a1498"></a>            <span class="src-key">return </span><span class="src-var">$factorial </span><span class="src-sym">;</span></li>
<li><a name="a1499"></a>        <span class="src-sym">}</span></li>
<li><a name="a1500"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1501"></a>    <span class="src-sym">}</span></li>
<li><a name="a1502"></a>&nbsp;</li>
<li><a name="a1503"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1504"></a><span class="src-doc">     * MULTINOMIAL</span></li>
<li><a name="a1505"></a><span class="src-doc">     *</span></li>
<li><a name="a1506"></a><span class="src-doc">     * Returns the ratio of the factorial of a sum of values to the product of factorials.</span></li>
<li><a name="a1507"></a><span class="src-doc">     *</span></li>
<li><a name="a1508"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1509"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1510"></a><span class="src-doc">     */</span></li>
<li><a name="a1511"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMULTINOMIAL">MULTINOMIAL</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1512"></a>&nbsp;</li>
<li><a name="a1513"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a1514"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1515"></a>        <span class="src-var">$summer </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1516"></a>        <span class="src-var">$divisor </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1517"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1518"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1519"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1520"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$arg </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1521"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1522"></a>                <span class="src-sym">}</span></li>
<li><a name="a1523"></a>                <span class="src-var">$summer </span>+= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1524"></a>                <span class="src-var">$divisor </span>*= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1525"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1526"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1527"></a>            <span class="src-sym">}</span></li>
<li><a name="a1528"></a>        <span class="src-sym">}</span></li>
<li><a name="a1529"></a>&nbsp;</li>
<li><a name="a1530"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a1531"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$summer </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1532"></a>            <span class="src-var">$summer </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$summer</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1533"></a>            <span class="src-key">return </span><span class="src-var">$summer </span>/ <span class="src-var">$divisor</span><span class="src-sym">;</span></li>
<li><a name="a1534"></a>        <span class="src-sym">}</span></li>
<li><a name="a1535"></a>        <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1536"></a>    <span class="src-sym">}</span></li>
<li><a name="a1537"></a>&nbsp;</li>
<li><a name="a1538"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1539"></a><span class="src-doc">     * CEILING</span></li>
<li><a name="a1540"></a><span class="src-doc">     *</span></li>
<li><a name="a1541"></a><span class="src-doc">     * Returns number rounded up, away from zero, to the nearest multiple of significance.</span></li>
<li><a name="a1542"></a><span class="src-doc">     *</span></li>
<li><a name="a1543"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1544"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$significance </span><span class="src-doc">   Significance</span></li>
<li><a name="a1545"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Rounded Number</span></li>
<li><a name="a1546"></a><span class="src-doc">     */</span></li>
<li><a name="a1547"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCEILING">CEILING</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$significance</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1548"></a>        <span class="src-var">$number            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1549"></a>        <span class="src-var">$significance    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$significance</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1550"></a>&nbsp;</li>
<li><a name="a1551"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$significance</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1552"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$significance </span>== <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1553"></a>                <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1554"></a>            <span class="src-sym">}</span></li>
<li><a name="a1555"></a>            <span class="src-key">return </span><a href="http://www.php.net/ceil">ceil</a><span class="src-sym">(</span><span class="src-var">$number </span>/ <span class="src-var">$significance</span><span class="src-sym">) </span>* <span class="src-var">$significance</span><span class="src-sym">;</span></li>
<li><a name="a1556"></a>        <span class="src-sym">}</span></li>
<li><a name="a1557"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1558"></a>    <span class="src-sym">}</span></li>
<li><a name="a1559"></a>&nbsp;</li>
<li><a name="a1560"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1561"></a><span class="src-doc">     * EVEN</span></li>
<li><a name="a1562"></a><span class="src-doc">     *</span></li>
<li><a name="a1563"></a><span class="src-doc">     * Returns number rounded up to the nearest even integer.</span></li>
<li><a name="a1564"></a><span class="src-doc">     *</span></li>
<li><a name="a1565"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1566"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Rounded Number</span></li>
<li><a name="a1567"></a><span class="src-doc">     */</span></li>
<li><a name="a1568"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodEVEN">EVEN</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1569"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1570"></a>&nbsp;</li>
<li><a name="a1571"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1572"></a>            <span class="src-var">$significance </span>= <span class="src-num">2 </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">SIGN</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1573"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">CEILING</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$significance</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1574"></a>        <span class="src-sym">}</span></li>
<li><a name="a1575"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1576"></a>    <span class="src-sym">}</span></li>
<li><a name="a1577"></a>&nbsp;</li>
<li><a name="a1578"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1579"></a><span class="src-doc">     * ODD</span></li>
<li><a name="a1580"></a><span class="src-doc">     *</span></li>
<li><a name="a1581"></a><span class="src-doc">     * Returns number rounded up to the nearest odd integer.</span></li>
<li><a name="a1582"></a><span class="src-doc">     *</span></li>
<li><a name="a1583"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1584"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Rounded Number</span></li>
<li><a name="a1585"></a><span class="src-doc">     */</span></li>
<li><a name="a1586"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodODD">ODD</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1587"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1588"></a>&nbsp;</li>
<li><a name="a1589"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1590"></a>            <span class="src-var">$significance </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">SIGN</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1591"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$significance </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1592"></a>                <span class="src-key">return </span><span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1593"></a>            <span class="src-sym">}</span></li>
<li><a name="a1594"></a>            <span class="src-var">$result </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">CEILING</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$significance</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1595"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">IS_EVEN</span><span class="src-sym">(</span><span class="src-var">$result</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1596"></a>                <span class="src-var">$result </span>+= <span class="src-var">$significance</span><span class="src-sym">;</span></li>
<li><a name="a1597"></a>            <span class="src-sym">}</span></li>
<li><a name="a1598"></a>            <span class="src-key">return </span><span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a1599"></a>        <span class="src-sym">}</span></li>
<li><a name="a1600"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1601"></a>    <span class="src-sym">}</span></li>
<li><a name="a1602"></a>&nbsp;</li>
<li><a name="a1603"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1604"></a><span class="src-doc">     * ROUNDUP</span></li>
<li><a name="a1605"></a><span class="src-doc">     *</span></li>
<li><a name="a1606"></a><span class="src-doc">     * Rounds a number up to a specified number of decimal places</span></li>
<li><a name="a1607"></a><span class="src-doc">     *</span></li>
<li><a name="a1608"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1609"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$digits </span><span class="src-doc">           Number of digits to which you want to round $number</span></li>
<li><a name="a1610"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Rounded Number</span></li>
<li><a name="a1611"></a><span class="src-doc">     */</span></li>
<li><a name="a1612"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodROUNDUP">ROUNDUP</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$digits</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1613"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1614"></a>        <span class="src-var">$digits    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1615"></a>&nbsp;</li>
<li><a name="a1616"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1617"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$digits</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$digits </span>&gt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1618"></a>                <span class="src-var">$significance </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">10</span><span class="src-sym">,</span><span class="src-var">$digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1619"></a>                <span class="src-key">return </span><a href="http://www.php.net/ceil">ceil</a><span class="src-sym">(</span><span class="src-var">$number </span>* <span class="src-var">$significance</span><span class="src-sym">) </span>/ <span class="src-var">$significance</span><span class="src-sym">;</span></li>
<li><a name="a1620"></a>            <span class="src-sym">}</span></li>
<li><a name="a1621"></a>        <span class="src-sym">}</span></li>
<li><a name="a1622"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1623"></a>    <span class="src-sym">}</span></li>
<li><a name="a1624"></a>&nbsp;</li>
<li><a name="a1625"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1626"></a><span class="src-doc">     * ROUNDDOWN</span></li>
<li><a name="a1627"></a><span class="src-doc">     *</span></li>
<li><a name="a1628"></a><span class="src-doc">     * Rounds a number down to a specified number of decimal places</span></li>
<li><a name="a1629"></a><span class="src-doc">     *</span></li>
<li><a name="a1630"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1631"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$digits </span><span class="src-doc">           Number of digits to which you want to round $number</span></li>
<li><a name="a1632"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Rounded Number</span></li>
<li><a name="a1633"></a><span class="src-doc">     */</span></li>
<li><a name="a1634"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodROUNDDOWN">ROUNDDOWN</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$digits</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1635"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1636"></a>        <span class="src-var">$digits    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1637"></a>&nbsp;</li>
<li><a name="a1638"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1639"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$digits</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$digits </span>&gt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1640"></a>                <span class="src-var">$significance </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">10</span><span class="src-sym">,</span><span class="src-var">$digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1641"></a>                <span class="src-key">return </span><a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$number </span>* <span class="src-var">$significance</span><span class="src-sym">) </span>/ <span class="src-var">$significance</span><span class="src-sym">;</span></li>
<li><a name="a1642"></a>            <span class="src-sym">}</span></li>
<li><a name="a1643"></a>        <span class="src-sym">}</span></li>
<li><a name="a1644"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1645"></a>    <span class="src-sym">}</span></li>
<li><a name="a1646"></a>&nbsp;</li>
<li><a name="a1647"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1648"></a><span class="src-doc">     * MROUND</span></li>
<li><a name="a1649"></a><span class="src-doc">     *</span></li>
<li><a name="a1650"></a><span class="src-doc">     * Rounds a number to the nearest multiple of a specified value</span></li>
<li><a name="a1651"></a><span class="src-doc">     *</span></li>
<li><a name="a1652"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1653"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$multiple </span><span class="src-doc">       Multiple to which you want to round $number</span></li>
<li><a name="a1654"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Rounded Number</span></li>
<li><a name="a1655"></a><span class="src-doc">     */</span></li>
<li><a name="a1656"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMROUND">MROUND</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$multiple</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1657"></a>        <span class="src-var">$number        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1658"></a>        <span class="src-var">$multiple    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$multiple</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1659"></a>&nbsp;</li>
<li><a name="a1660"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$multiple</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1661"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">SIGN</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span>== <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">SIGN</span><span class="src-sym">(</span><span class="src-var">$multiple</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1662"></a>                <span class="src-var">$lowerVal </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$number </span>/ <span class="src-var">$multiple</span><span class="src-sym">) </span>* <span class="src-var">$multiple</span><span class="src-sym">;</span></li>
<li><a name="a1663"></a>                <span class="src-var">$upperVal </span>= <a href="http://www.php.net/ceil">ceil</a><span class="src-sym">(</span><span class="src-var">$number </span>/ <span class="src-var">$multiple</span><span class="src-sym">) </span>* <span class="src-var">$multiple</span><span class="src-sym">;</span></li>
<li><a name="a1664"></a>                <span class="src-var">$adjustUp </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$number </span>- <span class="src-var">$upperVal</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1665"></a>                <span class="src-var">$adjustDown </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$number </span>- <span class="src-var">$lowerVal</span><span class="src-sym">) </span>+ <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#definePRECISION">PRECISION</a></span><span class="src-sym">;</span></li>
<li><a name="a1666"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$adjustDown </span>&lt; <span class="src-var">$adjustUp</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1667"></a>                    <span class="src-key">return </span><span class="src-var">$lowerVal</span><span class="src-sym">;</span></li>
<li><a name="a1668"></a>                <span class="src-sym">}</span></li>
<li><a name="a1669"></a>                <span class="src-key">return </span><span class="src-var">$upperVal</span><span class="src-sym">;</span></li>
<li><a name="a1670"></a>            <span class="src-sym">}</span></li>
<li><a name="a1671"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1672"></a>        <span class="src-sym">}</span></li>
<li><a name="a1673"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1674"></a>    <span class="src-sym">}</span></li>
<li><a name="a1675"></a>&nbsp;</li>
<li><a name="a1676"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1677"></a><span class="src-doc">     * SIGN</span></li>
<li><a name="a1678"></a><span class="src-doc">     *</span></li>
<li><a name="a1679"></a><span class="src-doc">     * Determines the sign of a number. Returns 1 if the number is positive, zero (0)</span></li>
<li><a name="a1680"></a><span class="src-doc">     * if the number is 0, and -1 if the number is negative.</span></li>
<li><a name="a1681"></a><span class="src-doc">     *</span></li>
<li><a name="a1682"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1683"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       sign value</span></li>
<li><a name="a1684"></a><span class="src-doc">     */</span></li>
<li><a name="a1685"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSIGN">SIGN</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1686"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1687"></a>&nbsp;</li>
<li><a name="a1688"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1689"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$number </span>== <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1690"></a>                <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1691"></a>            <span class="src-sym">}</span></li>
<li><a name="a1692"></a>            <span class="src-key">return </span><span class="src-var">$number </span>/ <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1693"></a>        <span class="src-sym">}</span></li>
<li><a name="a1694"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1695"></a>    <span class="src-sym">}</span></li>
<li><a name="a1696"></a>&nbsp;</li>
<li><a name="a1697"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1698"></a><span class="src-doc">     * FLOOR</span></li>
<li><a name="a1699"></a><span class="src-doc">     *</span></li>
<li><a name="a1700"></a><span class="src-doc">     * Rounds number down, toward zero, to the nearest multiple of significance.</span></li>
<li><a name="a1701"></a><span class="src-doc">     *</span></li>
<li><a name="a1702"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">           Number to round</span></li>
<li><a name="a1703"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$significance </span><span class="src-doc">   Significance</span></li>
<li><a name="a1704"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Rounded Number</span></li>
<li><a name="a1705"></a><span class="src-doc">     */</span></li>
<li><a name="a1706"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodFLOOR">FLOOR</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">,</span><span class="src-var">$significance</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1707"></a>        <span class="src-var">$number            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1708"></a>        <span class="src-var">$significance    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$significance</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1709"></a>&nbsp;</li>
<li><a name="a1710"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$significance</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1711"></a>            <span class="src-key">return </span><a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$number </span>/ <span class="src-var">$significance</span><span class="src-sym">) </span>* <span class="src-var">$significance</span><span class="src-sym">;</span></li>
<li><a name="a1712"></a>        <span class="src-sym">}</span></li>
<li><a name="a1713"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1714"></a>    <span class="src-sym">}</span></li>
<li><a name="a1715"></a>&nbsp;</li>
<li><a name="a1716"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1717"></a><span class="src-doc">     * PERMUT</span></li>
<li><a name="a1718"></a><span class="src-doc">     *</span></li>
<li><a name="a1719"></a><span class="src-doc">     * Returns the number of permutations for a given number of objects that can be</span></li>
<li><a name="a1720"></a><span class="src-doc">     * selected from number objects. A permutation is any set or subset of objects or</span></li>
<li><a name="a1721"></a><span class="src-doc">     * events where internal order is significant. Permutations are different from</span></li>
<li><a name="a1722"></a><span class="src-doc">     * combinations, for which the internal order is not significant. Use this function</span></li>
<li><a name="a1723"></a><span class="src-doc">     * for lottery-style probability calculations.</span></li>
<li><a name="a1724"></a><span class="src-doc">     *</span></li>
<li><a name="a1725"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$numObjs </span><span class="src-doc">   Number of different objects</span></li>
<li><a name="a1726"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$numInSet </span><span class="src-doc">   Number of objects in each permutation</span></li>
<li><a name="a1727"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Number of permutations</span></li>
<li><a name="a1728"></a><span class="src-doc">     */</span></li>
<li><a name="a1729"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodPERMUT">PERMUT</a><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">,</span><span class="src-var">$numInSet</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1730"></a>        <span class="src-var">$numObjs    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1731"></a>        <span class="src-var">$numInSet    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$numInSet</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1732"></a>&nbsp;</li>
<li><a name="a1733"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$numInSet</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1734"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$numObjs </span>&lt; <span class="src-var">$numInSet</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1735"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1736"></a>            <span class="src-sym">}</span></li>
<li><a name="a1737"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$numObjs </span>- <span class="src-var">$numInSet</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1738"></a>        <span class="src-sym">}</span></li>
<li><a name="a1739"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1740"></a>    <span class="src-sym">}</span></li>
<li><a name="a1741"></a>&nbsp;</li>
<li><a name="a1742"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1743"></a><span class="src-doc">     * COMBIN</span></li>
<li><a name="a1744"></a><span class="src-doc">     *</span></li>
<li><a name="a1745"></a><span class="src-doc">     * Returns the number of combinations for a given number of items. Use COMBIN to</span></li>
<li><a name="a1746"></a><span class="src-doc">     * determine the total possible number of groups for a given number of items.</span></li>
<li><a name="a1747"></a><span class="src-doc">     *</span></li>
<li><a name="a1748"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$numObjs </span><span class="src-doc">   Number of different objects</span></li>
<li><a name="a1749"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$numInSet </span><span class="src-doc">   Number of objects in each combination</span></li>
<li><a name="a1750"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Number of combinations</span></li>
<li><a name="a1751"></a><span class="src-doc">     */</span></li>
<li><a name="a1752"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCOMBIN">COMBIN</a><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">,</span><span class="src-var">$numInSet</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1753"></a>        <span class="src-var">$numObjs    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1754"></a>        <span class="src-var">$numInSet    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$numInSet</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1755"></a>&nbsp;</li>
<li><a name="a1756"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$numInSet</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1757"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$numObjs </span>&lt; <span class="src-var">$numInSet</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1758"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1759"></a>            <span class="src-sym">}</span></li>
<li><a name="a1760"></a>            <span class="src-key">return </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$numObjs</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$numObjs </span>- <span class="src-var">$numInSet</span><span class="src-sym">)) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$numInSet</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1761"></a>        <span class="src-sym">}</span></li>
<li><a name="a1762"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1763"></a>    <span class="src-sym">}</span></li>
<li><a name="a1764"></a>&nbsp;</li>
<li><a name="a1765"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1766"></a><span class="src-doc">     * SERIESSUM</span></li>
<li><a name="a1767"></a><span class="src-doc">     *</span></li>
<li><a name="a1768"></a><span class="src-doc">     * Returns the sum of a power series</span></li>
<li><a name="a1769"></a><span class="src-doc">     *</span></li>
<li><a name="a1770"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">           </span><span class="src-doc-var">$x </span><span class="src-doc">   Input value to the power series</span></li>
<li><a name="a1771"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">           </span><span class="src-doc-var">$n </span><span class="src-doc">   Initial power to which you want to raise $x</span></li>
<li><a name="a1772"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">           </span><span class="src-doc-var">$m </span><span class="src-doc">   Step by which to increase $n for each term in the series</span></li>
<li><a name="a1773"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">of mixed        Data Series</span></li>
<li><a name="a1774"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a1775"></a><span class="src-doc">     */</span></li>
<li><a name="a1776"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSERIESSUM">SERIESSUM</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1777"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a1778"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1779"></a>&nbsp;</li>
<li><a name="a1780"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a1781"></a>        <span class="src-var">$aArgs </span>= <span class="src-id">PHPExcel_Calculation_Functions</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1782"></a>&nbsp;</li>
<li><a name="a1783"></a>        <span class="src-var">$x </span>= <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1784"></a>        <span class="src-var">$n </span>= <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1785"></a>        <span class="src-var">$m </span>= <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1786"></a>&nbsp;</li>
<li><a name="a1787"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$m</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1788"></a>            <span class="src-comm">// Calculate</span></li>
<li><a name="a1789"></a>            <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1790"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1791"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a1792"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1793"></a>                    <span class="src-var">$returnValue </span>+= <span class="src-var">$arg </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$n </span>+ <span class="src-sym">(</span><span class="src-var">$m </span>* <span class="src-var">$i</span>++<span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1794"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1795"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1796"></a>                <span class="src-sym">}</span></li>
<li><a name="a1797"></a>            <span class="src-sym">}</span></li>
<li><a name="a1798"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a1799"></a>            <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1800"></a>        <span class="src-sym">}</span></li>
<li><a name="a1801"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1802"></a>    <span class="src-sym">}</span></li>
<li><a name="a1803"></a>&nbsp;</li>
<li><a name="a1804"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1805"></a><span class="src-doc">     * STANDARDIZE</span></li>
<li><a name="a1806"></a><span class="src-doc">     *</span></li>
<li><a name="a1807"></a><span class="src-doc">     * Returns a normalized value from a distribution characterized by mean and standard_dev.</span></li>
<li><a name="a1808"></a><span class="src-doc">     *</span></li>
<li><a name="a1809"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">       Value to normalize</span></li>
<li><a name="a1810"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$mean </span><span class="src-doc">       Mean Value</span></li>
<li><a name="a1811"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$stdDev </span><span class="src-doc">       Standard Deviation</span></li>
<li><a name="a1812"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">   Standardized value</span></li>
<li><a name="a1813"></a><span class="src-doc">     */</span></li>
<li><a name="a1814"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTANDARDIZE">STANDARDIZE</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$mean</span><span class="src-sym">,</span><span class="src-var">$stdDev</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1815"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1816"></a>        <span class="src-var">$mean    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1817"></a>        <span class="src-var">$stdDev    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1818"></a>&nbsp;</li>
<li><a name="a1819"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1820"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$stdDev </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1821"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1822"></a>            <span class="src-sym">}</span></li>
<li><a name="a1823"></a>            <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$value </span>- <span class="src-var">$mean</span><span class="src-sym">) </span>/ <span class="src-var">$stdDev </span><span class="src-sym">;</span></li>
<li><a name="a1824"></a>        <span class="src-sym">}</span></li>
<li><a name="a1825"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1826"></a>    <span class="src-sym">}</span></li>
<li><a name="a1827"></a>&nbsp;</li>
<li><a name="a1828"></a>    <span class="src-comm">//</span></li>
<li><a name="a1829"></a>    <span class="src-comm">//    Private method to return an array of the factors of the input value</span></li>
<li><a name="a1830"></a>    <span class="src-comm">//</span></li>
<li><a name="a1830"></a>    </li>
<li><a name="a1831"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodfactors">factors</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1832"></a>        <span class="src-var">$startVal </span>= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$value</span>/<span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1833"></a>&nbsp;</li>
<li><a name="a1834"></a>        <span class="src-var">$factorArray </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1835"></a>        <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-var">$startVal</span><span class="src-sym">; </span><span class="src-var">$i</span>&gt;<span class="src-num">1</span><span class="src-sym">; </span>--<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1836"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value</span>/<span class="src-var">$i</span><span class="src-sym">) </span>== <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$value</span>/<span class="src-var">$i</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1837"></a>                <span class="src-var">$subFactors </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">factors</span><span class="src-sym">(</span><span class="src-var">$i</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1838"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>== <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1839"></a>                    <span class="src-var">$factorArray </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><span class="src-var">$factorArray</span><span class="src-sym">,</span><span class="src-var">$subFactors</span><span class="src-sym">,</span><span class="src-var">$subFactors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1840"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1841"></a>                    <span class="src-var">$value </span>/= <span class="src-var">$i</span><span class="src-sym">;</span></li>
<li><a name="a1842"></a>                    <span class="src-var">$factorArray </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><span class="src-var">$factorArray</span><span class="src-sym">,</span><span class="src-var">$subFactors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1843"></a>                <span class="src-sym">}</span></li>
<li><a name="a1844"></a>            <span class="src-sym">}</span></li>
<li><a name="a1845"></a>        <span class="src-sym">}</span></li>
<li><a name="a1846"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$factorArray</span><span class="src-sym">) </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1847"></a>            <span class="src-key">return </span><span class="src-var">$factorArray</span><span class="src-sym">;</span></li>
<li><a name="a1848"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1849"></a>            <span class="src-key">return </span><span class="src-key">array</span><span class="src-sym">(</span>(integer)<span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1850"></a>        <span class="src-sym">}</span></li>
<li><a name="a1851"></a>    <span class="src-sym">}</span></li>
<li><a name="a1852"></a>&nbsp;</li>
<li><a name="a1853"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1854"></a><span class="src-doc">     * LCM</span></li>
<li><a name="a1855"></a><span class="src-doc">     *</span></li>
<li><a name="a1856"></a><span class="src-doc">     * Returns the lowest common multiplier of a series of numbers</span></li>
<li><a name="a1857"></a><span class="src-doc">     *</span></li>
<li><a name="a1858"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">$array </span><span class="src-doc">   Values to calculate the Lowest Common Multiplier</span></li>
<li><a name="a1859"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Lowest Common Multiplier</span></li>
<li><a name="a1860"></a><span class="src-doc">     */</span></li>
<li><a name="a1861"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLCM">LCM</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1862"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1863"></a>&nbsp;</li>
<li><a name="a1864"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1865"></a>        <span class="src-var">$allPoweredFactors </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1866"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1867"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1868"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1869"></a>            <span class="src-sym">}</span></li>
<li><a name="a1870"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$value </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1871"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1872"></a>            <span class="src-sym">}</span></li>
<li><a name="a1873"></a>            <span class="src-var">$myFactors </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">factors</span><span class="src-sym">(</span><a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1874"></a>            <span class="src-var">$myCountedFactors </span>= <a href="http://www.php.net/array_count_values">array_count_values</a><span class="src-sym">(</span><span class="src-var">$myFactors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1875"></a>            <span class="src-var">$myPoweredFactors </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1876"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$myCountedFactors </span><span class="src-key">as </span><span class="src-var">$myCountedFactor </span>=&gt; <span class="src-var">$myCountedPower</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1877"></a>                <span class="src-var">$myPoweredFactors</span><span class="src-sym">[</span><span class="src-var">$myCountedFactor</span><span class="src-sym">] </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$myCountedFactor</span><span class="src-sym">,</span><span class="src-var">$myCountedPower</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1878"></a>            <span class="src-sym">}</span></li>
<li><a name="a1879"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$myPoweredFactors </span><span class="src-key">as </span><span class="src-var">$myPoweredValue </span>=&gt; <span class="src-var">$myPoweredFactor</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1880"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-var">$myPoweredValue</span><span class="src-sym">,</span><span class="src-var">$allPoweredFactors</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1881"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$allPoweredFactors</span><span class="src-sym">[</span><span class="src-var">$myPoweredValue</span><span class="src-sym">] </span>&lt; <span class="src-var">$myPoweredFactor</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1882"></a>                        <span class="src-var">$allPoweredFactors</span><span class="src-sym">[</span><span class="src-var">$myPoweredValue</span><span class="src-sym">] </span>= <span class="src-var">$myPoweredFactor</span><span class="src-sym">;</span></li>
<li><a name="a1883"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1884"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1885"></a>                    <span class="src-var">$allPoweredFactors</span><span class="src-sym">[</span><span class="src-var">$myPoweredValue</span><span class="src-sym">] </span>= <span class="src-var">$myPoweredFactor</span><span class="src-sym">;</span></li>
<li><a name="a1886"></a>                <span class="src-sym">}</span></li>
<li><a name="a1887"></a>            <span class="src-sym">}</span></li>
<li><a name="a1888"></a>        <span class="src-sym">}</span></li>
<li><a name="a1889"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$allPoweredFactors </span><span class="src-key">as </span><span class="src-var">$allPoweredFactor</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1890"></a>            <span class="src-var">$returnValue </span>*= (integer) <span class="src-var">$allPoweredFactor</span><span class="src-sym">;</span></li>
<li><a name="a1891"></a>        <span class="src-sym">}</span></li>
<li><a name="a1892"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1893"></a>    <span class="src-sym">}</span></li>
<li><a name="a1894"></a>&nbsp;</li>
<li><a name="a1895"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1896"></a><span class="src-doc">     * GCD</span></li>
<li><a name="a1897"></a><span class="src-doc">     *</span></li>
<li><a name="a1898"></a><span class="src-doc">     * Returns the greatest common divisor of a series of numbers</span></li>
<li><a name="a1899"></a><span class="src-doc">     *</span></li>
<li><a name="a1900"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">$array </span><span class="src-doc">   Values to calculate the Greatest Common Divisor</span></li>
<li><a name="a1901"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Greatest Common Divisor</span></li>
<li><a name="a1902"></a><span class="src-doc">     */</span></li>
<li><a name="a1903"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodGCD">GCD</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1904"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1905"></a>&nbsp;</li>
<li><a name="a1906"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1907"></a>        <span class="src-var">$allPoweredFactors </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1908"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1909"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$value </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1910"></a>                <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1911"></a>            <span class="src-sym">}</span></li>
<li><a name="a1912"></a>            <span class="src-var">$myFactors </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">factors</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1913"></a>            <span class="src-var">$myCountedFactors </span>= <a href="http://www.php.net/array_count_values">array_count_values</a><span class="src-sym">(</span><span class="src-var">$myFactors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1914"></a>            <span class="src-var">$allValuesFactors</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$myCountedFactors</span><span class="src-sym">;</span></li>
<li><a name="a1915"></a>        <span class="src-sym">}</span></li>
<li><a name="a1916"></a>        <span class="src-var">$allValuesCount </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$allValuesFactors</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1917"></a>        <span class="src-var">$mergedArray </span>= <span class="src-var">$allValuesFactors</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1918"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">1</span><span class="src-sym">;</span><span class="src-var">$i </span>&lt; <span class="src-var">$allValuesCount</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1919"></a>            <span class="src-var">$mergedArray </span>= <a href="http://www.php.net/array_intersect_key">array_intersect_key</a><span class="src-sym">(</span><span class="src-var">$mergedArray</span><span class="src-sym">,</span><span class="src-var">$allValuesFactors</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1920"></a>        <span class="src-sym">}</span></li>
<li><a name="a1921"></a>        <span class="src-var">$mergedArrayValues </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$mergedArray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1922"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mergedArrayValues </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1923"></a>            <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1924"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$mergedArrayValues </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1925"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$mergedArray </span><span class="src-key">as </span><span class="src-var">$mergedKey </span>=&gt; <span class="src-var">$mergedValue</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1926"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$allValuesFactors </span><span class="src-key">as </span><span class="src-var">$highestPowerTest</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1927"></a>                    <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$highestPowerTest </span><span class="src-key">as </span><span class="src-var">$testKey </span>=&gt; <span class="src-var">$testValue</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1928"></a>                        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$testKey </span>== <span class="src-var">$mergedKey</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$testValue </span>&lt; <span class="src-var">$mergedValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1929"></a>                            <span class="src-var">$mergedArray</span><span class="src-sym">[</span><span class="src-var">$mergedKey</span><span class="src-sym">] </span>= <span class="src-var">$testValue</span><span class="src-sym">;</span></li>
<li><a name="a1930"></a>                            <span class="src-var">$mergedValue </span>= <span class="src-var">$testValue</span><span class="src-sym">;</span></li>
<li><a name="a1931"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1932"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1933"></a>                <span class="src-sym">}</span></li>
<li><a name="a1934"></a>            <span class="src-sym">}</span></li>
<li><a name="a1935"></a>&nbsp;</li>
<li><a name="a1936"></a>            <span class="src-var">$returnValue </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1937"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$mergedArray </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1938"></a>                <span class="src-var">$returnValue </span>*= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1939"></a>            <span class="src-sym">}</span></li>
<li><a name="a1940"></a>            <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a1941"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1942"></a>            <span class="src-var">$keys </span>= <a href="http://www.php.net/array_keys">array_keys</a><span class="src-sym">(</span><span class="src-var">$mergedArray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1943"></a>            <span class="src-var">$key </span>= <span class="src-var">$keys</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1944"></a>            <span class="src-var">$value </span>= <span class="src-var">$mergedArray</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1945"></a>            <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$allValuesFactors </span><span class="src-key">as </span><span class="src-var">$testValue</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1946"></a>                <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$testValue </span><span class="src-key">as </span><span class="src-var">$mergedKey </span>=&gt; <span class="src-var">$mergedValue</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1947"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mergedKey </span>== <span class="src-var">$key</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$mergedValue </span>&lt; <span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1948"></a>                        <span class="src-var">$value </span>= <span class="src-var">$mergedValue</span><span class="src-sym">;</span></li>
<li><a name="a1949"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1950"></a>                <span class="src-sym">}</span></li>
<li><a name="a1951"></a>            <span class="src-sym">}</span></li>
<li><a name="a1952"></a>            <span class="src-key">return </span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1953"></a>        <span class="src-sym">}</span></li>
<li><a name="a1954"></a>    <span class="src-sym">}</span></li>
<li><a name="a1955"></a>&nbsp;</li>
<li><a name="a1956"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1957"></a><span class="src-doc">     * BINOMDIST</span></li>
<li><a name="a1958"></a><span class="src-doc">     *</span></li>
<li><a name="a1959"></a><span class="src-doc">     * Returns the individual term binomial distribution probability. Use BINOMDIST in problems with</span></li>
<li><a name="a1960"></a><span class="src-doc">     * a fixed number of tests or trials, when the outcomes of any trial are only success or failure,</span></li>
<li><a name="a1961"></a><span class="src-doc">     * when trials are independent, and when the probability of success is constant throughout the</span></li>
<li><a name="a1962"></a><span class="src-doc">     * experiment. For example, BINOMDIST can calculate the probability that two of the next three</span></li>
<li><a name="a1963"></a><span class="src-doc">     * babies born are male.</span></li>
<li><a name="a1964"></a><span class="src-doc">     *</span></li>
<li><a name="a1965"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">           Number of successes in trials</span></li>
<li><a name="a1966"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$trials </span><span class="src-doc">           Number of trials</span></li>
<li><a name="a1967"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   Probability of success on each trial</span></li>
<li><a name="a1968"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a1969"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a1970"></a><span class="src-doc">     *</span></li>
<li><a name="a1971"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@todo</span><span class="src-doc">    Cumulative distribution function</span></li>
<li><a name="a1972"></a><span class="src-doc">     *</span></li>
<li><a name="a1973"></a><span class="src-doc">     */</span></li>
<li><a name="a1974"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBINOMDIST">BINOMDIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$trials</span><span class="src-sym">, </span><span class="src-var">$probability</span><span class="src-sym">, </span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1975"></a>        <span class="src-var">$value            </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1976"></a>        <span class="src-var">$trials            </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1977"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1978"></a>&nbsp;</li>
<li><a name="a1979"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1980"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$value </span>&gt; <span class="src-var">$trials</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1981"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1982"></a>            <span class="src-sym">}</span></li>
<li><a name="a1983"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$probability </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a1984"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1985"></a>            <span class="src-sym">}</span></li>
<li><a name="a1986"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a1987"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1988"></a>                    <span class="src-var">$summer </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1989"></a>                    <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt;= <span class="src-var">$value</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a1990"></a>                        <span class="src-var">$summer </span>+= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">,</span><span class="src-var">$i</span><span class="src-sym">) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$i</span><span class="src-sym">) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$trials </span>- <span class="src-var">$i</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1991"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1992"></a>                    <span class="src-key">return </span><span class="src-var">$summer</span><span class="src-sym">;</span></li>
<li><a name="a1993"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a1994"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$trials </span>- <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">;</span></li>
<li><a name="a1995"></a>                <span class="src-sym">}</span></li>
<li><a name="a1996"></a>            <span class="src-sym">}</span></li>
<li><a name="a1997"></a>        <span class="src-sym">}</span></li>
<li><a name="a1998"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1999"></a>    <span class="src-sym">}</span></li>
<li><a name="a2000"></a>&nbsp;</li>
<li><a name="a2001"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2002"></a><span class="src-doc">     * NEGBINOMDIST</span></li>
<li><a name="a2003"></a><span class="src-doc">     *</span></li>
<li><a name="a2004"></a><span class="src-doc">     * Returns the negative binomial distribution. NEGBINOMDIST returns the probability that</span></li>
<li><a name="a2005"></a><span class="src-doc">     * there will be number_f failures before the number_s-th success, when the constant</span></li>
<li><a name="a2006"></a><span class="src-doc">     * probability of a success is probability_s. This function is similar to the binomial</span></li>
<li><a name="a2007"></a><span class="src-doc">     * distribution, except that the number of successes is fixed, and the number of trials is</span></li>
<li><a name="a2008"></a><span class="src-doc">     * variable. Like the binomial, trials are assumed to be independent.</span></li>
<li><a name="a2009"></a><span class="src-doc">     *</span></li>
<li><a name="a2010"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$failures </span><span class="src-doc">       Number of Failures</span></li>
<li><a name="a2011"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$successes </span><span class="src-doc">       Threshold number of Successes</span></li>
<li><a name="a2012"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   Probability of success on each trial</span></li>
<li><a name="a2013"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2014"></a><span class="src-doc">     *</span></li>
<li><a name="a2015"></a><span class="src-doc">     */</span></li>
<li><a name="a2016"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodNEGBINOMDIST">NEGBINOMDIST</a><span class="src-sym">(</span><span class="src-var">$failures</span><span class="src-sym">, </span><span class="src-var">$successes</span><span class="src-sym">, </span><span class="src-var">$probability</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2017"></a>        <span class="src-var">$failures        </span>= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$failures</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2018"></a>        <span class="src-var">$successes        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$successes</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2019"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2020"></a>&nbsp;</li>
<li><a name="a2021"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$failures</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$successes</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2022"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$failures </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$successes </span>&lt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2023"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2024"></a>            <span class="src-sym">}</span></li>
<li><a name="a2025"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$probability </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2026"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2027"></a>            <span class="src-sym">}</span></li>
<li><a name="a2028"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2029"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$failures </span>+ <span class="src-var">$successes </span>- <span class="src-num">1</span><span class="src-sym">) </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2030"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2031"></a>                <span class="src-sym">}</span></li>
<li><a name="a2032"></a>            <span class="src-sym">}</span></li>
<li><a name="a2033"></a>            <span class="src-key">return </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$failures </span>+ <span class="src-var">$successes </span>- <span class="src-num">1</span><span class="src-sym">,</span><span class="src-var">$successes </span>- <span class="src-num">1</span><span class="src-sym">)) </span>* <span class="src-sym">(</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$successes</span><span class="src-sym">)) </span>* <span class="src-sym">(</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$failures</span><span class="src-sym">)) </span><span class="src-sym">;</span></li>
<li><a name="a2034"></a>        <span class="src-sym">}</span></li>
<li><a name="a2035"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2036"></a>    <span class="src-sym">}</span></li>
<li><a name="a2037"></a>&nbsp;</li>
<li><a name="a2038"></a>&nbsp;</li>
<li><a name="a2039"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2040"></a><span class="src-doc">     * CRITBINOM</span></li>
<li><a name="a2041"></a><span class="src-doc">     *</span></li>
<li><a name="a2042"></a><span class="src-doc">     * Returns the smallest value for which the cumulative binomial distribution is greater</span></li>
<li><a name="a2043"></a><span class="src-doc">     * than or equal to a criterion value</span></li>
<li><a name="a2044"></a><span class="src-doc">     *</span></li>
<li><a name="a2045"></a><span class="src-doc">     * See http://support.microsoft.com/kb/828117/ for details of the algorithm used</span></li>
<li><a name="a2046"></a><span class="src-doc">     *</span></li>
<li><a name="a2047"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$trials </span><span class="src-doc">           number of Bernoulli trials</span></li>
<li><a name="a2048"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   probability of a success on each trial</span></li>
<li><a name="a2049"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$alpha </span><span class="src-doc">           criterion value</span></li>
<li><a name="a2050"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a2051"></a><span class="src-doc">     *</span></li>
<li><a name="a2052"></a><span class="src-doc">     *    </span><span class="src-doc-coretag">@todo</span><span class="src-doc">    Warning. This implementation differs from the algorithm detailed on the MS</span></li>
<li><a name="a2053"></a><span class="src-doc">     *             web site in that $CumPGuessMinus1 = $CumPGuess - 1 rather than $CumPGuess - $PGuess</span></li>
<li><a name="a2054"></a><span class="src-doc">     *             This eliminates a potential endless loop error, but may have an adverse affect on the</span></li>
<li><a name="a2055"></a><span class="src-doc">     *             accuracy of the function (although all my tests have so far returned correct results).</span></li>
<li><a name="a2056"></a><span class="src-doc">     *</span></li>
<li><a name="a2057"></a><span class="src-doc">     */</span></li>
<li><a name="a2058"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCRITBINOM">CRITBINOM</a><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">, </span><span class="src-var">$probability</span><span class="src-sym">, </span><span class="src-var">$alpha</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2059"></a>        <span class="src-var">$trials            </span>= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2060"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2061"></a>        <span class="src-var">$alpha            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2062"></a>&nbsp;</li>
<li><a name="a2063"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$trials</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2064"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$trials </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2065"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2066"></a>            <span class="src-sym">}</span></li>
<li><a name="a2067"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$probability </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2068"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2069"></a>            <span class="src-sym">}</span></li>
<li><a name="a2070"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$alpha </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$alpha </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2071"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2072"></a>            <span class="src-sym">}</span></li>
<li><a name="a2073"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$alpha </span>&lt;= <span class="src-num">0.5</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2074"></a>                <span class="src-var">$t </span>= <span class="src-id">sqrt</span><span class="src-sym">(</span><a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">1 </span>/ <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a2075"></a>                <span class="src-var">$trialsApprox </span>= <span class="src-num">0 </span>- <span class="src-sym">(</span><span class="src-var">$t </span>+ <span class="src-sym">(</span><span class="src-num">2.515517 </span>+ <span class="src-num">0.802853 </span>* <span class="src-var">$t </span>+ <span class="src-num">0.010328 </span>* <span class="src-var">$t </span>* <span class="src-var">$t</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-num">1.432788 </span>* <span class="src-var">$t </span>+ <span class="src-num">0.189269 </span>* <span class="src-var">$t </span>* <span class="src-var">$t </span>+ <span class="src-num">0.001308 </span>* <span class="src-var">$t </span>* <span class="src-var">$t </span>* <span class="src-var">$t</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2076"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2077"></a>                <span class="src-var">$t </span>= <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">1 </span>/ <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a2078"></a>                <span class="src-var">$trialsApprox </span>= <span class="src-var">$t </span>- <span class="src-sym">(</span><span class="src-num">2.515517 </span>+ <span class="src-num">0.802853 </span>* <span class="src-var">$t </span>+ <span class="src-num">0.010328 </span>* <span class="src-var">$t </span>* <span class="src-var">$t</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-num">1.432788 </span>* <span class="src-var">$t </span>+ <span class="src-num">0.189269 </span>* <span class="src-var">$t </span>* <span class="src-var">$t </span>+ <span class="src-num">0.001308 </span>* <span class="src-var">$t </span>* <span class="src-var">$t </span>* <span class="src-var">$t</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2079"></a>            <span class="src-sym">}</span></li>
<li><a name="a2080"></a>            <span class="src-var">$Guess </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$trials </span>* <span class="src-var">$probability </span>+ <span class="src-var">$trialsApprox </span>* <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$trials </span>* <span class="src-var">$probability </span>* <span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a2081"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$Guess </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2082"></a>                <span class="src-var">$Guess </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2083"></a>            <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$Guess </span>&gt; <span class="src-var">$trials</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2084"></a>                <span class="src-var">$Guess </span>= <span class="src-var">$trials</span><span class="src-sym">;</span></li>
<li><a name="a2085"></a>            <span class="src-sym">}</span></li>
<li><a name="a2086"></a>&nbsp;</li>
<li><a name="a2087"></a>            <span class="src-var">$TotalUnscaledProbability </span>= <span class="src-var">$UnscaledPGuess </span>= <span class="src-var">$UnscaledCumPGuess </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2088"></a>            <span class="src-var">$EssentiallyZero </span>= <span class="src-num">10e-12</span><span class="src-sym">;</span></li>
<li><a name="a2089"></a>&nbsp;</li>
<li><a name="a2090"></a>            <span class="src-var">$m </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$trials </span>* <span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2091"></a>            ++<span class="src-var">$TotalUnscaledProbability</span><span class="src-sym">;</span></li>
<li><a name="a2092"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$m </span>== <span class="src-var">$Guess</span><span class="src-sym">) </span><span class="src-sym">{ </span>++<span class="src-var">$UnscaledPGuess</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2093"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$m </span>&lt;= <span class="src-var">$Guess</span><span class="src-sym">) </span><span class="src-sym">{ </span>++<span class="src-var">$UnscaledCumPGuess</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2094"></a>&nbsp;</li>
<li><a name="a2095"></a>            <span class="src-var">$PreviousValue </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2096"></a>            <span class="src-var">$Done </span>= <span class="src-id">False</span><span class="src-sym">;</span></li>
<li><a name="a2097"></a>            <span class="src-var">$k </span>= <span class="src-var">$m </span>+ <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2098"></a>            <span class="src-key">while </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$Done</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$k </span>&lt;= <span class="src-var">$trials</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2099"></a>                <span class="src-var">$CurrentValue </span>= <span class="src-var">$PreviousValue </span>* <span class="src-sym">(</span><span class="src-var">$trials </span>- <span class="src-var">$k </span>+ <span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-var">$probability </span>/ <span class="src-sym">(</span><span class="src-var">$k </span>* <span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2100"></a>                <span class="src-var">$TotalUnscaledProbability </span>+= <span class="src-var">$CurrentValue</span><span class="src-sym">;</span></li>
<li><a name="a2101"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$k </span>== <span class="src-var">$Guess</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$UnscaledPGuess </span>+= <span class="src-var">$CurrentValue</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2102"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$k </span>&lt;= <span class="src-var">$Guess</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$UnscaledCumPGuess </span>+= <span class="src-var">$CurrentValue</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2103"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$CurrentValue </span>&lt;= <span class="src-var">$EssentiallyZero</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$Done </span>= <span class="src-id">True</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2104"></a>                <span class="src-var">$PreviousValue </span>= <span class="src-var">$CurrentValue</span><span class="src-sym">;</span></li>
<li><a name="a2105"></a>                ++<span class="src-var">$k</span><span class="src-sym">;</span></li>
<li><a name="a2106"></a>            <span class="src-sym">}</span></li>
<li><a name="a2107"></a>&nbsp;</li>
<li><a name="a2108"></a>            <span class="src-var">$PreviousValue </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2109"></a>            <span class="src-var">$Done </span>= <span class="src-id">False</span><span class="src-sym">;</span></li>
<li><a name="a2110"></a>            <span class="src-var">$k </span>= <span class="src-var">$m </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2111"></a>            <span class="src-key">while </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$Done</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$k </span>&gt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2112"></a>                <span class="src-var">$CurrentValue </span>= <span class="src-var">$PreviousValue </span>* <span class="src-var">$k </span>+ <span class="src-num">1 </span>* <span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">) </span>/ <span class="src-sym">((</span><span class="src-var">$trials </span>- <span class="src-var">$k</span><span class="src-sym">) </span>* <span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2113"></a>                <span class="src-var">$TotalUnscaledProbability </span>+= <span class="src-var">$CurrentValue</span><span class="src-sym">;</span></li>
<li><a name="a2114"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$k </span>== <span class="src-var">$Guess</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$UnscaledPGuess </span>+= <span class="src-var">$CurrentValue</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2115"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$k </span>&lt;= <span class="src-var">$Guess</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$UnscaledCumPGuess </span>+= <span class="src-var">$CurrentValue</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2116"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">CurrentValue </span>&lt;= <span class="src-id">EssentiallyZero</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$Done </span>= <span class="src-id">True</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a2117"></a>                <span class="src-var">$PreviousValue </span>= <span class="src-var">$CurrentValue</span><span class="src-sym">;</span></li>
<li><a name="a2118"></a>                --<span class="src-var">$k</span><span class="src-sym">;</span></li>
<li><a name="a2119"></a>            <span class="src-sym">}</span></li>
<li><a name="a2120"></a>&nbsp;</li>
<li><a name="a2121"></a>            <span class="src-var">$PGuess </span>= <span class="src-var">$UnscaledPGuess </span>/ <span class="src-var">$TotalUnscaledProbability</span><span class="src-sym">;</span></li>
<li><a name="a2122"></a>            <span class="src-var">$CumPGuess </span>= <span class="src-var">$UnscaledCumPGuess </span>/ <span class="src-var">$TotalUnscaledProbability</span><span class="src-sym">;</span></li>
<li><a name="a2123"></a>&nbsp;</li>
<li><a name="a2124"></a><span class="src-comm">//            $CumPGuessMinus1 = $CumPGuess - $PGuess;</span></li>
<li><a name="a2125"></a>            <span class="src-var">$CumPGuessMinus1 </span>= <span class="src-var">$CumPGuess </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2126"></a>&nbsp;</li>
<li><a name="a2127"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-id">True</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2128"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$CumPGuessMinus1 </span>&lt; <span class="src-var">$alpha</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$CumPGuess </span>&gt;= <span class="src-var">$alpha</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2129"></a>                    <span class="src-key">return </span><span class="src-var">$Guess</span><span class="src-sym">;</span></li>
<li><a name="a2130"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><span class="src-var">$CumPGuessMinus1 </span>&lt; <span class="src-var">$alpha</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$CumPGuess </span>&lt; <span class="src-var">$alpha</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2131"></a>                    <span class="src-var">$PGuessPlus1 </span>= <span class="src-var">$PGuess </span>* <span class="src-sym">(</span><span class="src-var">$trials </span>- <span class="src-var">$Guess</span><span class="src-sym">) </span>* <span class="src-var">$probability </span>/ <span class="src-var">$Guess </span>/ <span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2132"></a>                    <span class="src-var">$CumPGuessMinus1 </span>= <span class="src-var">$CumPGuess</span><span class="src-sym">;</span></li>
<li><a name="a2133"></a>                    <span class="src-var">$CumPGuess </span>= <span class="src-var">$CumPGuess </span>+ <span class="src-var">$PGuessPlus1</span><span class="src-sym">;</span></li>
<li><a name="a2134"></a>                    <span class="src-var">$PGuess </span>= <span class="src-var">$PGuessPlus1</span><span class="src-sym">;</span></li>
<li><a name="a2135"></a>                    ++<span class="src-var">$Guess</span><span class="src-sym">;</span></li>
<li><a name="a2136"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><span class="src-var">$CumPGuessMinus1 </span>&gt;= <span class="src-var">$alpha</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$CumPGuess </span>&gt;= <span class="src-var">$alpha</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2137"></a>                    <span class="src-var">$PGuessMinus1 </span>= <span class="src-var">$PGuess </span>* <span class="src-var">$Guess </span>* <span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$probability</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$trials </span>- <span class="src-var">$Guess </span>+ <span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-var">$probability</span><span class="src-sym">;</span></li>
<li><a name="a2138"></a>                    <span class="src-var">$CumPGuess </span>= <span class="src-var">$CumPGuessMinus1</span><span class="src-sym">;</span></li>
<li><a name="a2139"></a>                    <span class="src-var">$CumPGuessMinus1 </span>= <span class="src-var">$CumPGuessMinus1 </span>- <span class="src-var">$PGuess</span><span class="src-sym">;</span></li>
<li><a name="a2140"></a>                    <span class="src-var">$PGuess </span>= <span class="src-var">$PGuessMinus1</span><span class="src-sym">;</span></li>
<li><a name="a2141"></a>                    --<span class="src-var">$Guess</span><span class="src-sym">;</span></li>
<li><a name="a2142"></a>                <span class="src-sym">}</span></li>
<li><a name="a2143"></a>            <span class="src-sym">}</span></li>
<li><a name="a2144"></a>        <span class="src-sym">}</span></li>
<li><a name="a2145"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2146"></a>    <span class="src-sym">}</span></li>
<li><a name="a2147"></a>&nbsp;</li>
<li><a name="a2148"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2149"></a><span class="src-doc">     * CHIDIST</span></li>
<li><a name="a2150"></a><span class="src-doc">     *</span></li>
<li><a name="a2151"></a><span class="src-doc">     * Returns the one-tailed probability of the chi-squared distribution.</span></li>
<li><a name="a2152"></a><span class="src-doc">     *</span></li>
<li><a name="a2153"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">           Value for the function</span></li>
<li><a name="a2154"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$degrees </span><span class="src-doc">       degrees of freedom</span></li>
<li><a name="a2155"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2156"></a><span class="src-doc">     */</span></li>
<li><a name="a2157"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCHIDIST">CHIDIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$degrees</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2158"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2159"></a>        <span class="src-var">$degrees    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2160"></a>&nbsp;</li>
<li><a name="a2161"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2162"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$degrees </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2163"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2164"></a>            <span class="src-sym">}</span></li>
<li><a name="a2165"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$value </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2166"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2167"></a>                    <span class="src-key">return </span><span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2168"></a>                <span class="src-sym">}</span></li>
<li><a name="a2169"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2170"></a>            <span class="src-sym">}</span></li>
<li><a name="a2171"></a>            <span class="src-key">return </span><span class="src-num">1 </span>- <span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">incompleteGamma</span><span class="src-sym">(</span><span class="src-var">$degrees</span>/<span class="src-num">2</span><span class="src-sym">,</span><span class="src-var">$value</span>/<span class="src-num">2</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">gamma</span><span class="src-sym">(</span><span class="src-var">$degrees</span>/<span class="src-num">2</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2172"></a>        <span class="src-sym">}</span></li>
<li><a name="a2173"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2174"></a>    <span class="src-sym">}</span></li>
<li><a name="a2175"></a>&nbsp;</li>
<li><a name="a2176"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2177"></a><span class="src-doc">     * CHIINV</span></li>
<li><a name="a2178"></a><span class="src-doc">     *</span></li>
<li><a name="a2179"></a><span class="src-doc">     * Returns the one-tailed probability of the chi-squared distribution.</span></li>
<li><a name="a2180"></a><span class="src-doc">     *</span></li>
<li><a name="a2181"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   Probability for the function</span></li>
<li><a name="a2182"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$degrees </span><span class="src-doc">       degrees of freedom</span></li>
<li><a name="a2183"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2184"></a><span class="src-doc">     */</span></li>
<li><a name="a2185"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodCHIINV">CHIINV</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">, </span><span class="src-var">$degrees</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2186"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2187"></a>        <span class="src-var">$degrees        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2188"></a>&nbsp;</li>
<li><a name="a2189"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2190"></a>            <span class="src-var">$xLo </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a2191"></a>            <span class="src-var">$xHi </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2192"></a>            <span class="src-var">$maxIteration </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a2193"></a>&nbsp;</li>
<li><a name="a2194"></a>            <span class="src-var">$x </span>= <span class="src-var">$xNew </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2195"></a>            <span class="src-var">$dx    </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2196"></a>            <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2197"></a>&nbsp;</li>
<li><a name="a2198"></a>            <span class="src-key">while </span><span class="src-sym">((</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$dx</span><span class="src-sym">) </span>&gt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#definePRECISION">PRECISION</a></span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$i</span>++ &lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2199"></a>                <span class="src-comm">// Apply Newton-Raphson step</span></li>
<li><a name="a2200"></a>                <span class="src-var">$result </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">CHIDIST</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$degrees</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2201"></a>                <span class="src-var">$error </span>= <span class="src-var">$result </span>- <span class="src-var">$probability</span><span class="src-sym">;</span></li>
<li><a name="a2202"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$error </span>== <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2203"></a>                    <span class="src-var">$dx </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2204"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$error </span>&lt; <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2205"></a>                    <span class="src-var">$xLo </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2206"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2207"></a>                    <span class="src-var">$xHi </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2208"></a>                <span class="src-sym">}</span></li>
<li><a name="a2209"></a>                <span class="src-comm">// Avoid division by zero</span></li>
<li><a name="a2210"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$result </span>!= <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2211"></a>                    <span class="src-var">$dx </span>= <span class="src-var">$error </span>/ <span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a2212"></a>                    <span class="src-var">$xNew </span>= <span class="src-var">$x </span>- <span class="src-var">$dx</span><span class="src-sym">;</span></li>
<li><a name="a2213"></a>                <span class="src-sym">}</span></li>
<li><a name="a2214"></a>                <span class="src-comm">// If the NR fails to converge (which for example may be the</span></li>
<li><a name="a2215"></a>                <span class="src-comm">// case if the initial guess is too rough) we apply a bisection</span></li>
<li><a name="a2216"></a>                <span class="src-comm">// step to determine a more narrow interval around the root.</span></li>
<li><a name="a2217"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$xNew </span>&lt; <span class="src-var">$xLo</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$xNew </span>&gt; <span class="src-var">$xHi</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$result </span>== <span class="src-num">0.0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2218"></a>                    <span class="src-var">$xNew </span>= <span class="src-sym">(</span><span class="src-var">$xLo </span>+ <span class="src-var">$xHi</span><span class="src-sym">) </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a2219"></a>                    <span class="src-var">$dx </span>= <span class="src-var">$xNew </span>- <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2220"></a>                <span class="src-sym">}</span></li>
<li><a name="a2221"></a>                <span class="src-var">$x </span>= <span class="src-var">$xNew</span><span class="src-sym">;</span></li>
<li><a name="a2222"></a>            <span class="src-sym">}</span></li>
<li><a name="a2223"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>== <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2224"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'na'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2225"></a>            <span class="src-sym">}</span></li>
<li><a name="a2226"></a>            <span class="src-key">return </span><span class="src-id">round</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2227"></a>        <span class="src-sym">}</span></li>
<li><a name="a2228"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2229"></a>    <span class="src-sym">}</span></li>
<li><a name="a2230"></a>&nbsp;</li>
<li><a name="a2231"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2232"></a><span class="src-doc">     * EXPONDIST</span></li>
<li><a name="a2233"></a><span class="src-doc">     *</span></li>
<li><a name="a2234"></a><span class="src-doc">     * Returns the exponential distribution. Use EXPONDIST to model the time between events,</span></li>
<li><a name="a2235"></a><span class="src-doc">     * such as how long an automated bank teller takes to deliver cash. For example, you can</span></li>
<li><a name="a2236"></a><span class="src-doc">     * use EXPONDIST to determine the probability that the process takes at most 1 minute.</span></li>
<li><a name="a2237"></a><span class="src-doc">     *</span></li>
<li><a name="a2238"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">           Value of the function</span></li>
<li><a name="a2239"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$lambda </span><span class="src-doc">           The parameter value</span></li>
<li><a name="a2240"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a2241"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2242"></a><span class="src-doc">     */</span></li>
<li><a name="a2243"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodEXPONDIST">EXPONDIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$lambda</span><span class="src-sym">, </span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2244"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2245"></a>        <span class="src-var">$lambda    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$lambda</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2246"></a>        <span class="src-var">$cumulative    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2247"></a>&nbsp;</li>
<li><a name="a2248"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$lambda</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2249"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$lambda </span>&lt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2250"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2251"></a>            <span class="src-sym">}</span></li>
<li><a name="a2252"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2253"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2254"></a>                    <span class="src-key">return </span><span class="src-num">1 </span>- <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0</span>-<span class="src-var">$value</span>*<span class="src-var">$lambda</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2255"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2256"></a>                    <span class="src-key">return </span><span class="src-var">$lambda </span>* <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0</span>-<span class="src-var">$value</span>*<span class="src-var">$lambda</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2257"></a>                <span class="src-sym">}</span></li>
<li><a name="a2258"></a>            <span class="src-sym">}</span></li>
<li><a name="a2259"></a>        <span class="src-sym">}</span></li>
<li><a name="a2260"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2261"></a>    <span class="src-sym">}</span></li>
<li><a name="a2262"></a>&nbsp;</li>
<li><a name="a2263"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2264"></a><span class="src-doc">     * FISHER</span></li>
<li><a name="a2265"></a><span class="src-doc">     *</span></li>
<li><a name="a2266"></a><span class="src-doc">     * Returns the Fisher transformation at x. This transformation produces a function that</span></li>
<li><a name="a2267"></a><span class="src-doc">     * is normally distributed rather than skewed. Use this function to perform hypothesis</span></li>
<li><a name="a2268"></a><span class="src-doc">     * testing on the correlation coefficient.</span></li>
<li><a name="a2269"></a><span class="src-doc">     *</span></li>
<li><a name="a2270"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a2271"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2272"></a><span class="src-doc">     */</span></li>
<li><a name="a2273"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodFISHER">FISHER</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2274"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2275"></a>&nbsp;</li>
<li><a name="a2276"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2277"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt;= -<span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$lambda </span>&gt;= <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2278"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2279"></a>            <span class="src-sym">}</span></li>
<li><a name="a2280"></a>            <span class="src-key">return </span><span class="src-num">0.5 </span>* <span class="src-id">log</span><span class="src-sym">((</span><span class="src-num">1</span>+<span class="src-var">$value</span><span class="src-sym">)</span>/<span class="src-sym">(</span><span class="src-num">1</span>-<span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2281"></a>        <span class="src-sym">}</span></li>
<li><a name="a2282"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2283"></a>    <span class="src-sym">}</span></li>
<li><a name="a2284"></a>&nbsp;</li>
<li><a name="a2285"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2286"></a><span class="src-doc">     * FISHERINV</span></li>
<li><a name="a2287"></a><span class="src-doc">     *</span></li>
<li><a name="a2288"></a><span class="src-doc">     * Returns the inverse of the Fisher transformation. Use this transformation when</span></li>
<li><a name="a2289"></a><span class="src-doc">     * analyzing correlations between ranges or arrays of data. If y = FISHER(x), then</span></li>
<li><a name="a2290"></a><span class="src-doc">     * FISHERINV(y) = x.</span></li>
<li><a name="a2291"></a><span class="src-doc">     *</span></li>
<li><a name="a2292"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a2293"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2294"></a><span class="src-doc">     */</span></li>
<li><a name="a2295"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodFISHERINV">FISHERINV</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2296"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2297"></a>&nbsp;</li>
<li><a name="a2298"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2299"></a>            <span class="src-key">return </span><span class="src-sym">(</span><a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">2 </span>* <span class="src-var">$value</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">2 </span>* <span class="src-var">$value</span><span class="src-sym">) </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2300"></a>        <span class="src-sym">}</span></li>
<li><a name="a2301"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2302"></a>    <span class="src-sym">}</span></li>
<li><a name="a2303"></a>&nbsp;</li>
<li><a name="a2304"></a>    <span class="src-comm">// Function cache for logBeta</span></li>
<li><a name="a2304"></a>    </li>
<li><a name="a2305"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$logBetaCache_p            </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2306"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$logBetaCache_q            </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2307"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$logBetaCache_result    </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2308"></a>&nbsp;</li>
<li><a name="a2309"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2310"></a><span class="src-doc">     * The natural logarithm of the beta function.</span></li>
<li><a name="a2311"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">p </span><span class="src-doc">require p&gt;0</span></li>
<li><a name="a2312"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">q </span><span class="src-doc">require q&gt;0</span></li>
<li><a name="a2313"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">0 </span><span class="src-doc">if p&lt;=0, q&lt;=0 or p+q&gt;2.55E305 to avoid errors and over/underflow</span></li>
<li><a name="a2314"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Jaco van Kooten</span></li>
<li><a name="a2315"></a><span class="src-doc">     */</span></li>
<li><a name="a2316"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodlogBeta">logBeta</a><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2317"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$p </span>!= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_p </span>|| <span class="src-var">$q </span>!= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_q</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2318"></a>            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_p </span>= <span class="src-var">$p</span><span class="src-sym">;</span></li>
<li><a name="a2319"></a>            <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_q </span>= <span class="src-var">$q</span><span class="src-sym">;</span></li>
<li><a name="a2320"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$p </span>&lt;= <span class="src-num">0.0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$q </span>&lt;= <span class="src-num">0.0</span><span class="src-sym">) </span>|| <span class="src-sym">((</span><span class="src-var">$p </span>+ <span class="src-var">$q</span><span class="src-sym">) </span>&gt; <span class="src-id">LOG_GAMMA_X_MAX_VALUE</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2321"></a>                <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_result </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2322"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2323"></a>                <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_result </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">logGamma</span><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">) </span>+ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">logGamma</span><span class="src-sym">(</span><span class="src-var">$q</span><span class="src-sym">) </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">logGamma</span><span class="src-sym">(</span><span class="src-var">$p </span>+ <span class="src-var">$q</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2324"></a>            <span class="src-sym">}</span></li>
<li><a name="a2325"></a>        <span class="src-sym">}</span></li>
<li><a name="a2326"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logBetaCache_result</span><span class="src-sym">;</span></li>
<li><a name="a2327"></a>    <span class="src-sym">}</span></li>
<li><a name="a2328"></a>&nbsp;</li>
<li><a name="a2329"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2330"></a><span class="src-doc">     * Evaluates of continued fraction part of incomplete beta function.</span></li>
<li><a name="a2331"></a><span class="src-doc">     * Based on an idea from Numerical Recipes (W.H. Press et al, 1992).</span></li>
<li><a name="a2332"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Jaco van Kooten</span></li>
<li><a name="a2333"></a><span class="src-doc">     */</span></li>
<li><a name="a2334"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodbetaFraction">betaFraction</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2335"></a>        <span class="src-var">$c </span>= <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2336"></a>        <span class="src-var">$sum_pq  </span>= <span class="src-var">$p </span>+ <span class="src-var">$q</span><span class="src-sym">;</span></li>
<li><a name="a2337"></a>        <span class="src-var">$p_plus  </span>= <span class="src-var">$p </span>+ <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2338"></a>        <span class="src-var">$p_minus </span>= <span class="src-var">$p </span>- <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2339"></a>        <span class="src-var">$h </span>= <span class="src-num">1.0 </span>- <span class="src-var">$sum_pq </span>* <span class="src-var">$x </span>/ <span class="src-var">$p_plus</span><span class="src-sym">;</span></li>
<li><a name="a2340"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">abs</span><span class="src-sym">(</span><span class="src-var">$h</span><span class="src-sym">) </span>&lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2341"></a>            <span class="src-var">$h </span>= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">;</span></li>
<li><a name="a2342"></a>        <span class="src-sym">}</span></li>
<li><a name="a2343"></a>        <span class="src-var">$h </span>= <span class="src-num">1.0 </span>/ <span class="src-var">$h</span><span class="src-sym">;</span></li>
<li><a name="a2344"></a>        <span class="src-var">$frac  </span>= <span class="src-var">$h</span><span class="src-sym">;</span></li>
<li><a name="a2345"></a>        <span class="src-var">$m     </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2346"></a>        <span class="src-var">$delta </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2347"></a>        <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$m </span>&lt;= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a> </span>&amp;&amp; <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$delta</span>-<span class="src-num">1.0</span><span class="src-sym">) </span>&gt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#definePRECISION">PRECISION</a> </span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2348"></a>            <span class="src-var">$m2 </span>= <span class="src-num">2 </span>* <span class="src-var">$m</span><span class="src-sym">;</span></li>
<li><a name="a2349"></a>            <span class="src-comm">// even index for d</span></li>
<li><a name="a2350"></a>            <span class="src-var">$d </span>= <span class="src-var">$m </span>* <span class="src-sym">(</span><span class="src-var">$q </span>- <span class="src-var">$m</span><span class="src-sym">) </span>* <span class="src-var">$x </span>/ <span class="src-sym">( (</span><span class="src-var">$p_minus </span>+ <span class="src-var">$m2</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$p </span>+ <span class="src-var">$m2</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2351"></a>            <span class="src-var">$h </span>= <span class="src-num">1.0 </span>+ <span class="src-var">$d </span>* <span class="src-var">$h</span><span class="src-sym">;</span></li>
<li><a name="a2352"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$h</span><span class="src-sym">) </span>&lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2353"></a>                <span class="src-var">$h </span>= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">;</span></li>
<li><a name="a2354"></a>            <span class="src-sym">}</span></li>
<li><a name="a2355"></a>            <span class="src-var">$h </span>= <span class="src-num">1.0 </span>/ <span class="src-var">$h</span><span class="src-sym">;</span></li>
<li><a name="a2356"></a>            <span class="src-var">$c </span>= <span class="src-num">1.0 </span>+ <span class="src-var">$d </span>/ <span class="src-var">$c</span><span class="src-sym">;</span></li>
<li><a name="a2357"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$c</span><span class="src-sym">) </span>&lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2358"></a>                <span class="src-var">$c </span>= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">;</span></li>
<li><a name="a2359"></a>            <span class="src-sym">}</span></li>
<li><a name="a2360"></a>            <span class="src-var">$frac </span>*= <span class="src-var">$h </span>* <span class="src-var">$c</span><span class="src-sym">;</span></li>
<li><a name="a2361"></a>            <span class="src-comm">// odd index for d</span></li>
<li><a name="a2362"></a>            <span class="src-var">$d </span>= -<span class="src-sym">(</span><span class="src-var">$p </span>+ <span class="src-var">$m</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$sum_pq </span>+ <span class="src-var">$m</span><span class="src-sym">) </span>* <span class="src-var">$x </span>/ <span class="src-sym">((</span><span class="src-var">$p </span>+ <span class="src-var">$m2</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$p_plus </span>+ <span class="src-var">$m2</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2363"></a>            <span class="src-var">$h </span>= <span class="src-num">1.0 </span>+ <span class="src-var">$d </span>* <span class="src-var">$h</span><span class="src-sym">;</span></li>
<li><a name="a2364"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$h</span><span class="src-sym">) </span>&lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2365"></a>                <span class="src-var">$h </span>= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">;</span></li>
<li><a name="a2366"></a>            <span class="src-sym">}</span></li>
<li><a name="a2367"></a>            <span class="src-var">$h </span>= <span class="src-num">1.0 </span>/ <span class="src-var">$h</span><span class="src-sym">;</span></li>
<li><a name="a2368"></a>            <span class="src-var">$c </span>= <span class="src-num">1.0 </span>+ <span class="src-var">$d </span>/ <span class="src-var">$c</span><span class="src-sym">;</span></li>
<li><a name="a2369"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$c</span><span class="src-sym">) </span>&lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2370"></a>                <span class="src-var">$c </span>= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineXMININ">XMININ</a></span><span class="src-sym">;</span></li>
<li><a name="a2371"></a>            <span class="src-sym">}</span></li>
<li><a name="a2372"></a>            <span class="src-var">$delta </span>= <span class="src-var">$h </span>* <span class="src-var">$c</span><span class="src-sym">;</span></li>
<li><a name="a2373"></a>            <span class="src-var">$frac </span>*= <span class="src-var">$delta</span><span class="src-sym">;</span></li>
<li><a name="a2374"></a>            ++<span class="src-var">$m</span><span class="src-sym">;</span></li>
<li><a name="a2375"></a>        <span class="src-sym">}</span></li>
<li><a name="a2376"></a>        <span class="src-key">return </span><span class="src-var">$frac</span><span class="src-sym">;</span></li>
<li><a name="a2377"></a>    <span class="src-sym">}</span></li>
<li><a name="a2378"></a>&nbsp;</li>
<li><a name="a2379"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2380"></a><span class="src-doc">     * logGamma function</span></li>
<li><a name="a2381"></a><span class="src-doc">     *</span></li>
<li><a name="a2382"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@version</span><span class="src-doc"> 1.1</span></li>
<li><a name="a2383"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Jaco van Kooten</span></li>
<li><a name="a2384"></a><span class="src-doc">     *</span></li>
<li><a name="a2385"></a><span class="src-doc">     *  Original author was Jaco van Kooten. Ported to PHP by Paul Meagher.</span></li>
<li><a name="a2386"></a><span class="src-doc">     *</span></li>
<li><a name="a2387"></a><span class="src-doc">     *  The natural logarithm of the gamma function. &lt;br /&gt;</span></li>
<li><a name="a2388"></a><span class="src-doc">     *  Based on public domain NETLIB (Fortran) code by W. J. Cody and L. Stoltz &lt;br /&gt;</span></li>
<li><a name="a2389"></a><span class="src-doc">     *  Applied Mathematics Division &lt;br /&gt;</span></li>
<li><a name="a2390"></a><span class="src-doc">     *  Argonne National Laboratory &lt;br /&gt;</span></li>
<li><a name="a2391"></a><span class="src-doc">     *  Argonne, IL 60439 &lt;br /&gt;</span></li>
<li><a name="a2392"></a><span class="src-doc">     *  &lt;p&gt;</span></li>
<li><a name="a2393"></a><span class="src-doc">     *  References:</span></li>
<li><a name="a2394"></a><span class="src-doc">     *  &lt;ol&gt;</span></li>
<li><a name="a2395"></a><span class="src-doc">     *  &lt;li&gt;W. J. Cody and K. E. Hillstrom, 'Chebyshev Approximations for the Natural</span></li>
<li><a name="a2396"></a><span class="src-doc">     *      Logarithm of the Gamma Function,' Math. Comp. 21, 1967, pp. 198-203.&lt;/li&gt;</span></li>
<li><a name="a2397"></a><span class="src-doc">     *  &lt;li&gt;K. E. Hillstrom, ANL/AMD Program ANLC366S, DGAMMA/DLGAMA, May, 1969.&lt;/li&gt;</span></li>
<li><a name="a2398"></a><span class="src-doc">     *  &lt;li&gt;Hart, Et. Al., Computer Approximations, Wiley and sons, New York, 1968.&lt;/li&gt;</span></li>
<li><a name="a2399"></a><span class="src-doc">     *  &lt;/ol&gt;</span></li>
<li><a name="a2400"></a><span class="src-doc">     *  &lt;/p&gt;</span></li>
<li><a name="a2401"></a><span class="src-doc">     *  &lt;p&gt;</span></li>
<li><a name="a2402"></a><span class="src-doc">     *  From the original documentation:</span></li>
<li><a name="a2403"></a><span class="src-doc">     *  &lt;/p&gt;</span></li>
<li><a name="a2404"></a><span class="src-doc">     *  &lt;p&gt;</span></li>
<li><a name="a2405"></a><span class="src-doc">     *  This routine calculates the LOG(GAMMA) function for a positive real argument X.</span></li>
<li><a name="a2406"></a><span class="src-doc">     *  Computation is based on an algorithm outlined in references 1 and 2.</span></li>
<li><a name="a2407"></a><span class="src-doc">     *  The program uses rational functions that theoretically approximate LOG(GAMMA)</span></li>
<li><a name="a2408"></a><span class="src-doc">     *  to at least 18 significant decimal digits.  The approximation for X &gt; 12 is from</span></li>
<li><a name="a2409"></a><span class="src-doc">     *  reference 3, while approximations for X &lt; 12.0 are similar to those in reference</span></li>
<li><a name="a2410"></a><span class="src-doc">     *  1, but are unpublished. The accuracy achieved depends on the arithmetic system,</span></li>
<li><a name="a2411"></a><span class="src-doc">     *  the compiler, the intrinsic functions, and proper selection of the</span></li>
<li><a name="a2412"></a><span class="src-doc">     *  machine-dependent constants.</span></li>
<li><a name="a2413"></a><span class="src-doc">     *  &lt;/p&gt;</span></li>
<li><a name="a2414"></a><span class="src-doc">     *  &lt;p&gt;</span></li>
<li><a name="a2415"></a><span class="src-doc">     *  Error returns: &lt;br /&gt;</span></li>
<li><a name="a2416"></a><span class="src-doc">     *  The program returns the value XINF for X .LE. 0.0 or when overflow would occur.</span></li>
<li><a name="a2417"></a><span class="src-doc">     *  The computation is believed to be free of underflow and overflow.</span></li>
<li><a name="a2418"></a><span class="src-doc">     *  &lt;/p&gt;</span></li>
<li><a name="a2419"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">MAX_VALUE </span><span class="src-doc">for x &lt; 0.0 or when overflow would occur, i.e. x &gt; 2.55E305</span></li>
<li><a name="a2420"></a><span class="src-doc">     */</span></li>
<li><a name="a2421"></a>&nbsp;</li>
<li><a name="a2422"></a>    <span class="src-comm">// Function cache for logGamma</span></li>
<li><a name="a2422"></a>    </li>
<li><a name="a2423"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$logGammaCache_result    </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2424"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$logGammaCache_x        </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2425"></a>&nbsp;</li>
<li><a name="a2426"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodlogGamma">logGamma</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2427"></a>        <span class="src-comm">// Log Gamma related constants</span></li>
<li><a name="a2428"></a>        <span class="src-key">static </span><span class="src-var">$lg_d1 </span>= -<span class="src-num">0.5772156649015328605195174</span><span class="src-sym">;</span></li>
<li><a name="a2429"></a>        <span class="src-key">static </span><span class="src-var">$lg_d2 </span>= <span class="src-num">0.4227843350984671393993777</span><span class="src-sym">;</span></li>
<li><a name="a2430"></a>        <span class="src-key">static </span><span class="src-var">$lg_d4 </span>= <span class="src-num">1.791759469228055000094023</span><span class="src-sym">;</span></li>
<li><a name="a2431"></a>&nbsp;</li>
<li><a name="a2432"></a>        <span class="src-key">static </span><span class="src-var">$lg_p1 </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">4.945235359296727046734888</span><span class="src-sym">,</span></li>
<li><a name="a2433"></a>                                <span class="src-num">201.8112620856775083915565</span><span class="src-sym">,</span></li>
<li><a name="a2434"></a>                                <span class="src-num">2290.838373831346393026739</span><span class="src-sym">,</span></li>
<li><a name="a2435"></a>                                <span class="src-num">11319.67205903380828685045</span><span class="src-sym">,</span></li>
<li><a name="a2436"></a>                                <span class="src-num">28557.24635671635335736389</span><span class="src-sym">,</span></li>
<li><a name="a2437"></a>                                <span class="src-num">38484.96228443793359990269</span><span class="src-sym">,</span></li>
<li><a name="a2438"></a>                                <span class="src-num">26377.48787624195437963534</span><span class="src-sym">,</span></li>
<li><a name="a2439"></a>                                <span class="src-num">7225.813979700288197698961 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2440"></a>        <span class="src-key">static </span><span class="src-var">$lg_p2 </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">4.974607845568932035012064</span><span class="src-sym">,</span></li>
<li><a name="a2441"></a>                                <span class="src-num">542.4138599891070494101986</span><span class="src-sym">,</span></li>
<li><a name="a2442"></a>                                <span class="src-num">15506.93864978364947665077</span><span class="src-sym">,</span></li>
<li><a name="a2443"></a>                                <span class="src-num">184793.2904445632425417223</span><span class="src-sym">,</span></li>
<li><a name="a2444"></a>                                <span class="src-num">1088204.76946882876749847</span><span class="src-sym">,</span></li>
<li><a name="a2445"></a>                                <span class="src-num">3338152.967987029735917223</span><span class="src-sym">,</span></li>
<li><a name="a2446"></a>                                <span class="src-num">5106661.678927352456275255</span><span class="src-sym">,</span></li>
<li><a name="a2447"></a>                                <span class="src-num">3074109.054850539556250927 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2448"></a>        <span class="src-key">static </span><span class="src-var">$lg_p4 </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">14745.02166059939948905062</span><span class="src-sym">,</span></li>
<li><a name="a2449"></a>                                <span class="src-num">2426813.369486704502836312</span><span class="src-sym">,</span></li>
<li><a name="a2450"></a>                                <span class="src-num">121475557.4045093227939592</span><span class="src-sym">,</span></li>
<li><a name="a2451"></a>                                <span class="src-num">2663432449.630976949898078</span><span class="src-sym">,</span></li>
<li><a name="a2452"></a>                                <span class="src-num">29403789566.34553899906876</span><span class="src-sym">,</span></li>
<li><a name="a2453"></a>                                <span class="src-num">170266573776.5398868392998</span><span class="src-sym">,</span></li>
<li><a name="a2454"></a>                                <span class="src-num">492612579337.743088758812</span><span class="src-sym">,</span></li>
<li><a name="a2455"></a>                                <span class="src-num">560625185622.3951465078242 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2456"></a>&nbsp;</li>
<li><a name="a2457"></a>        <span class="src-key">static </span><span class="src-var">$lg_q1 </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">67.48212550303777196073036</span><span class="src-sym">,</span></li>
<li><a name="a2458"></a>                                <span class="src-num">1113.332393857199323513008</span><span class="src-sym">,</span></li>
<li><a name="a2459"></a>                                <span class="src-num">7738.757056935398733233834</span><span class="src-sym">,</span></li>
<li><a name="a2460"></a>                                <span class="src-num">27639.87074403340708898585</span><span class="src-sym">,</span></li>
<li><a name="a2461"></a>                                <span class="src-num">54993.10206226157329794414</span><span class="src-sym">,</span></li>
<li><a name="a2462"></a>                                <span class="src-num">61611.22180066002127833352</span><span class="src-sym">,</span></li>
<li><a name="a2463"></a>                                <span class="src-num">36351.27591501940507276287</span><span class="src-sym">,</span></li>
<li><a name="a2464"></a>                                <span class="src-num">8785.536302431013170870835 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2465"></a>        <span class="src-key">static </span><span class="src-var">$lg_q2 </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">183.0328399370592604055942</span><span class="src-sym">,</span></li>
<li><a name="a2466"></a>                                <span class="src-num">7765.049321445005871323047</span><span class="src-sym">,</span></li>
<li><a name="a2467"></a>                                <span class="src-num">133190.3827966074194402448</span><span class="src-sym">,</span></li>
<li><a name="a2468"></a>                                <span class="src-num">1136705.821321969608938755</span><span class="src-sym">,</span></li>
<li><a name="a2469"></a>                                <span class="src-num">5267964.117437946917577538</span><span class="src-sym">,</span></li>
<li><a name="a2470"></a>                                <span class="src-num">13467014.54311101692290052</span><span class="src-sym">,</span></li>
<li><a name="a2471"></a>                                <span class="src-num">17827365.30353274213975932</span><span class="src-sym">,</span></li>
<li><a name="a2472"></a>                                <span class="src-num">9533095.591844353613395747 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2473"></a>        <span class="src-key">static </span><span class="src-var">$lg_q4 </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">2690.530175870899333379843</span><span class="src-sym">,</span></li>
<li><a name="a2474"></a>                                <span class="src-num">639388.5654300092398984238</span><span class="src-sym">,</span></li>
<li><a name="a2475"></a>                                <span class="src-num">41355999.30241388052042842</span><span class="src-sym">,</span></li>
<li><a name="a2476"></a>                                <span class="src-num">1120872109.61614794137657</span><span class="src-sym">,</span></li>
<li><a name="a2477"></a>                                <span class="src-num">14886137286.78813811542398</span><span class="src-sym">,</span></li>
<li><a name="a2478"></a>                                <span class="src-num">101680358627.2438228077304</span><span class="src-sym">,</span></li>
<li><a name="a2479"></a>                                <span class="src-num">341747634550.7377132798597</span><span class="src-sym">,</span></li>
<li><a name="a2480"></a>                                <span class="src-num">446315818741.9713286462081 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2481"></a>&nbsp;</li>
<li><a name="a2482"></a>        <span class="src-key">static </span><span class="src-var">$lg_c  </span>= <span class="src-key">array</span><span class="src-sym">(    </span>-<span class="src-num">0.001910444077728</span><span class="src-sym">,</span></li>
<li><a name="a2483"></a>                                <span class="src-num">8.4171387781295e-4</span><span class="src-sym">,</span></li>
<li><a name="a2484"></a>                                -<span class="src-num">5.952379913043012e-4</span><span class="src-sym">,</span></li>
<li><a name="a2485"></a>                                <span class="src-num">7.93650793500350248e-4</span><span class="src-sym">,</span></li>
<li><a name="a2486"></a>                                -<span class="src-num">0.002777777777777681622553</span><span class="src-sym">,</span></li>
<li><a name="a2487"></a>                                <span class="src-num">0.08333333333333333331554247</span><span class="src-sym">,</span></li>
<li><a name="a2488"></a>                                <span class="src-num">0.0057083835261 </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2489"></a>&nbsp;</li>
<li><a name="a2490"></a>    <span class="src-comm">// Rough estimate of the fourth root of logGamma_xBig</span></li>
<li><a name="a2490"></a>    </li>
<li><a name="a2491"></a>    <span class="src-key">static </span><span class="src-var">$lg_frtbig </span>= <span class="src-num">2.25e76</span><span class="src-sym">;</span></li>
<li><a name="a2492"></a>    <span class="src-key">static </span><span class="src-var">$pnt68     </span>= <span class="src-num">0.6796875</span><span class="src-sym">;</span></li>
<li><a name="a2493"></a>&nbsp;</li>
<li><a name="a2494"></a>&nbsp;</li>
<li><a name="a2495"></a>    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logGammaCache_x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2496"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logGammaCache_result</span><span class="src-sym">;</span></li>
<li><a name="a2497"></a>    <span class="src-sym">}</span></li>
<li><a name="a2498"></a>    <span class="src-var">$y </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2499"></a>    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&gt; <span class="src-num">0.0 </span>&amp;&amp; <span class="src-var">$y </span>&lt;= <span class="src-id">LOG_GAMMA_X_MAX_VALUE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2500"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt;= <span class="src-id">EPS</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2501"></a>            <span class="src-var">$res </span>= -<span class="src-id">log</span><span class="src-sym">(</span><span class="src-id">y</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2502"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt;= <span class="src-num">1.5</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2503"></a>            <span class="src-comm">// ---------------------</span></li>
<li><a name="a2504"></a><span class="src-comm">//  EPS .LT. X .LE. 1.5</span></li>
<li><a name="a2505"></a>            <span class="src-comm">// ---------------------</span></li>
<li><a name="a2505"></a>            </li>
<li><a name="a2506"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt; <span class="src-var">$pnt68</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2507"></a>                <span class="src-var">$corr </span>= -<a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$y</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2508"></a>                <span class="src-var">$xm1  </span>= <span class="src-var">$y</span><span class="src-sym">;</span></li>
<li><a name="a2509"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2510"></a>                <span class="src-var">$corr </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2511"></a>                <span class="src-var">$xm1  </span>= <span class="src-var">$y </span>- <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2512"></a>            <span class="src-sym">}</span></li>
<li><a name="a2513"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt;= <span class="src-num">0.5 </span>|| <span class="src-var">$y </span>&gt;= <span class="src-var">$pnt68</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2514"></a>                <span class="src-var">$xden </span>= <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2515"></a>                <span class="src-var">$xnum </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2516"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-num">8</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2517"></a>                    <span class="src-var">$xnum </span>= <span class="src-var">$xnum </span>* <span class="src-var">$xm1 </span>+ <span class="src-var">$lg_p1</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2518"></a>                    <span class="src-var">$xden </span>= <span class="src-var">$xden </span>* <span class="src-var">$xm1 </span>+ <span class="src-var">$lg_q1</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2519"></a>                <span class="src-sym">}</span></li>
<li><a name="a2520"></a>                <span class="src-var">$res </span>= <span class="src-var">$corr </span>+ <span class="src-var">$xm1 </span>* <span class="src-sym">(</span><span class="src-var">$lg_d1 </span>+ <span class="src-var">$xm1 </span>* <span class="src-sym">(</span><span class="src-var">$xnum </span>/ <span class="src-var">$xden</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2521"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2522"></a>                <span class="src-var">$xm2  </span>= <span class="src-var">$y </span>- <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2523"></a>                <span class="src-var">$xden </span>= <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2524"></a>                <span class="src-var">$xnum </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2525"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-num">8</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2526"></a>                    <span class="src-var">$xnum </span>= <span class="src-var">$xnum </span>* <span class="src-var">$xm2 </span>+ <span class="src-var">$lg_p2</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2527"></a>                    <span class="src-var">$xden </span>= <span class="src-var">$xden </span>* <span class="src-var">$xm2 </span>+ <span class="src-var">$lg_q2</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2528"></a>                <span class="src-sym">}</span></li>
<li><a name="a2529"></a>                <span class="src-var">$res </span>= <span class="src-var">$corr </span>+ <span class="src-var">$xm2 </span>* <span class="src-sym">(</span><span class="src-var">$lg_d2 </span>+ <span class="src-var">$xm2 </span>* <span class="src-sym">(</span><span class="src-var">$xnum </span>/ <span class="src-var">$xden</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2530"></a>            <span class="src-sym">}</span></li>
<li><a name="a2531"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt;= <span class="src-num">4.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2532"></a>            <span class="src-comm">// ---------------------</span></li>
<li><a name="a2533"></a><span class="src-comm">//  1.5 .LT. X .LE. 4.0</span></li>
<li><a name="a2534"></a>            <span class="src-comm">// ---------------------</span></li>
<li><a name="a2534"></a>            </li>
<li><a name="a2535"></a>            <span class="src-var">$xm2  </span>= <span class="src-var">$y </span>- <span class="src-num">2.0</span><span class="src-sym">;</span></li>
<li><a name="a2536"></a>            <span class="src-var">$xden </span>= <span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2537"></a>            <span class="src-var">$xnum </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2538"></a>            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-num">8</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2539"></a>                <span class="src-var">$xnum </span>= <span class="src-var">$xnum </span>* <span class="src-var">$xm2 </span>+ <span class="src-var">$lg_p2</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2540"></a>                <span class="src-var">$xden </span>= <span class="src-var">$xden </span>* <span class="src-var">$xm2 </span>+ <span class="src-var">$lg_q2</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2541"></a>            <span class="src-sym">}</span></li>
<li><a name="a2542"></a>            <span class="src-var">$res </span>= <span class="src-var">$xm2 </span>* <span class="src-sym">(</span><span class="src-var">$lg_d2 </span>+ <span class="src-var">$xm2 </span>* <span class="src-sym">(</span><span class="src-var">$xnum </span>/ <span class="src-var">$xden</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2543"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt;= <span class="src-num">12.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2544"></a>            <span class="src-comm">// ----------------------</span></li>
<li><a name="a2545"></a><span class="src-comm">//  4.0 .LT. X .LE. 12.0</span></li>
<li><a name="a2546"></a>            <span class="src-comm">// ----------------------</span></li>
<li><a name="a2546"></a>            </li>
<li><a name="a2547"></a>            <span class="src-var">$xm4  </span>= <span class="src-var">$y </span>- <span class="src-num">4.0</span><span class="src-sym">;</span></li>
<li><a name="a2548"></a>            <span class="src-var">$xden </span>= -<span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2549"></a>            <span class="src-var">$xnum </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2550"></a>            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-num">8</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2551"></a>                <span class="src-var">$xnum </span>= <span class="src-var">$xnum </span>* <span class="src-var">$xm4 </span>+ <span class="src-var">$lg_p4</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2552"></a>                <span class="src-var">$xden </span>= <span class="src-var">$xden </span>* <span class="src-var">$xm4 </span>+ <span class="src-var">$lg_q4</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2553"></a>            <span class="src-sym">}</span></li>
<li><a name="a2554"></a>            <span class="src-var">$res </span>= <span class="src-var">$lg_d4 </span>+ <span class="src-var">$xm4 </span>* <span class="src-sym">(</span><span class="src-var">$xnum </span>/ <span class="src-var">$xden</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2555"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2556"></a>            <span class="src-comm">// ---------------------------------</span></li>
<li><a name="a2557"></a><span class="src-comm">//  Evaluate for argument .GE. 12.0</span></li>
<li><a name="a2558"></a>            <span class="src-comm">// ---------------------------------</span></li>
<li><a name="a2558"></a>            </li>
<li><a name="a2559"></a>            <span class="src-var">$res </span>= <span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2560"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt;= <span class="src-var">$lg_frtbig</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2561"></a>                <span class="src-var">$res </span>= <span class="src-var">$lg_c</span><span class="src-sym">[</span><span class="src-num">6</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2562"></a>                <span class="src-var">$ysq </span>= <span class="src-var">$y </span>* <span class="src-var">$y</span><span class="src-sym">;</span></li>
<li><a name="a2563"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-num">6</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">)</span></li>
<li><a name="a2564"></a>                    <span class="src-var">$res </span>= <span class="src-var">$res </span>/ <span class="src-var">$ysq </span>+ <span class="src-var">$lg_c</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2565"></a>                <span class="src-sym">}</span></li>
<li><a name="a2566"></a>                <span class="src-var">$res  </span>/= <span class="src-var">$y</span><span class="src-sym">;</span></li>
<li><a name="a2567"></a>                <span class="src-var">$corr </span>= <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$y</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2568"></a>                <span class="src-var">$res  </span>= <span class="src-var">$res </span>+ <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineSQRT2PI">SQRT2PI</a></span><span class="src-sym">) </span>- <span class="src-num">0.5 </span>* <span class="src-var">$corr</span><span class="src-sym">;</span></li>
<li><a name="a2569"></a>                <span class="src-var">$res  </span>+= <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-var">$corr </span>- <span class="src-num">1.0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2570"></a>            <span class="src-sym">}</span></li>
<li><a name="a2571"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2572"></a>            <span class="src-comm">// --------------------------</span></li>
<li><a name="a2573"></a><span class="src-comm">//  Return for bad arguments</span></li>
<li><a name="a2574"></a>            <span class="src-comm">// --------------------------</span></li>
<li><a name="a2574"></a>            </li>
<li><a name="a2575"></a>            <span class="src-var">$res </span>= <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_VALUE">MAX_VALUE</a></span><span class="src-sym">;</span></li>
<li><a name="a2576"></a>        <span class="src-sym">}</span></li>
<li><a name="a2577"></a>        <span class="src-comm">// ------------------------------</span></li>
<li><a name="a2578"></a><span class="src-comm">//  Final adjustments and return</span></li>
<li><a name="a2579"></a>        <span class="src-comm">// ------------------------------</span></li>
<li><a name="a2579"></a>        </li>
<li><a name="a2580"></a>        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logGammaCache_x </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2581"></a>        <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$logGammaCache_result </span>= <span class="src-var">$res</span><span class="src-sym">;</span></li>
<li><a name="a2582"></a>        <span class="src-key">return </span><span class="src-var">$res</span><span class="src-sym">;</span></li>
<li><a name="a2583"></a>    <span class="src-sym">}</span></li>
<li><a name="a2584"></a>&nbsp;</li>
<li><a name="a2585"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2586"></a><span class="src-doc">     * Beta function.</span></li>
<li><a name="a2587"></a><span class="src-doc">     *</span></li>
<li><a name="a2588"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Jaco van Kooten</span></li>
<li><a name="a2589"></a><span class="src-doc">     *</span></li>
<li><a name="a2590"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">p </span><span class="src-doc">require p&gt;0</span></li>
<li><a name="a2591"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">q </span><span class="src-doc">require q&gt;0</span></li>
<li><a name="a2592"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">0 </span><span class="src-doc">if p&lt;=0, q&lt;=0 or p+q&gt;2.55E305 to avoid errors and over/underflow</span></li>
<li><a name="a2593"></a><span class="src-doc">     */</span></li>
<li><a name="a2594"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">beta</span><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2595"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$p </span>&lt;= <span class="src-num">0.0 </span>|| <span class="src-var">$q </span>&lt;= <span class="src-num">0.0 </span>|| <span class="src-sym">(</span><span class="src-var">$p </span>+ <span class="src-var">$q</span><span class="src-sym">) </span>&gt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineLOG_GAMMA_X_MAX_VALUE">LOG_GAMMA_X_MAX_VALUE</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2596"></a>            <span class="src-key">return </span><span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2597"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2598"></a>            <span class="src-key">return </span><a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">logBeta</span><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2599"></a>        <span class="src-sym">}</span></li>
<li><a name="a2600"></a>    <span class="src-sym">}</span></li>
<li><a name="a2601"></a>&nbsp;</li>
<li><a name="a2602"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2603"></a><span class="src-doc">     * Incomplete beta function</span></li>
<li><a name="a2604"></a><span class="src-doc">     *</span></li>
<li><a name="a2605"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Jaco van Kooten</span></li>
<li><a name="a2606"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@author</span><span class="src-doc"> Paul Meagher</span></li>
<li><a name="a2607"></a><span class="src-doc">     *</span></li>
<li><a name="a2608"></a><span class="src-doc">     *  The computation is based on formulas from Numerical Recipes, Chapter 6.4 (W.H. Press et al, 1992).</span></li>
<li><a name="a2609"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">x </span><span class="src-doc">require 0&lt;=x&lt;=1</span></li>
<li><a name="a2610"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">p </span><span class="src-doc">require p&gt;0</span></li>
<li><a name="a2611"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">q </span><span class="src-doc">require q&gt;0</span></li>
<li><a name="a2612"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">0 </span><span class="src-doc">if x&lt;0, p&lt;=0, q&lt;=0 or p+q&gt;2.55E305 and 1 if x&gt;1 to avoid errors and over/underflow</span></li>
<li><a name="a2613"></a><span class="src-doc">     */</span></li>
<li><a name="a2614"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodincompleteBeta">incompleteBeta</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2615"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>&lt;= <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2616"></a>            <span class="src-key">return </span><span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2617"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$x </span>&gt;= <span class="src-num">1.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2618"></a>            <span class="src-key">return </span><span class="src-num">1.0</span><span class="src-sym">;</span></li>
<li><a name="a2619"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><span class="src-var">$p </span>&lt;= <span class="src-num">0.0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$q </span>&lt;= <span class="src-num">0.0</span><span class="src-sym">) </span>|| <span class="src-sym">((</span><span class="src-var">$p </span>+ <span class="src-var">$q</span><span class="src-sym">) </span>&gt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineLOG_GAMMA_X_MAX_VALUE">LOG_GAMMA_X_MAX_VALUE</a></span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2620"></a>            <span class="src-key">return </span><span class="src-num">0.0</span><span class="src-sym">;</span></li>
<li><a name="a2621"></a>        <span class="src-sym">}</span></li>
<li><a name="a2622"></a>        <span class="src-var">$beta_gam </span>= <a href="http://www.php.net/exp">exp</a><span class="src-sym">((</span><span class="src-num">0 </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">logBeta</span><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">)) </span>+ <span class="src-var">$p </span>* <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>+ <span class="src-var">$q </span>* <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">1.0 </span>- <span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2623"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>&lt; <span class="src-sym">(</span><span class="src-var">$p </span>+ <span class="src-num">1.0</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$p </span>+ <span class="src-var">$q </span>+ <span class="src-num">2.0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2624"></a>            <span class="src-key">return </span><span class="src-var">$beta_gam </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">betaFraction</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$p</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">) </span>/ <span class="src-var">$p</span><span class="src-sym">;</span></li>
<li><a name="a2625"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2626"></a>            <span class="src-key">return </span><span class="src-num">1.0 </span>- <span class="src-sym">(</span><span class="src-var">$beta_gam </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">betaFraction</span><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$q</span><span class="src-sym">, </span><span class="src-var">$p</span><span class="src-sym">) </span>/ <span class="src-var">$q</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2627"></a>        <span class="src-sym">}</span></li>
<li><a name="a2628"></a>    <span class="src-sym">}</span></li>
<li><a name="a2629"></a>&nbsp;</li>
<li><a name="a2630"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2631"></a><span class="src-doc">     * BETADIST</span></li>
<li><a name="a2632"></a><span class="src-doc">     *</span></li>
<li><a name="a2633"></a><span class="src-doc">     * Returns the beta distribution.</span></li>
<li><a name="a2634"></a><span class="src-doc">     *</span></li>
<li><a name="a2635"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">           Value at which you want to evaluate the distribution</span></li>
<li><a name="a2636"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$alpha </span><span class="src-doc">           Parameter to the distribution</span></li>
<li><a name="a2637"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$beta </span><span class="src-doc">           Parameter to the distribution</span></li>
<li><a name="a2638"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a2639"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2640"></a><span class="src-doc">     *</span></li>
<li><a name="a2641"></a><span class="src-doc">     */</span></li>
<li><a name="a2642"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBETADIST">BETADIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-var">$beta</span><span class="src-sym">,</span><span class="src-var">$rMin</span>=<span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$rMax</span>=<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2643"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2644"></a>        <span class="src-var">$alpha    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2645"></a>        <span class="src-var">$beta    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2646"></a>        <span class="src-var">$rMin    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rMin</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2647"></a>        <span class="src-var">$rMax    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rMax</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2648"></a>&nbsp;</li>
<li><a name="a2649"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$rMin</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$rMax</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2650"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt; <span class="src-var">$rMin</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$value </span>&gt; <span class="src-var">$rMax</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$alpha </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$beta </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$rMin </span>== <span class="src-var">$rMax</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2651"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2652"></a>            <span class="src-sym">}</span></li>
<li><a name="a2653"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rMin </span>&gt; <span class="src-var">$rMax</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2654"></a>                <span class="src-var">$tmp </span>= <span class="src-var">$rMin</span><span class="src-sym">;</span></li>
<li><a name="a2655"></a>                <span class="src-var">$rMin </span>= <span class="src-var">$rMax</span><span class="src-sym">;</span></li>
<li><a name="a2656"></a>                <span class="src-var">$rMax </span>= <span class="src-var">$tmp</span><span class="src-sym">;</span></li>
<li><a name="a2657"></a>            <span class="src-sym">}</span></li>
<li><a name="a2658"></a>            <span class="src-var">$value </span>-= <span class="src-var">$rMin</span><span class="src-sym">;</span></li>
<li><a name="a2659"></a>            <span class="src-var">$value </span>/= <span class="src-sym">(</span><span class="src-var">$rMax </span>- <span class="src-var">$rMin</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2660"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">incompleteBeta</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-var">$beta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2661"></a>        <span class="src-sym">}</span></li>
<li><a name="a2662"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2663"></a>    <span class="src-sym">}</span></li>
<li><a name="a2664"></a>&nbsp;</li>
<li><a name="a2665"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2666"></a><span class="src-doc">     * BETAINV</span></li>
<li><a name="a2667"></a><span class="src-doc">     *</span></li>
<li><a name="a2668"></a><span class="src-doc">     * Returns the inverse of the beta distribution.</span></li>
<li><a name="a2669"></a><span class="src-doc">     *</span></li>
<li><a name="a2670"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   Probability at which you want to evaluate the distribution</span></li>
<li><a name="a2671"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$alpha </span><span class="src-doc">           Parameter to the distribution</span></li>
<li><a name="a2672"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$beta </span><span class="src-doc">           Parameter to the distribution</span></li>
<li><a name="a2673"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a2674"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2675"></a><span class="src-doc">     *</span></li>
<li><a name="a2676"></a><span class="src-doc">     */</span></li>
<li><a name="a2677"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">BETAINV</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-var">$beta</span><span class="src-sym">,</span><span class="src-var">$rMin</span>=<span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$rMax</span>=<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2678"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2679"></a>        <span class="src-var">$alpha            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2680"></a>        <span class="src-var">$beta            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2681"></a>        <span class="src-var">$rMin            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rMin</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2682"></a>        <span class="src-var">$rMax            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rMax</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2683"></a>&nbsp;</li>
<li><a name="a2684"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$rMin</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$rMax</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2685"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$alpha </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$beta </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$rMin </span>== <span class="src-var">$rMax</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2686"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2687"></a>            <span class="src-sym">}</span></li>
<li><a name="a2688"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rMin </span>&gt; <span class="src-var">$rMax</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2689"></a>                <span class="src-var">$tmp </span>= <span class="src-var">$rMin</span><span class="src-sym">;</span></li>
<li><a name="a2690"></a>                <span class="src-var">$rMin </span>= <span class="src-var">$rMax</span><span class="src-sym">;</span></li>
<li><a name="a2691"></a>                <span class="src-var">$rMax </span>= <span class="src-var">$tmp</span><span class="src-sym">;</span></li>
<li><a name="a2692"></a>            <span class="src-sym">}</span></li>
<li><a name="a2693"></a>            <span class="src-var">$a </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2694"></a>            <span class="src-var">$b </span>= <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a2695"></a>            <span class="src-var">$maxIteration </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a2696"></a>&nbsp;</li>
<li><a name="a2697"></a>            <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2698"></a>            <span class="src-key">while </span><span class="src-sym">(((</span><span class="src-var">$b </span>- <span class="src-var">$a</span><span class="src-sym">) </span>&gt; <span class="src-id">PRECISION</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$i</span>++ &lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2699"></a>                <span class="src-var">$guess </span>= <span class="src-sym">(</span><span class="src-var">$a </span>+ <span class="src-var">$b</span><span class="src-sym">) </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a2700"></a>                <span class="src-var">$result </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">BETADIST</span><span class="src-sym">(</span><span class="src-var">$guess</span><span class="src-sym">, </span><span class="src-var">$alpha</span><span class="src-sym">, </span><span class="src-var">$beta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2701"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$result </span>== <span class="src-var">$probability</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$result </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2702"></a>                    <span class="src-var">$b </span>= <span class="src-var">$a</span><span class="src-sym">;</span></li>
<li><a name="a2703"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$result </span>&gt; <span class="src-var">$probability</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2704"></a>                    <span class="src-var">$b </span>= <span class="src-var">$guess</span><span class="src-sym">;</span></li>
<li><a name="a2705"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2706"></a>                    <span class="src-var">$a </span>= <span class="src-var">$guess</span><span class="src-sym">;</span></li>
<li><a name="a2707"></a>                <span class="src-sym">}</span></li>
<li><a name="a2708"></a>            <span class="src-sym">}</span></li>
<li><a name="a2709"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>== <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2710"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'na'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2711"></a>            <span class="src-sym">}</span></li>
<li><a name="a2712"></a>            <span class="src-key">return </span><span class="src-id">round</span><span class="src-sym">(</span><span class="src-var">$rMin </span>+ <span class="src-var">$guess </span>* <span class="src-sym">(</span><span class="src-var">$rMax </span>- <span class="src-var">$rMin</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2713"></a>        <span class="src-sym">}</span></li>
<li><a name="a2714"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2715"></a>    <span class="src-sym">}</span></li>
<li><a name="a2716"></a>&nbsp;</li>
<li><a name="a2717"></a>    <span class="src-comm">//</span></li>
<li><a name="a2718"></a><span class="src-comm">//    Private implementation of the incomplete Gamma function</span></li>
<li><a name="a2719"></a>    <span class="src-comm">//</span></li>
<li><a name="a2719"></a>    </li>
<li><a name="a2720"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">incompleteGamma</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2721"></a>        <span class="src-key">static </span><span class="src-var">$max </span>= <span class="src-num">32</span><span class="src-sym">;</span></li>
<li><a name="a2722"></a>        <span class="src-var">$summer </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2723"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$n</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$n</span>&lt;=<span class="src-var">$max</span><span class="src-sym">; </span>++<span class="src-var">$n</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2724"></a>            <span class="src-var">$divisor </span>= <span class="src-var">$a</span><span class="src-sym">;</span></li>
<li><a name="a2725"></a>            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">1</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;=<span class="src-var">$n</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2726"></a>                <span class="src-var">$divisor </span>*= <span class="src-sym">(</span><span class="src-var">$a </span>+ <span class="src-var">$i</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2727"></a>            <span class="src-sym">}</span></li>
<li><a name="a2728"></a>            <span class="src-var">$summer </span>+= <span class="src-sym">(</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$n</span><span class="src-sym">) </span>/ <span class="src-var">$divisor</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2729"></a>        <span class="src-sym">}</span></li>
<li><a name="a2730"></a>        <span class="src-key">return </span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$a</span><span class="src-sym">) </span>* <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0</span>-<span class="src-var">$x</span><span class="src-sym">) </span>* <span class="src-var">$summer</span><span class="src-sym">;</span></li>
<li><a name="a2731"></a>    <span class="src-sym">}</span></li>
<li><a name="a2732"></a>&nbsp;</li>
<li><a name="a2733"></a>&nbsp;</li>
<li><a name="a2734"></a>    <span class="src-comm">//</span></li>
<li><a name="a2735"></a><span class="src-comm">//    Private implementation of the Gamma function</span></li>
<li><a name="a2736"></a>    <span class="src-comm">//</span></li>
<li><a name="a2736"></a>    </li>
<li><a name="a2737"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodgamma">gamma</a><span class="src-sym">(</span><span class="src-var">$data</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2738"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$data </span>== <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2739"></a>&nbsp;</li>
<li><a name="a2740"></a>        <span class="src-key">static </span><span class="src-var">$p0 </span>= <span class="src-num">1.000000000190015</span><span class="src-sym">;</span></li>
<li><a name="a2741"></a>        <span class="src-key">static </span><span class="src-var">$p </span>= <span class="src-key">array </span><span class="src-sym">( </span><span class="src-num">1 </span>=&gt; <span class="src-num">76.18009172947146</span><span class="src-sym">,</span></li>
<li><a name="a2742"></a>                            <span class="src-num">2 </span>=&gt; -<span class="src-num">86.50532032941677</span><span class="src-sym">,</span></li>
<li><a name="a2743"></a>                            <span class="src-num">3 </span>=&gt; <span class="src-num">24.01409824083091</span><span class="src-sym">,</span></li>
<li><a name="a2744"></a>                            <span class="src-num">4 </span>=&gt; -<span class="src-num">1.231739572450155</span><span class="src-sym">,</span></li>
<li><a name="a2745"></a>                            <span class="src-num">5 </span>=&gt; <span class="src-num">1.208650973866179e-3</span><span class="src-sym">,</span></li>
<li><a name="a2746"></a>                            <span class="src-num">6 </span>=&gt; -<span class="src-num">5.395239384953e-6</span></li>
<li><a name="a2747"></a>                          <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2748"></a>&nbsp;</li>
<li><a name="a2749"></a>        <span class="src-var">$y </span>= <span class="src-var">$x </span>= <span class="src-var">$data</span><span class="src-sym">;</span></li>
<li><a name="a2750"></a>        <span class="src-var">$tmp </span>= <span class="src-var">$x </span>+ <span class="src-num">5.5</span><span class="src-sym">;</span></li>
<li><a name="a2751"></a>        <span class="src-var">$tmp </span>-= <span class="src-sym">(</span><span class="src-var">$x </span>+ <span class="src-num">0.5</span><span class="src-sym">) </span>* <span class="src-id">log</span><span class="src-sym">(</span><span class="src-var">$tmp</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2752"></a>&nbsp;</li>
<li><a name="a2753"></a>        <span class="src-var">$summer </span>= <span class="src-var">$p0</span><span class="src-sym">;</span></li>
<li><a name="a2754"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$j</span>=<span class="src-num">1</span><span class="src-sym">;</span><span class="src-var">$j</span>&lt;=<span class="src-num">6</span><span class="src-sym">;</span>++<span class="src-var">$j</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2755"></a>            <span class="src-var">$summer </span>+= <span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">[</span><span class="src-var">$j</span><span class="src-sym">] </span>/ ++<span class="src-var">$y</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2756"></a>        <span class="src-sym">}</span></li>
<li><a name="a2757"></a>        <span class="src-key">return </span><a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0 </span>- <span class="src-var">$tmp </span>+ <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">2.5066282746310005 </span>* <span class="src-var">$summer </span>/ <span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2758"></a>    <span class="src-sym">}</span></li>
<li><a name="a2759"></a>&nbsp;</li>
<li><a name="a2760"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2761"></a><span class="src-doc">     * GAMMADIST</span></li>
<li><a name="a2762"></a><span class="src-doc">     *</span></li>
<li><a name="a2763"></a><span class="src-doc">     * Returns the gamma distribution.</span></li>
<li><a name="a2764"></a><span class="src-doc">     *</span></li>
<li><a name="a2765"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">           Value at which you want to evaluate the distribution</span></li>
<li><a name="a2766"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$a </span><span class="src-doc">               Parameter to the distribution</span></li>
<li><a name="a2767"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$b </span><span class="src-doc">               Parameter to the distribution</span></li>
<li><a name="a2768"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a2769"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2770"></a><span class="src-doc">     *</span></li>
<li><a name="a2771"></a><span class="src-doc">     */</span></li>
<li><a name="a2772"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodGAMMADIST">GAMMADIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$a</span><span class="src-sym">,</span><span class="src-var">$b</span><span class="src-sym">,</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2773"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2774"></a>        <span class="src-var">$a        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2775"></a>        <span class="src-var">$b        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2776"></a>&nbsp;</li>
<li><a name="a2777"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2778"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$a </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$b </span>&lt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2779"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2780"></a>            <span class="src-sym">}</span></li>
<li><a name="a2781"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2782"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2783"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">incompleteGamma</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">,</span><span class="src-var">$value </span>/ <span class="src-var">$b</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">gamma</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2784"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2785"></a>                    <span class="src-key">return </span><span class="src-sym">(</span><span class="src-num">1 </span>/ <span class="src-sym">(</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">,</span><span class="src-var">$a</span><span class="src-sym">) </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">gamma</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">))) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$a</span>-<span class="src-num">1</span><span class="src-sym">) </span>* <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0</span>-<span class="src-sym">(</span><span class="src-var">$value </span>/ <span class="src-var">$b</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2786"></a>                <span class="src-sym">}</span></li>
<li><a name="a2787"></a>            <span class="src-sym">}</span></li>
<li><a name="a2788"></a>        <span class="src-sym">}</span></li>
<li><a name="a2789"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2790"></a>    <span class="src-sym">}</span></li>
<li><a name="a2791"></a>&nbsp;</li>
<li><a name="a2792"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2793"></a><span class="src-doc">     * GAMMAINV</span></li>
<li><a name="a2794"></a><span class="src-doc">     *</span></li>
<li><a name="a2795"></a><span class="src-doc">     * Returns the inverse of the beta distribution.</span></li>
<li><a name="a2796"></a><span class="src-doc">     *</span></li>
<li><a name="a2797"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   Probability at which you want to evaluate the distribution</span></li>
<li><a name="a2798"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$alpha </span><span class="src-doc">           Parameter to the distribution</span></li>
<li><a name="a2799"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$beta </span><span class="src-doc">           Parameter to the distribution</span></li>
<li><a name="a2800"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a2801"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2802"></a><span class="src-doc">     *</span></li>
<li><a name="a2803"></a><span class="src-doc">     */</span></li>
<li><a name="a2804"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">GAMMAINV</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-var">$beta</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2805"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2806"></a>        <span class="src-var">$alpha            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2807"></a>        <span class="src-var">$beta            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2808"></a>        <span class="src-var">$rMin            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rMin</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2809"></a>        <span class="src-var">$rMax            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rMax</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2810"></a>&nbsp;</li>
<li><a name="a2811"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2812"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$alpha </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$beta </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2813"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2814"></a>            <span class="src-sym">}</span></li>
<li><a name="a2815"></a>            <span class="src-var">$xLo </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2816"></a>            <span class="src-var">$xHi </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a2817"></a>            <span class="src-var">$maxIteration </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a2818"></a>&nbsp;</li>
<li><a name="a2819"></a>            <span class="src-var">$x </span>= <span class="src-var">$xNew </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2820"></a>            <span class="src-var">$dx    </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2821"></a>            <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2822"></a>&nbsp;</li>
<li><a name="a2823"></a>            <span class="src-key">while </span><span class="src-sym">((</span><span class="src-id">abs</span><span class="src-sym">(</span><span class="src-var">$dx</span><span class="src-sym">) </span>&gt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#definePRECISION">PRECISION</a></span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$i</span>++ &lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2824"></a>                <span class="src-comm">// Apply Newton-Raphson step</span></li>
<li><a name="a2825"></a>                <span class="src-var">$result </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">GAMMADIST</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$alpha</span><span class="src-sym">, </span><span class="src-var">$beta</span><span class="src-sym">, </span><span class="src-id">True</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2826"></a>                <span class="src-var">$error </span>= <span class="src-var">$result </span>- <span class="src-var">$probability</span><span class="src-sym">;</span></li>
<li><a name="a2827"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$error </span>== <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2828"></a>                    <span class="src-var">$dx </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2829"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$error </span>&lt; <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2830"></a>                    <span class="src-var">$xLo </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2831"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2832"></a>                    <span class="src-var">$xHi </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2833"></a>                <span class="src-sym">}</span></li>
<li><a name="a2834"></a>                <span class="src-comm">// Avoid division by zero</span></li>
<li><a name="a2835"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$result </span>!= <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2836"></a>                    <span class="src-var">$dx </span>= <span class="src-var">$error </span>/ <span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a2837"></a>                    <span class="src-var">$xNew </span>= <span class="src-var">$x </span>- <span class="src-var">$dx</span><span class="src-sym">;</span></li>
<li><a name="a2838"></a>                <span class="src-sym">}</span></li>
<li><a name="a2839"></a>                <span class="src-comm">// If the NR fails to converge (which for example may be the</span></li>
<li><a name="a2840"></a>                <span class="src-comm">// case if the initial guess is too rough) we apply a bisection</span></li>
<li><a name="a2841"></a>                <span class="src-comm">// step to determine a more narrow interval around the root.</span></li>
<li><a name="a2842"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$xNew </span>&lt; <span class="src-var">$xLo</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$xNew </span>&gt; <span class="src-var">$xHi</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$result </span>== <span class="src-num">0.0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2843"></a>                    <span class="src-var">$xNew </span>= <span class="src-sym">(</span><span class="src-var">$xLo </span>+ <span class="src-var">$xHi</span><span class="src-sym">) </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a2844"></a>                    <span class="src-var">$dx </span>= <span class="src-var">$xNew </span>- <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a2845"></a>                <span class="src-sym">}</span></li>
<li><a name="a2846"></a>                <span class="src-var">$x </span>= <span class="src-var">$xNew</span><span class="src-sym">;</span></li>
<li><a name="a2847"></a>            <span class="src-sym">}</span></li>
<li><a name="a2848"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>== <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2849"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'na'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2850"></a>            <span class="src-sym">}</span></li>
<li><a name="a2851"></a>            <span class="src-key">return </span><span class="src-id">round</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2852"></a>        <span class="src-sym">}</span></li>
<li><a name="a2853"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2854"></a>    <span class="src-sym">}</span></li>
<li><a name="a2855"></a>&nbsp;</li>
<li><a name="a2856"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2857"></a><span class="src-doc">     * GAMMALN</span></li>
<li><a name="a2858"></a><span class="src-doc">     *</span></li>
<li><a name="a2859"></a><span class="src-doc">     * Returns the natural logarithm of the gamma function.</span></li>
<li><a name="a2860"></a><span class="src-doc">     *</span></li>
<li><a name="a2861"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a2862"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2863"></a><span class="src-doc">     */</span></li>
<li><a name="a2864"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">GAMMALN</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2865"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2866"></a>&nbsp;</li>
<li><a name="a2867"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2868"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$value </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2869"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2870"></a>            <span class="src-sym">}</span></li>
<li><a name="a2871"></a>            <span class="src-key">return </span><span class="src-id">log</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">gamma</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2872"></a>        <span class="src-sym">}</span></li>
<li><a name="a2873"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2874"></a>    <span class="src-sym">}</span></li>
<li><a name="a2875"></a>&nbsp;</li>
<li><a name="a2876"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2877"></a><span class="src-doc">     * NORMDIST</span></li>
<li><a name="a2878"></a><span class="src-doc">     *</span></li>
<li><a name="a2879"></a><span class="src-doc">     * Returns the normal distribution for the specified mean and standard deviation. This</span></li>
<li><a name="a2880"></a><span class="src-doc">     * function has a very wide range of applications in statistics, including hypothesis</span></li>
<li><a name="a2881"></a><span class="src-doc">     * testing.</span></li>
<li><a name="a2882"></a><span class="src-doc">     *</span></li>
<li><a name="a2883"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a2884"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$mean </span><span class="src-doc">       Mean Value</span></li>
<li><a name="a2885"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$stdDev </span><span class="src-doc">       Standard Deviation</span></li>
<li><a name="a2886"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a2887"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2888"></a><span class="src-doc">     *</span></li>
<li><a name="a2889"></a><span class="src-doc">     */</span></li>
<li><a name="a2890"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">NORMDIST</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$mean</span><span class="src-sym">, </span><span class="src-var">$stdDev</span><span class="src-sym">, </span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2891"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2892"></a>        <span class="src-var">$mean    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2893"></a>        <span class="src-var">$stdDev    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2894"></a>&nbsp;</li>
<li><a name="a2895"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2896"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$stdDev </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2897"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2898"></a>            <span class="src-sym">}</span></li>
<li><a name="a2899"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2900"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2901"></a>                    <span class="src-key">return </span><span class="src-num">0.5 </span>* <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfVal</span><span class="src-sym">((</span><span class="src-var">$value </span>- <span class="src-var">$mean</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$stdDev </span>* <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-num">2</span><span class="src-sym">))))</span><span class="src-sym">;</span></li>
<li><a name="a2902"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a2903"></a>                    <span class="src-key">return </span><span class="src-sym">(</span><span class="src-num">1 </span>/ <span class="src-sym">(</span><span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineSQRT2PI">SQRT2PI</a> </span>* <span class="src-var">$stdDev</span><span class="src-sym">)) </span>* <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0  </span>- <span class="src-sym">(</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$value </span>- <span class="src-var">$mean</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-num">2 </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">))))</span><span class="src-sym">;</span></li>
<li><a name="a2904"></a>                <span class="src-sym">}</span></li>
<li><a name="a2905"></a>            <span class="src-sym">}</span></li>
<li><a name="a2906"></a>        <span class="src-sym">}</span></li>
<li><a name="a2907"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2908"></a>    <span class="src-sym">}</span></li>
<li><a name="a2909"></a>&nbsp;</li>
<li><a name="a2910"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2911"></a><span class="src-doc">     * NORMSDIST</span></li>
<li><a name="a2912"></a><span class="src-doc">     *</span></li>
<li><a name="a2913"></a><span class="src-doc">     * Returns the standard normal cumulative distribution function. The distribution has</span></li>
<li><a name="a2914"></a><span class="src-doc">     * a mean of 0 (zero) and a standard deviation of one. Use this function in place of a</span></li>
<li><a name="a2915"></a><span class="src-doc">     * table of standard normal curve areas.</span></li>
<li><a name="a2916"></a><span class="src-doc">     *</span></li>
<li><a name="a2917"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a2918"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2919"></a><span class="src-doc">     */</span></li>
<li><a name="a2920"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">NORMSDIST</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2921"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2922"></a>&nbsp;</li>
<li><a name="a2923"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NORMDIST</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-id">True</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2924"></a>    <span class="src-sym">}</span></li>
<li><a name="a2925"></a>&nbsp;</li>
<li><a name="a2926"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2927"></a><span class="src-doc">     * LOGNORMDIST</span></li>
<li><a name="a2928"></a><span class="src-doc">     *</span></li>
<li><a name="a2929"></a><span class="src-doc">     * Returns the cumulative lognormal distribution of x, where ln(x) is normally distributed</span></li>
<li><a name="a2930"></a><span class="src-doc">     * with parameters mean and standard_dev.</span></li>
<li><a name="a2931"></a><span class="src-doc">     *</span></li>
<li><a name="a2932"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a2933"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a2934"></a><span class="src-doc">     */</span></li>
<li><a name="a2935"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLOGNORMDIST">LOGNORMDIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$mean</span><span class="src-sym">, </span><span class="src-var">$stdDev</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2936"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2937"></a>        <span class="src-var">$mean    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2938"></a>        <span class="src-var">$stdDev    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2939"></a>&nbsp;</li>
<li><a name="a2940"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a2941"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$stdDev </span>&lt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a2942"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2943"></a>            <span class="src-sym">}</span></li>
<li><a name="a2944"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NORMSDIST</span><span class="src-sym">((</span><a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>- <span class="src-var">$mean</span><span class="src-sym">) </span>/ <span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2945"></a>        <span class="src-sym">}</span></li>
<li><a name="a2946"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2947"></a>    <span class="src-sym">}</span></li>
<li><a name="a2948"></a>&nbsp;</li>
<li><a name="a2949"></a>    <span class="src-doc">/*************************************************************************</span></li>
<li><a name="a2950"></a><span class="src-doc">     *                                inverse_ncdf.php</span></li>
<li><a name="a2951"></a><span class="src-doc">     *                            -------------------</span></li>
<li><a name="a2952"></a><span class="src-doc">     *   begin                : Friday, January 16, 2004</span></li>
<li><a name="a2953"></a><span class="src-doc">     *   copyright            : (C) 2004 Michael Nickerson</span></li>
<li><a name="a2954"></a><span class="src-doc">     *   email                : nickersonm@yahoo.com</span></li>
<li><a name="a2955"></a><span class="src-doc">     *</span></li>
<li><a name="a2956"></a><span class="src-doc">     ***************************************************************************/</span></li>
<li><a name="a2956"></a>&nbsp;</li>
<li><a name="a2957"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">inverse_ncdf</span><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a2958"></a>        <span class="src-comm">//    Inverse ncdf approximation by Peter J. Acklam, implementation adapted to</span></li>
<li><a name="a2959"></a>        <span class="src-comm">//    PHP by Michael Nickerson, using Dr. Thomas Ziegler's C implementation as</span></li>
<li><a name="a2960"></a>        <span class="src-comm">//    a guide.  http://home.online.no/~pjacklam/notes/invnorm/index.html</span></li>
<li><a name="a2961"></a>        <span class="src-comm">//    I have not checked the accuracy of this implementation.  Be aware that PHP</span></li>
<li><a name="a2962"></a>        <span class="src-comm">//    will truncate the coeficcients to 14 digits.</span></li>
<li><a name="a2963"></a>&nbsp;</li>
<li><a name="a2964"></a>        <span class="src-comm">//    You have permission to use and distribute this function freely for</span></li>
<li><a name="a2965"></a>        <span class="src-comm">//    whatever purpose you want, but please show common courtesy and give credit</span></li>
<li><a name="a2966"></a>        <span class="src-comm">//    where credit is due.</span></li>
<li><a name="a2967"></a>&nbsp;</li>
<li><a name="a2968"></a>        <span class="src-comm">//    Input paramater is $p - probability - where 0 &lt; p &lt; 1.</span></li>
<li><a name="a2969"></a>&nbsp;</li>
<li><a name="a2970"></a>        <span class="src-comm">//    Coefficients in rational approximations</span></li>
<li><a name="a2971"></a>        <span class="src-key">static </span><span class="src-var">$a </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">1 </span>=&gt; -<span class="src-num">3.969683028665376e+01</span><span class="src-sym">,</span></li>
<li><a name="a2972"></a>                            <span class="src-num">2 </span>=&gt; <span class="src-num">2.209460984245205e+02</span><span class="src-sym">,</span></li>
<li><a name="a2973"></a>                            <span class="src-num">3 </span>=&gt; -<span class="src-num">2.759285104469687e+02</span><span class="src-sym">,</span></li>
<li><a name="a2974"></a>                            <span class="src-num">4 </span>=&gt; <span class="src-num">1.383577518672690e+02</span><span class="src-sym">,</span></li>
<li><a name="a2975"></a>                            <span class="src-num">5 </span>=&gt; -<span class="src-num">3.066479806614716e+01</span><span class="src-sym">,</span></li>
<li><a name="a2976"></a>                            <span class="src-num">6 </span>=&gt; <span class="src-num">2.506628277459239e+00</span></li>
<li><a name="a2977"></a>                          <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2978"></a>&nbsp;</li>
<li><a name="a2979"></a>        <span class="src-key">static </span><span class="src-var">$b </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">1 </span>=&gt; -<span class="src-num">5.447609879822406e+01</span><span class="src-sym">,</span></li>
<li><a name="a2980"></a>                            <span class="src-num">2 </span>=&gt; <span class="src-num">1.615858368580409e+02</span><span class="src-sym">,</span></li>
<li><a name="a2981"></a>                            <span class="src-num">3 </span>=&gt; -<span class="src-num">1.556989798598866e+02</span><span class="src-sym">,</span></li>
<li><a name="a2982"></a>                            <span class="src-num">4 </span>=&gt; <span class="src-num">6.680131188771972e+01</span><span class="src-sym">,</span></li>
<li><a name="a2983"></a>                            <span class="src-num">5 </span>=&gt; -<span class="src-num">1.328068155288572e+01</span></li>
<li><a name="a2984"></a>                          <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2985"></a>&nbsp;</li>
<li><a name="a2986"></a>        <span class="src-key">static </span><span class="src-var">$c </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">1 </span>=&gt; -<span class="src-num">7.784894002430293e-03</span><span class="src-sym">,</span></li>
<li><a name="a2987"></a>                            <span class="src-num">2 </span>=&gt; -<span class="src-num">3.223964580411365e-01</span><span class="src-sym">,</span></li>
<li><a name="a2988"></a>                            <span class="src-num">3 </span>=&gt; -<span class="src-num">2.400758277161838e+00</span><span class="src-sym">,</span></li>
<li><a name="a2989"></a>                            <span class="src-num">4 </span>=&gt; -<span class="src-num">2.549732539343734e+00</span><span class="src-sym">,</span></li>
<li><a name="a2990"></a>                            <span class="src-num">5 </span>=&gt; <span class="src-num">4.374664141464968e+00</span><span class="src-sym">,</span></li>
<li><a name="a2991"></a>                            <span class="src-num">6 </span>=&gt; <span class="src-num">2.938163982698783e+00</span></li>
<li><a name="a2992"></a>                          <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2993"></a>&nbsp;</li>
<li><a name="a2994"></a>        <span class="src-key">static </span><span class="src-var">$d </span>= <span class="src-key">array</span><span class="src-sym">(    </span><span class="src-num">1 </span>=&gt; <span class="src-num">7.784695709041462e-03</span><span class="src-sym">,</span></li>
<li><a name="a2995"></a>                            <span class="src-num">2 </span>=&gt; <span class="src-num">3.224671290700398e-01</span><span class="src-sym">,</span></li>
<li><a name="a2996"></a>                            <span class="src-num">3 </span>=&gt; <span class="src-num">2.445134137142996e+00</span><span class="src-sym">,</span></li>
<li><a name="a2997"></a>                            <span class="src-num">4 </span>=&gt; <span class="src-num">3.754408661907416e+00</span></li>
<li><a name="a2998"></a>                          <span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2999"></a>&nbsp;</li>
<li><a name="a3000"></a>        <span class="src-comm">//    Define lower and upper region break-points.</span></li>
<li><a name="a3000"></a>        </li>
<li><a name="a3001"></a>        <span class="src-var">$p_low </span>=  <span class="src-num">0.02425</span><span class="src-sym">;            </span><span class="src-comm">//Use lower region approx. below this</span></li>
<li><a name="a3001"></a>        </li>
<li><a name="a3002"></a>        <span class="src-var">$p_high </span>= <span class="src-num">1 </span>- <span class="src-var">$p_low</span><span class="src-sym">;        </span><span class="src-comm">//Use upper region approx. above this</span></li>
<li><a name="a3003"></a>&nbsp;</li>
<li><a name="a3002"></a>        </li>
<li><a name="a3003"></a>&nbsp;</li>
<li><a name="a3004"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-num">0 </span>&lt; <span class="src-var">$p </span>&amp;&amp; <span class="src-var">$p </span>&lt; <span class="src-var">$p_low</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3005"></a>            <span class="src-comm">//    Rational approximation for lower region.</span></li>
<li><a name="a3005"></a>            </li>
<li><a name="a3006"></a>            <span class="src-var">$q </span>= <span class="src-id">sqrt</span><span class="src-sym">(</span>-<span class="src-num">2 </span>* <span class="src-id">log</span><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3007"></a>            <span class="src-key">return </span><span class="src-sym">(((((</span><span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">5</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">6</span><span class="src-sym">]</span><span class="src-sym">) </span>/</li>
<li><a name="a3008"></a>                    <span class="src-sym">((((</span><span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>* <span class="src-var">$q </span>+ <span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3009"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$p_low </span>&lt;= <span class="src-var">$p </span>&amp;&amp; <span class="src-var">$p </span>&lt;= <span class="src-var">$p_high</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3010"></a>            <span class="src-comm">//    Rational approximation for central region.</span></li>
<li><a name="a3011"></a>            <span class="src-var">$q </span>= <span class="src-var">$p </span>- <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a3012"></a>            <span class="src-var">$r </span>= <span class="src-var">$q </span>* <span class="src-var">$q</span><span class="src-sym">;</span></li>
<li><a name="a3013"></a>            <span class="src-key">return </span><span class="src-sym">(((((</span><span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>* <span class="src-var">$r </span>+ <span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">5</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">6</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>/</li>
<li><a name="a3014"></a>                   <span class="src-sym">(((((</span><span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>* <span class="src-var">$r </span>+ <span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">5</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$r </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3015"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$p_high </span>&lt; <span class="src-var">$p </span>&amp;&amp; <span class="src-var">$p </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3016"></a>            <span class="src-comm">//    Rational approximation for upper region.</span></li>
<li><a name="a3017"></a>            <span class="src-var">$q </span>= <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span>-<span class="src-num">2 </span>* <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$p</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3018"></a>            <span class="src-key">return </span>-<span class="src-sym">(((((</span><span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">5</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">6</span><span class="src-sym">]</span><span class="src-sym">) </span>/</li>
<li><a name="a3019"></a>                     <span class="src-sym">((((</span><span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>* <span class="src-var">$q </span>+ <span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-var">$d</span><span class="src-sym">[</span><span class="src-num">4</span><span class="src-sym">]</span><span class="src-sym">) </span>* <span class="src-var">$q </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3020"></a>        <span class="src-sym">}</span></li>
<li><a name="a3021"></a>        <span class="src-comm">//    If 0 &lt; p &lt; 1, return a null value</span></li>
<li><a name="a3022"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'null'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3023"></a>    <span class="src-sym">}</span></li>
<li><a name="a3024"></a>&nbsp;</li>
<li><a name="a3025"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">inverse_ncdf2</span><span class="src-sym">(</span><span class="src-var">$prob</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3026"></a>        <span class="src-comm">//    Approximation of inverse standard normal CDF developed by</span></li>
<li><a name="a3027"></a>        <span class="src-comm">//    B. Moro, &quot;The Full Monte,&quot; Risk 8(2), Feb 1995, 57-58.</span></li>
<li><a name="a3028"></a>&nbsp;</li>
<li><a name="a3029"></a>        <span class="src-var">$a1 </span>= <span class="src-num">2.50662823884</span><span class="src-sym">;</span></li>
<li><a name="a3030"></a>        <span class="src-var">$a2 </span>= -<span class="src-num">18.61500062529</span><span class="src-sym">;</span></li>
<li><a name="a3031"></a>        <span class="src-var">$a3 </span>= <span class="src-num">41.39119773534</span><span class="src-sym">;</span></li>
<li><a name="a3032"></a>        <span class="src-var">$a4 </span>= -<span class="src-num">25.44106049637</span><span class="src-sym">;</span></li>
<li><a name="a3033"></a>&nbsp;</li>
<li><a name="a3034"></a>        <span class="src-var">$b1 </span>= -<span class="src-num">8.4735109309</span><span class="src-sym">;</span></li>
<li><a name="a3035"></a>        <span class="src-var">$b2 </span>= <span class="src-num">23.08336743743</span><span class="src-sym">;</span></li>
<li><a name="a3036"></a>        <span class="src-var">$b3 </span>= -<span class="src-num">21.06224101826</span><span class="src-sym">;</span></li>
<li><a name="a3037"></a>        <span class="src-var">$b4 </span>= <span class="src-num">3.13082909833</span><span class="src-sym">;</span></li>
<li><a name="a3038"></a>&nbsp;</li>
<li><a name="a3039"></a>        <span class="src-var">$c1 </span>= <span class="src-num">0.337475482272615</span><span class="src-sym">;</span></li>
<li><a name="a3040"></a>        <span class="src-var">$c2 </span>= <span class="src-num">0.976169019091719</span><span class="src-sym">;</span></li>
<li><a name="a3041"></a>        <span class="src-var">$c3 </span>= <span class="src-num">0.160797971491821</span><span class="src-sym">;</span></li>
<li><a name="a3042"></a>        <span class="src-var">$c4 </span>= <span class="src-num">2.76438810333863E-02</span><span class="src-sym">;</span></li>
<li><a name="a3043"></a>        <span class="src-var">$c5 </span>= <span class="src-num">3.8405729373609E-03</span><span class="src-sym">;</span></li>
<li><a name="a3044"></a>        <span class="src-var">$c6 </span>= <span class="src-num">3.951896511919E-04</span><span class="src-sym">;</span></li>
<li><a name="a3045"></a>        <span class="src-var">$c7 </span>= <span class="src-num">3.21767881768E-05</span><span class="src-sym">;</span></li>
<li><a name="a3046"></a>        <span class="src-var">$c8 </span>= <span class="src-num">2.888167364E-07</span><span class="src-sym">;</span></li>
<li><a name="a3047"></a>        <span class="src-var">$c9 </span>= <span class="src-num">3.960315187E-07</span><span class="src-sym">;</span></li>
<li><a name="a3048"></a>&nbsp;</li>
<li><a name="a3049"></a>        <span class="src-var">$y </span>= <span class="src-var">$prob </span>- <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a3050"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$y</span><span class="src-sym">) </span>&lt; <span class="src-num">0.42</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3051"></a>            <span class="src-var">$z </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$y</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3052"></a>            <span class="src-var">$z </span>= <span class="src-var">$y </span>* <span class="src-sym">(((</span><span class="src-var">$a4 </span>* <span class="src-var">$z </span>+ <span class="src-var">$a3</span><span class="src-sym">) </span>* <span class="src-var">$z </span>+ <span class="src-var">$a2</span><span class="src-sym">) </span>* <span class="src-var">$z </span>+ <span class="src-var">$a1</span><span class="src-sym">) </span>/ <span class="src-sym">((((</span><span class="src-var">$b4 </span>* <span class="src-var">$z </span>+ <span class="src-var">$b3</span><span class="src-sym">) </span>* <span class="src-var">$z </span>+ <span class="src-var">$b2</span><span class="src-sym">) </span>* <span class="src-var">$z </span>+ <span class="src-var">$b1</span><span class="src-sym">) </span>* <span class="src-var">$z </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3053"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3054"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3055"></a>                <span class="src-var">$z </span>= <a href="http://www.php.net/log">log</a><span class="src-sym">(</span>-<a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$prob</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3056"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3057"></a>                <span class="src-var">$z </span>= <a href="http://www.php.net/log">log</a><span class="src-sym">(</span>-<a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$prob</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3058"></a>            <span class="src-sym">}</span></li>
<li><a name="a3059"></a>            <span class="src-var">$z </span>= <span class="src-var">$c1 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c2 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c3 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c4 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c5 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c6 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c7 </span>+ <span class="src-var">$z </span>* <span class="src-sym">(</span><span class="src-var">$c8 </span>+ <span class="src-var">$z </span>* <span class="src-var">$c9</span><span class="src-sym">)))))))</span><span class="src-sym">;</span></li>
<li><a name="a3060"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3061"></a>                <span class="src-var">$z </span>= -<span class="src-var">$z</span><span class="src-sym">;</span></li>
<li><a name="a3062"></a>            <span class="src-sym">}</span></li>
<li><a name="a3063"></a>        <span class="src-sym">}</span></li>
<li><a name="a3064"></a>        <span class="src-key">return </span><span class="src-var">$z</span><span class="src-sym">;</span></li>
<li><a name="a3065"></a>    <span class="src-sym">}</span></li>
<li><a name="a3066"></a>&nbsp;</li>
<li><a name="a3067"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodinverse_ncdf3">inverse_ncdf3</a><span class="src-sym">(</span><span class="src-var">$p</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3068"></a>        <span class="src-comm">//    ALGORITHM AS241 APPL. STATIST. (1988) VOL. 37, NO. 3.</span></li>
<li><a name="a3069"></a>        <span class="src-comm">//    Produces the normal deviate Z corresponding to a given lower</span></li>
<li><a name="a3070"></a>        <span class="src-comm">//    tail area of P; Z is accurate to about 1 part in 10**16.</span></li>
<li><a name="a3071"></a>        <span class="src-comm">//</span></li>
<li><a name="a3072"></a>        <span class="src-comm">//    This is a PHP version of the original FORTRAN code that can</span></li>
<li><a name="a3073"></a>        <span class="src-comm">//    be found at http://lib.stat.cmu.edu/apstat/</span></li>
<li><a name="a3074"></a>        <span class="src-var">$split1 </span>= <span class="src-num">0.425</span><span class="src-sym">;</span></li>
<li><a name="a3075"></a>        <span class="src-var">$split2 </span>= <span class="src-num">5</span><span class="src-sym">;</span></li>
<li><a name="a3076"></a>        <span class="src-var">$const1 </span>= <span class="src-num">0.180625</span><span class="src-sym">;</span></li>
<li><a name="a3077"></a>        <span class="src-var">$const2 </span>= <span class="src-num">1.6</span><span class="src-sym">;</span></li>
<li><a name="a3078"></a>&nbsp;</li>
<li><a name="a3079"></a>        <span class="src-comm">//    coefficients for p close to 0.5</span></li>
<li><a name="a3080"></a>        <span class="src-var">$a0 </span>= <span class="src-num">3.3871328727963666080</span><span class="src-sym">;</span></li>
<li><a name="a3081"></a>        <span class="src-var">$a1 </span>= <span class="src-num">1.3314166789178437745E+2</span><span class="src-sym">;</span></li>
<li><a name="a3082"></a>        <span class="src-var">$a2 </span>= <span class="src-num">1.9715909503065514427E+3</span><span class="src-sym">;</span></li>
<li><a name="a3083"></a>        <span class="src-var">$a3 </span>= <span class="src-num">1.3731693765509461125E+4</span><span class="src-sym">;</span></li>
<li><a name="a3084"></a>        <span class="src-var">$a4 </span>= <span class="src-num">4.5921953931549871457E+4</span><span class="src-sym">;</span></li>
<li><a name="a3085"></a>        <span class="src-var">$a5 </span>= <span class="src-num">6.7265770927008700853E+4</span><span class="src-sym">;</span></li>
<li><a name="a3086"></a>        <span class="src-var">$a6 </span>= <span class="src-num">3.3430575583588128105E+4</span><span class="src-sym">;</span></li>
<li><a name="a3087"></a>        <span class="src-var">$a7 </span>= <span class="src-num">2.5090809287301226727E+3</span><span class="src-sym">;</span></li>
<li><a name="a3088"></a>&nbsp;</li>
<li><a name="a3089"></a>        <span class="src-var">$b1 </span>= <span class="src-num">4.2313330701600911252E+1</span><span class="src-sym">;</span></li>
<li><a name="a3090"></a>        <span class="src-var">$b2 </span>= <span class="src-num">6.8718700749205790830E+2</span><span class="src-sym">;</span></li>
<li><a name="a3091"></a>        <span class="src-var">$b3 </span>= <span class="src-num">5.3941960214247511077E+3</span><span class="src-sym">;</span></li>
<li><a name="a3092"></a>        <span class="src-var">$b4 </span>= <span class="src-num">2.1213794301586595867E+4</span><span class="src-sym">;</span></li>
<li><a name="a3093"></a>        <span class="src-var">$b5 </span>= <span class="src-num">3.9307895800092710610E+4</span><span class="src-sym">;</span></li>
<li><a name="a3094"></a>        <span class="src-var">$b6 </span>= <span class="src-num">2.8729085735721942674E+4</span><span class="src-sym">;</span></li>
<li><a name="a3095"></a>        <span class="src-var">$b7 </span>= <span class="src-num">5.2264952788528545610E+3</span><span class="src-sym">;</span></li>
<li><a name="a3096"></a>&nbsp;</li>
<li><a name="a3097"></a>        <span class="src-comm">//    coefficients for p not close to 0, 0.5 or 1.</span></li>
<li><a name="a3098"></a>        <span class="src-var">$c0 </span>= <span class="src-num">1.42343711074968357734</span><span class="src-sym">;</span></li>
<li><a name="a3099"></a>        <span class="src-var">$c1 </span>= <span class="src-num">4.63033784615654529590</span><span class="src-sym">;</span></li>
<li><a name="a3100"></a>        <span class="src-var">$c2 </span>= <span class="src-num">5.76949722146069140550</span><span class="src-sym">;</span></li>
<li><a name="a3101"></a>        <span class="src-var">$c3 </span>= <span class="src-num">3.64784832476320460504</span><span class="src-sym">;</span></li>
<li><a name="a3102"></a>        <span class="src-var">$c4 </span>= <span class="src-num">1.27045825245236838258</span><span class="src-sym">;</span></li>
<li><a name="a3103"></a>        <span class="src-var">$c5 </span>= <span class="src-num">2.41780725177450611770E-1</span><span class="src-sym">;</span></li>
<li><a name="a3104"></a>        <span class="src-var">$c6 </span>= <span class="src-num">2.27238449892691845833E-2</span><span class="src-sym">;</span></li>
<li><a name="a3105"></a>        <span class="src-var">$c7 </span>= <span class="src-num">7.74545014278341407640E-4</span><span class="src-sym">;</span></li>
<li><a name="a3106"></a>&nbsp;</li>
<li><a name="a3107"></a>        <span class="src-var">$d1 </span>= <span class="src-num">2.05319162663775882187</span><span class="src-sym">;</span></li>
<li><a name="a3108"></a>        <span class="src-var">$d2 </span>= <span class="src-num">1.67638483018380384940</span><span class="src-sym">;</span></li>
<li><a name="a3109"></a>        <span class="src-var">$d3 </span>= <span class="src-num">6.89767334985100004550E-1</span><span class="src-sym">;</span></li>
<li><a name="a3110"></a>        <span class="src-var">$d4 </span>= <span class="src-num">1.48103976427480074590E-1</span><span class="src-sym">;</span></li>
<li><a name="a3111"></a>        <span class="src-var">$d5 </span>= <span class="src-num">1.51986665636164571966E-2</span><span class="src-sym">;</span></li>
<li><a name="a3112"></a>        <span class="src-var">$d6 </span>= <span class="src-num">5.47593808499534494600E-4</span><span class="src-sym">;</span></li>
<li><a name="a3113"></a>        <span class="src-var">$d7 </span>= <span class="src-num">1.05075007164441684324E-9</span><span class="src-sym">;</span></li>
<li><a name="a3114"></a>&nbsp;</li>
<li><a name="a3115"></a>        <span class="src-comm">//    coefficients for p near 0 or 1.</span></li>
<li><a name="a3116"></a>        <span class="src-var">$e0 </span>= <span class="src-num">6.65790464350110377720</span><span class="src-sym">;</span></li>
<li><a name="a3117"></a>        <span class="src-var">$e1 </span>= <span class="src-num">5.46378491116411436990</span><span class="src-sym">;</span></li>
<li><a name="a3118"></a>        <span class="src-var">$e2 </span>= <span class="src-num">1.78482653991729133580</span><span class="src-sym">;</span></li>
<li><a name="a3119"></a>        <span class="src-var">$e3 </span>= <span class="src-num">2.96560571828504891230E-1</span><span class="src-sym">;</span></li>
<li><a name="a3120"></a>        <span class="src-var">$e4 </span>= <span class="src-num">2.65321895265761230930E-2</span><span class="src-sym">;</span></li>
<li><a name="a3121"></a>        <span class="src-var">$e5 </span>= <span class="src-num">1.24266094738807843860E-3</span><span class="src-sym">;</span></li>
<li><a name="a3122"></a>        <span class="src-var">$e6 </span>= <span class="src-num">2.71155556874348757815E-5</span><span class="src-sym">;</span></li>
<li><a name="a3123"></a>        <span class="src-var">$e7 </span>= <span class="src-num">2.01033439929228813265E-7</span><span class="src-sym">;</span></li>
<li><a name="a3124"></a>&nbsp;</li>
<li><a name="a3125"></a>        <span class="src-var">$f1 </span>= <span class="src-num">5.99832206555887937690E-1</span><span class="src-sym">;</span></li>
<li><a name="a3126"></a>        <span class="src-var">$f2 </span>= <span class="src-num">1.36929880922735805310E-1</span><span class="src-sym">;</span></li>
<li><a name="a3127"></a>        <span class="src-var">$f3 </span>= <span class="src-num">1.48753612908506148525E-2</span><span class="src-sym">;</span></li>
<li><a name="a3128"></a>        <span class="src-var">$f4 </span>= <span class="src-num">7.86869131145613259100E-4</span><span class="src-sym">;</span></li>
<li><a name="a3129"></a>        <span class="src-var">$f5 </span>= <span class="src-num">1.84631831751005468180E-5</span><span class="src-sym">;</span></li>
<li><a name="a3130"></a>        <span class="src-var">$f6 </span>= <span class="src-num">1.42151175831644588870E-7</span><span class="src-sym">;</span></li>
<li><a name="a3131"></a>        <span class="src-var">$f7 </span>= <span class="src-num">2.04426310338993978564E-15</span><span class="src-sym">;</span></li>
<li><a name="a3132"></a>&nbsp;</li>
<li><a name="a3133"></a>        <span class="src-var">$q </span>= <span class="src-var">$p </span>- <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a3134"></a>&nbsp;</li>
<li><a name="a3135"></a>        <span class="src-comm">//    computation for p close to 0.5</span></li>
<li><a name="a3136"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$q</span><span class="src-sym">) </span>&lt;= <span class="src-id">split1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3137"></a>            <span class="src-var">$R </span>= <span class="src-var">$const1 </span>- <span class="src-var">$q </span>* <span class="src-var">$q</span><span class="src-sym">;</span></li>
<li><a name="a3138"></a>            <span class="src-var">$z </span>= <span class="src-var">$q </span>* <span class="src-sym">(((((((</span><span class="src-var">$a7 </span>* <span class="src-var">$R </span>+ <span class="src-var">$a6</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$a5</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$a4</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$a3</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$a2</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$a1</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$a0</span><span class="src-sym">) </span>/</li>
<li><a name="a3139"></a>                      <span class="src-sym">(((((((</span><span class="src-var">$b7 </span>* <span class="src-var">$R </span>+ <span class="src-var">$b6</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$b5</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$b4</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$b3</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$b2</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$b1</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3140"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3141"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$q </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3142"></a>                <span class="src-var">$R </span>= <span class="src-var">$p</span><span class="src-sym">;</span></li>
<li><a name="a3143"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3144"></a>                <span class="src-var">$R </span>= <span class="src-num">1 </span>- <span class="src-var">$p</span><span class="src-sym">;</span></li>
<li><a name="a3145"></a>            <span class="src-sym">}</span></li>
<li><a name="a3146"></a>            <span class="src-var">$R </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span>-<a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$R</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3147"></a>&nbsp;</li>
<li><a name="a3148"></a>            <span class="src-comm">//    computation for p not close to 0, 0.5 or 1.</span></li>
<li><a name="a3149"></a>            <span class="src-key">If </span><span class="src-sym">(</span><span class="src-var">$R </span>&lt;= <span class="src-var">$split2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3150"></a>                <span class="src-var">$R </span>= <span class="src-var">$R </span>- <span class="src-var">$const2</span><span class="src-sym">;</span></li>
<li><a name="a3151"></a>                <span class="src-var">$z </span>= <span class="src-sym">(((((((</span><span class="src-var">$c7 </span>* <span class="src-var">$R </span>+ <span class="src-var">$c6</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$c5</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$c4</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$c3</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$c2</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$c1</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$c0</span><span class="src-sym">) </span>/</li>
<li><a name="a3152"></a>                     <span class="src-sym">(((((((</span><span class="src-var">$d7 </span>* <span class="src-var">$R </span>+ <span class="src-var">$d6</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$d5</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$d4</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$d3</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$d2</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$d1</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3153"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3154"></a>            <span class="src-comm">//    computation for p near 0 or 1.</span></li>
<li><a name="a3155"></a>                <span class="src-var">$R </span>= <span class="src-var">$R </span>- <span class="src-var">$split2</span><span class="src-sym">;</span></li>
<li><a name="a3156"></a>                <span class="src-var">$z </span>= <span class="src-sym">(((((((</span><span class="src-var">$e7 </span>* <span class="src-var">$R </span>+ <span class="src-var">$e6</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$e5</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$e4</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$e3</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$e2</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$e1</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$e0</span><span class="src-sym">) </span>/</li>
<li><a name="a3157"></a>                     <span class="src-sym">(((((((</span><span class="src-var">$f7 </span>* <span class="src-var">$R </span>+ <span class="src-var">$f6</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$f5</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$f4</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$f3</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$f2</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-var">$f1</span><span class="src-sym">) </span>* <span class="src-var">$R </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3158"></a>            <span class="src-sym">}</span></li>
<li><a name="a3159"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$q </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3160"></a>                <span class="src-var">$z </span>= -<span class="src-var">$z</span><span class="src-sym">;</span></li>
<li><a name="a3161"></a>            <span class="src-sym">}</span></li>
<li><a name="a3162"></a>        <span class="src-sym">}</span></li>
<li><a name="a3163"></a>        <span class="src-key">return </span><span class="src-var">$z</span><span class="src-sym">;</span></li>
<li><a name="a3164"></a>    <span class="src-sym">}</span></li>
<li><a name="a3165"></a>&nbsp;</li>
<li><a name="a3166"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3167"></a><span class="src-doc">     * NORMINV</span></li>
<li><a name="a3168"></a><span class="src-doc">     *</span></li>
<li><a name="a3169"></a><span class="src-doc">     * Returns the inverse of the normal cumulative distribution for the specified mean and standard deviation.</span></li>
<li><a name="a3170"></a><span class="src-doc">     *</span></li>
<li><a name="a3171"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a3172"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$mean </span><span class="src-doc">       Mean Value</span></li>
<li><a name="a3173"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$stdDev </span><span class="src-doc">       Standard Deviation</span></li>
<li><a name="a3174"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3175"></a><span class="src-doc">     *</span></li>
<li><a name="a3176"></a><span class="src-doc">     */</span></li>
<li><a name="a3177"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodNORMINV">NORMINV</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">,</span><span class="src-var">$mean</span><span class="src-sym">,</span><span class="src-var">$stdDev</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3178"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3179"></a>        <span class="src-var">$mean            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3180"></a>        <span class="src-var">$stdDev            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3181"></a>&nbsp;</li>
<li><a name="a3182"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3183"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$probability </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3184"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3185"></a>            <span class="src-sym">}</span></li>
<li><a name="a3186"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$stdDev </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3187"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3188"></a>            <span class="src-sym">}</span></li>
<li><a name="a3189"></a>            <span class="src-key">return </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">inverse_ncdf</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">) </span>* <span class="src-var">$stdDev</span><span class="src-sym">) </span>+ <span class="src-var">$mean</span><span class="src-sym">;</span></li>
<li><a name="a3190"></a>        <span class="src-sym">}</span></li>
<li><a name="a3191"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3192"></a>    <span class="src-sym">}</span></li>
<li><a name="a3193"></a>&nbsp;</li>
<li><a name="a3194"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3195"></a><span class="src-doc">     * NORMSINV</span></li>
<li><a name="a3196"></a><span class="src-doc">     *</span></li>
<li><a name="a3197"></a><span class="src-doc">     * Returns the inverse of the standard normal cumulative distribution</span></li>
<li><a name="a3198"></a><span class="src-doc">     *</span></li>
<li><a name="a3199"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a3200"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3201"></a><span class="src-doc">     */</span></li>
<li><a name="a3202"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">NORMSINV</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3203"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NORMINV</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3204"></a>    <span class="src-sym">}</span></li>
<li><a name="a3205"></a>&nbsp;</li>
<li><a name="a3206"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3207"></a><span class="src-doc">     * LOGINV</span></li>
<li><a name="a3208"></a><span class="src-doc">     *</span></li>
<li><a name="a3209"></a><span class="src-doc">     * Returns the inverse of the normal cumulative distribution</span></li>
<li><a name="a3210"></a><span class="src-doc">     *</span></li>
<li><a name="a3211"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a3212"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3213"></a><span class="src-doc">     *</span></li>
<li><a name="a3214"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@todo</span><span class="src-doc">    Try implementing P J Acklam's refinement algorithm for greater</span></li>
<li><a name="a3215"></a><span class="src-doc">     *             accuracy if I can get my head round the mathematics</span></li>
<li><a name="a3216"></a><span class="src-doc">     *             (as described at) http://home.online.no/~pjacklam/notes/invnorm/</span></li>
<li><a name="a3217"></a><span class="src-doc">     */</span></li>
<li><a name="a3218"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodLOGINV">LOGINV</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">, </span><span class="src-var">$mean</span><span class="src-sym">, </span><span class="src-var">$stdDev</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3219"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3220"></a>        <span class="src-var">$mean            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3221"></a>        <span class="src-var">$stdDev            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3222"></a>&nbsp;</li>
<li><a name="a3223"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3224"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$probability </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$probability </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$stdDev </span>&lt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3225"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3226"></a>            <span class="src-sym">}</span></li>
<li><a name="a3227"></a>            <span class="src-key">return </span><span class="src-id">exp</span><span class="src-sym">(</span><span class="src-var">$mean </span>+ <span class="src-var">$stdDev </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NORMSINV</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3228"></a>        <span class="src-sym">}</span></li>
<li><a name="a3229"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3230"></a>    <span class="src-sym">}</span></li>
<li><a name="a3231"></a>&nbsp;</li>
<li><a name="a3232"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3233"></a><span class="src-doc">     * HYPGEOMDIST</span></li>
<li><a name="a3234"></a><span class="src-doc">     *</span></li>
<li><a name="a3235"></a><span class="src-doc">     * Returns the hypergeometric distribution. HYPGEOMDIST returns the probability of a given number of</span></li>
<li><a name="a3236"></a><span class="src-doc">     * sample successes, given the sample size, population successes, and population size.</span></li>
<li><a name="a3237"></a><span class="src-doc">     *</span></li>
<li><a name="a3238"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$sampleSuccesses </span><span class="src-doc">       Number of successes in the sample</span></li>
<li><a name="a3239"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$sampleNumber </span><span class="src-doc">           Size of the sample</span></li>
<li><a name="a3240"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$populationSuccesses </span><span class="src-doc">   Number of successes in the population</span></li>
<li><a name="a3241"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$populationNumber </span><span class="src-doc">       Population size</span></li>
<li><a name="a3242"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3243"></a><span class="src-doc">     *</span></li>
<li><a name="a3244"></a><span class="src-doc">     */</span></li>
<li><a name="a3245"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">HYPGEOMDIST</span><span class="src-sym">(</span><span class="src-var">$sampleSuccesses</span><span class="src-sym">, </span><span class="src-var">$sampleNumber</span><span class="src-sym">, </span><span class="src-var">$populationSuccesses</span><span class="src-sym">, </span><span class="src-var">$populationNumber</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3246"></a>        <span class="src-var">$sampleSuccesses        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$sampleSuccesses</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3247"></a>        <span class="src-var">$sampleNumber            </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$sampleNumber</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3248"></a>        <span class="src-var">$populationSuccesses    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$populationSuccesses</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3249"></a>        <span class="src-var">$populationNumber        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$populationNumber</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3250"></a>&nbsp;</li>
<li><a name="a3251"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$sampleSuccesses</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$sampleNumber</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$populationSuccesses</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$populationNumber</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3252"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$sampleSuccesses </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$sampleSuccesses </span>&gt; <span class="src-var">$sampleNumber</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$sampleSuccesses </span>&gt; <span class="src-var">$populationSuccesses</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3253"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3254"></a>            <span class="src-sym">}</span></li>
<li><a name="a3255"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$sampleNumber </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$sampleNumber </span>&gt; <span class="src-var">$populationNumber</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3256"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3257"></a>            <span class="src-sym">}</span></li>
<li><a name="a3258"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$populationSuccesses </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$populationSuccesses </span>&gt; <span class="src-var">$populationNumber</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3259"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3260"></a>            <span class="src-sym">}</span></li>
<li><a name="a3261"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$populationSuccesses</span><span class="src-sym">,</span><span class="src-var">$sampleSuccesses</span><span class="src-sym">) </span>*</li>
<li><a name="a3262"></a>                   <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$populationNumber </span>- <span class="src-var">$populationSuccesses</span><span class="src-sym">,</span><span class="src-var">$sampleNumber </span>- <span class="src-var">$sampleSuccesses</span><span class="src-sym">) </span>/</li>
<li><a name="a3263"></a>                   <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$populationNumber</span><span class="src-sym">,</span><span class="src-var">$sampleNumber</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3264"></a>        <span class="src-sym">}</span></li>
<li><a name="a3265"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3266"></a>    <span class="src-sym">}</span></li>
<li><a name="a3267"></a>&nbsp;</li>
<li><a name="a3268"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">hypGeom</span><span class="src-sym">(</span><span class="src-var">$sampleSuccesses</span><span class="src-sym">, </span><span class="src-var">$sampleNumber</span><span class="src-sym">, </span><span class="src-var">$populationSuccesses</span><span class="src-sym">, </span><span class="src-var">$populationNumber</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3269"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$populationSuccesses</span><span class="src-sym">,</span><span class="src-var">$sampleSuccesses</span><span class="src-sym">) </span>*</li>
<li><a name="a3270"></a>               <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$populationNumber </span>- <span class="src-var">$populationSuccesses</span><span class="src-sym">,</span><span class="src-var">$sampleNumber </span>- <span class="src-var">$sampleSuccesses</span><span class="src-sym">) </span>/</li>
<li><a name="a3271"></a>               <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMBIN</span><span class="src-sym">(</span><span class="src-var">$populationNumber</span><span class="src-sym">,</span><span class="src-var">$sampleNumber</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3272"></a>    <span class="src-sym">}</span></li>
<li><a name="a3273"></a>&nbsp;</li>
<li><a name="a3274"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3275"></a><span class="src-doc">     * TDIST</span></li>
<li><a name="a3276"></a><span class="src-doc">     *</span></li>
<li><a name="a3277"></a><span class="src-doc">     * Returns the probability of Student's T distribution.</span></li>
<li><a name="a3278"></a><span class="src-doc">     *</span></li>
<li><a name="a3279"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">           Value for the function</span></li>
<li><a name="a3280"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$degrees </span><span class="src-doc">       degrees of freedom</span></li>
<li><a name="a3281"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$tails </span><span class="src-doc">           number of tails (1 or 2)</span></li>
<li><a name="a3282"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3283"></a><span class="src-doc">     */</span></li>
<li><a name="a3284"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodTDIST">TDIST</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$degrees</span><span class="src-sym">, </span><span class="src-var">$tails</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3285"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3286"></a>        <span class="src-var">$degrees    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3287"></a>        <span class="src-var">$tails        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$tails</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3288"></a>&nbsp;</li>
<li><a name="a3289"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$tails</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3290"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$degrees </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$tails </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$tails </span>&gt; <span class="src-num">2</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3291"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3292"></a>            <span class="src-sym">}</span></li>
<li><a name="a3293"></a>            <span class="src-comm">//    tdist, which finds the probability that corresponds to a given value</span></li>
<li><a name="a3294"></a>            <span class="src-comm">//    of t with k degrees of freedom.  This algorithm is translated from a</span></li>
<li><a name="a3295"></a>            <span class="src-comm">//    pascal function on p81 of &quot;Statistical Computing in Pascal&quot; by D</span></li>
<li><a name="a3296"></a>            <span class="src-comm">//    Cooke, A H Craven &amp; G M Clark (1985: Edward Arnold (Pubs.) Ltd:</span></li>
<li><a name="a3297"></a>            <span class="src-comm">//    London).  The above Pascal algorithm is itself a translation of the</span></li>
<li><a name="a3298"></a>            <span class="src-comm">//    fortran algoritm &quot;AS 3&quot; by B E Cooper of the Atlas Computer</span></li>
<li><a name="a3299"></a>            <span class="src-comm">//    Laboratory as reported in (among other places) &quot;Applied Statistics</span></li>
<li><a name="a3300"></a>            <span class="src-comm">//    Algorithms&quot;, editied by P Griffiths and I D Hill (1985; Ellis</span></li>
<li><a name="a3301"></a>            <span class="src-comm">//    Horwood Ltd.; W. Sussex, England).</span></li>
<li><a name="a3302"></a><span class="src-comm">//            $ta = 2 / pi();</span></li>
<li><a name="a3303"></a>            <span class="src-var">$ta </span>= <span class="src-num">0.636619772367581</span><span class="src-sym">;</span></li>
<li><a name="a3304"></a>            <span class="src-var">$tterm </span>= <span class="src-var">$degrees</span><span class="src-sym">;</span></li>
<li><a name="a3305"></a>            <span class="src-var">$ttheta </span>= <span class="src-id">atan2</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$tterm</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3306"></a>            <span class="src-var">$tc </span>= <a href="http://www.php.net/cos">cos</a><span class="src-sym">(</span><span class="src-var">$ttheta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3307"></a>            <span class="src-var">$ts </span>= <a href="http://www.php.net/sin">sin</a><span class="src-sym">(</span><span class="src-var">$ttheta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3308"></a>            <span class="src-var">$tsum </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3309"></a>&nbsp;</li>
<li><a name="a3310"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$degrees </span>% <span class="src-num">2</span><span class="src-sym">) </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3311"></a>                <span class="src-var">$ti </span>= <span class="src-num">3</span><span class="src-sym">;</span></li>
<li><a name="a3312"></a>                <span class="src-var">$tterm </span>= <span class="src-var">$tc</span><span class="src-sym">;</span></li>
<li><a name="a3313"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3314"></a>                <span class="src-var">$ti </span>= <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a3315"></a>                <span class="src-var">$tterm </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3316"></a>            <span class="src-sym">}</span></li>
<li><a name="a3317"></a>&nbsp;</li>
<li><a name="a3318"></a>            <span class="src-var">$tsum </span>= <span class="src-var">$tterm</span><span class="src-sym">;</span></li>
<li><a name="a3319"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$ti </span>&lt; <span class="src-var">$degrees</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3320"></a>                <span class="src-var">$tterm </span>*= <span class="src-var">$tc </span>* <span class="src-var">$tc </span>* <span class="src-sym">(</span><span class="src-var">$ti </span>- <span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-var">$ti</span><span class="src-sym">;</span></li>
<li><a name="a3321"></a>                <span class="src-var">$tsum </span>+= <span class="src-var">$tterm</span><span class="src-sym">;</span></li>
<li><a name="a3322"></a>                <span class="src-var">$ti </span>+= <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a3323"></a>            <span class="src-sym">}</span></li>
<li><a name="a3324"></a>            <span class="src-var">$tsum </span>*= <span class="src-var">$ts</span><span class="src-sym">;</span></li>
<li><a name="a3325"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$degrees </span>% <span class="src-num">2</span><span class="src-sym">) </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$tsum </span>= <span class="src-var">$ta </span>* <span class="src-sym">(</span><span class="src-var">$tsum </span>+ <span class="src-var">$ttheta</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a3326"></a>            <span class="src-var">$tValue </span>= <span class="src-num">0.5 </span>* <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$tsum</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3327"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$tails </span>== <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3328"></a>                <span class="src-key">return </span><span class="src-num">1 </span>- <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$tValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3329"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3330"></a>                <span class="src-key">return </span><span class="src-num">1 </span>- <a href="http://www.php.net/abs">abs</a><span class="src-sym">((</span><span class="src-num">1 </span>- <span class="src-var">$tValue</span><span class="src-sym">) </span>- <span class="src-var">$tValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3331"></a>            <span class="src-sym">}</span></li>
<li><a name="a3332"></a>        <span class="src-sym">}</span></li>
<li><a name="a3333"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3334"></a>    <span class="src-sym">}</span></li>
<li><a name="a3335"></a>&nbsp;</li>
<li><a name="a3336"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3337"></a><span class="src-doc">     * TINV</span></li>
<li><a name="a3338"></a><span class="src-doc">     *</span></li>
<li><a name="a3339"></a><span class="src-doc">     * Returns the one-tailed probability of the chi-squared distribution.</span></li>
<li><a name="a3340"></a><span class="src-doc">     *</span></li>
<li><a name="a3341"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$probability </span><span class="src-doc">   Probability for the function</span></li>
<li><a name="a3342"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$degrees </span><span class="src-doc">       degrees of freedom</span></li>
<li><a name="a3343"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3344"></a><span class="src-doc">     */</span></li>
<li><a name="a3345"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">TINV</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">, </span><span class="src-var">$degrees</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3346"></a>        <span class="src-var">$probability    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3347"></a>        <span class="src-var">$degrees        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3348"></a>&nbsp;</li>
<li><a name="a3349"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$probability</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$degrees</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3350"></a>            <span class="src-var">$xLo </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a3351"></a>            <span class="src-var">$xHi </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3352"></a>            <span class="src-var">$maxIteration </span>= <span class="src-num">100</span><span class="src-sym">;</span></li>
<li><a name="a3353"></a>&nbsp;</li>
<li><a name="a3354"></a>            <span class="src-var">$x </span>= <span class="src-var">$xNew </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3355"></a>            <span class="src-var">$dx    </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3356"></a>            <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3357"></a>&nbsp;</li>
<li><a name="a3358"></a>            <span class="src-key">while </span><span class="src-sym">((</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$dx</span><span class="src-sym">) </span>&gt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#definePRECISION">PRECISION</a></span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$i</span>++ &lt; <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3359"></a>                <span class="src-comm">// Apply Newton-Raphson step</span></li>
<li><a name="a3360"></a>                <span class="src-var">$result </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TDIST</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$degrees</span><span class="src-sym">, </span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3361"></a>                <span class="src-var">$error </span>= <span class="src-var">$result </span>- <span class="src-var">$probability</span><span class="src-sym">;</span></li>
<li><a name="a3362"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$error </span>== <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3363"></a>                    <span class="src-var">$dx </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3364"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-var">$error </span>&lt; <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3365"></a>                    <span class="src-var">$xLo </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a3366"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3367"></a>                    <span class="src-var">$xHi </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a3368"></a>                <span class="src-sym">}</span></li>
<li><a name="a3369"></a>                <span class="src-comm">// Avoid division by zero</span></li>
<li><a name="a3370"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$result </span>!= <span class="src-num">0.0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3371"></a>                    <span class="src-var">$dx </span>= <span class="src-var">$error </span>/ <span class="src-var">$result</span><span class="src-sym">;</span></li>
<li><a name="a3372"></a>                    <span class="src-var">$xNew </span>= <span class="src-var">$x </span>- <span class="src-var">$dx</span><span class="src-sym">;</span></li>
<li><a name="a3373"></a>                <span class="src-sym">}</span></li>
<li><a name="a3374"></a>                <span class="src-comm">// If the NR fails to converge (which for example may be the</span></li>
<li><a name="a3375"></a>                <span class="src-comm">// case if the initial guess is too rough) we apply a bisection</span></li>
<li><a name="a3376"></a>                <span class="src-comm">// step to determine a more narrow interval around the root.</span></li>
<li><a name="a3377"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$xNew </span>&lt; <span class="src-var">$xLo</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$xNew </span>&gt; <span class="src-var">$xHi</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$result </span>== <span class="src-num">0.0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3378"></a>                    <span class="src-var">$xNew </span>= <span class="src-sym">(</span><span class="src-var">$xLo </span>+ <span class="src-var">$xHi</span><span class="src-sym">) </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a3379"></a>                    <span class="src-var">$dx </span>= <span class="src-var">$xNew </span>- <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a3380"></a>                <span class="src-sym">}</span></li>
<li><a name="a3381"></a>                <span class="src-var">$x </span>= <span class="src-var">$xNew</span><span class="src-sym">;</span></li>
<li><a name="a3382"></a>            <span class="src-sym">}</span></li>
<li><a name="a3383"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>== <span class="src-id"><a href="../PHPExcel_Calculation/_Classes_PHPExcel_Calculation_Functions_php.html#defineMAX_ITERATIONS">MAX_ITERATIONS</a></span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3384"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'na'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3385"></a>            <span class="src-sym">}</span></li>
<li><a name="a3386"></a>            <span class="src-key">return </span><span class="src-id">round</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3387"></a>        <span class="src-sym">}</span></li>
<li><a name="a3388"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3389"></a>    <span class="src-sym">}</span></li>
<li><a name="a3390"></a>&nbsp;</li>
<li><a name="a3391"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3392"></a><span class="src-doc">     * CONFIDENCE</span></li>
<li><a name="a3393"></a><span class="src-doc">     *</span></li>
<li><a name="a3394"></a><span class="src-doc">     * Returns the confidence interval for a population mean</span></li>
<li><a name="a3395"></a><span class="src-doc">     *</span></li>
<li><a name="a3396"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$alpha </span></li>
<li><a name="a3397"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$stdDev </span><span class="src-doc">       Standard Deviation</span></li>
<li><a name="a3398"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$size </span></li>
<li><a name="a3399"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3400"></a><span class="src-doc">     *</span></li>
<li><a name="a3401"></a><span class="src-doc">     */</span></li>
<li><a name="a3402"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">CONFIDENCE</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">,</span><span class="src-var">$stdDev</span><span class="src-sym">,</span><span class="src-var">$size</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3403"></a>        <span class="src-var">$alpha    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3404"></a>        <span class="src-var">$stdDev    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3405"></a>        <span class="src-var">$size    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$size</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3406"></a>&nbsp;</li>
<li><a name="a3407"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$stdDev</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$size</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3408"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$alpha </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$alpha </span>&gt;= <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3409"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3410"></a>            <span class="src-sym">}</span></li>
<li><a name="a3411"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$stdDev </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$size </span>&lt; <span class="src-num">1</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3412"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3413"></a>            <span class="src-sym">}</span></li>
<li><a name="a3414"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">NORMSINV</span><span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$alpha </span>/ <span class="src-num">2</span><span class="src-sym">) </span>* <span class="src-var">$stdDev </span>/ <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$size</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3415"></a>        <span class="src-sym">}</span></li>
<li><a name="a3416"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3417"></a>    <span class="src-sym">}</span></li>
<li><a name="a3418"></a>&nbsp;</li>
<li><a name="a3419"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3420"></a><span class="src-doc">     * POISSON</span></li>
<li><a name="a3421"></a><span class="src-doc">     *</span></li>
<li><a name="a3422"></a><span class="src-doc">     * Returns the Poisson distribution. A common application of the Poisson distribution</span></li>
<li><a name="a3423"></a><span class="src-doc">     * is predicting the number of events over a specific time, such as the number of</span></li>
<li><a name="a3424"></a><span class="src-doc">     * cars arriving at a toll plaza in 1 minute.</span></li>
<li><a name="a3425"></a><span class="src-doc">     *</span></li>
<li><a name="a3426"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a3427"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$mean </span><span class="src-doc">       Mean Value</span></li>
<li><a name="a3428"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a3429"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3430"></a><span class="src-doc">     *</span></li>
<li><a name="a3431"></a><span class="src-doc">     */</span></li>
<li><a name="a3432"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">POISSON</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$mean</span><span class="src-sym">, </span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3433"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3434"></a>        <span class="src-var">$mean    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3435"></a>&nbsp;</li>
<li><a name="a3436"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3437"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$mean </span>&lt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3438"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3439"></a>            <span class="src-sym">}</span></li>
<li><a name="a3440"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3441"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3442"></a>                    <span class="src-var">$summer </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3443"></a>                    <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt;= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3444"></a>                        <span class="src-var">$summer </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">,</span><span class="src-var">$i</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$i</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3445"></a>                    <span class="src-sym">}</span></li>
<li><a name="a3446"></a>                    <span class="src-key">return </span><a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0</span>-<span class="src-var">$mean</span><span class="src-sym">) </span>* <span class="src-var">$summer</span><span class="src-sym">;</span></li>
<li><a name="a3447"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3448"></a>                    <span class="src-key">return </span><span class="src-sym">(</span><a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0</span>-<span class="src-var">$mean</span><span class="src-sym">) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$mean</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">)) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3449"></a>                <span class="src-sym">}</span></li>
<li><a name="a3450"></a>            <span class="src-sym">}</span></li>
<li><a name="a3451"></a>        <span class="src-sym">}</span></li>
<li><a name="a3452"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3453"></a>    <span class="src-sym">}</span></li>
<li><a name="a3454"></a>&nbsp;</li>
<li><a name="a3455"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3456"></a><span class="src-doc">     * WEIBULL</span></li>
<li><a name="a3457"></a><span class="src-doc">     *</span></li>
<li><a name="a3458"></a><span class="src-doc">     * Returns the Weibull distribution. Use this distribution in reliability</span></li>
<li><a name="a3459"></a><span class="src-doc">     * analysis, such as calculating a device's mean time to failure.</span></li>
<li><a name="a3460"></a><span class="src-doc">     *</span></li>
<li><a name="a3461"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a3462"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$alpha </span><span class="src-doc">       Alpha Parameter</span></li>
<li><a name="a3463"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$beta </span><span class="src-doc">       Beta Parameter</span></li>
<li><a name="a3464"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">       </span><span class="src-doc-var">$cumulative </span></li>
<li><a name="a3465"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3466"></a><span class="src-doc">     *</span></li>
<li><a name="a3467"></a><span class="src-doc">     */</span></li>
<li><a name="a3468"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">WEIBULL</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-var">$alpha</span><span class="src-sym">, </span><span class="src-var">$beta</span><span class="src-sym">, </span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3469"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3470"></a>        <span class="src-var">$alpha    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3471"></a>        <span class="src-var">$beta    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3472"></a>&nbsp;</li>
<li><a name="a3473"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$alpha</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3474"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$value </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$alpha </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$beta </span>&lt;= <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3475"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3476"></a>            <span class="src-sym">}</span></li>
<li><a name="a3477"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3478"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cumulative</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3479"></a>                    <span class="src-key">return </span><span class="src-num">1 </span>- <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0 </span>- <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$value </span>/ <span class="src-var">$beta</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3480"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3481"></a>                    <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$alpha </span>/ <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$beta</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">)) </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$alpha </span>- <span class="src-num">1</span><span class="src-sym">) </span>* <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-num">0 </span>- <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$value </span>/ <span class="src-var">$beta</span><span class="src-sym">,</span><span class="src-var">$alpha</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3482"></a>                <span class="src-sym">}</span></li>
<li><a name="a3483"></a>            <span class="src-sym">}</span></li>
<li><a name="a3484"></a>        <span class="src-sym">}</span></li>
<li><a name="a3485"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3486"></a>    <span class="src-sym">}</span></li>
<li><a name="a3487"></a>&nbsp;</li>
<li><a name="a3488"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3489"></a><span class="src-doc">     * SKEW</span></li>
<li><a name="a3490"></a><span class="src-doc">     *</span></li>
<li><a name="a3491"></a><span class="src-doc">     * Returns the skewness of a distribution. Skewness characterizes the degree of asymmetry</span></li>
<li><a name="a3492"></a><span class="src-doc">     * of a distribution around its mean. Positive skewness indicates a distribution with an</span></li>
<li><a name="a3493"></a><span class="src-doc">     * asymmetric tail extending toward more positive values. Negative skewness indicates a</span></li>
<li><a name="a3494"></a><span class="src-doc">     * distribution with an asymmetric tail extending toward more negative values.</span></li>
<li><a name="a3495"></a><span class="src-doc">     *</span></li>
<li><a name="a3496"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   Data Series</span></li>
<li><a name="a3497"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3498"></a><span class="src-doc">     */</span></li>
<li><a name="a3499"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">SKEW</span><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3500"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3501"></a>        <span class="src-var">$mean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3502"></a>        <span class="src-var">$stdDev </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTDEV">STDEV</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3503"></a>&nbsp;</li>
<li><a name="a3504"></a>        <span class="src-var">$count </span>= <span class="src-var">$summer </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3505"></a>        <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a3506"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3507"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a3508"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3509"></a>                <span class="src-var">$summer </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(((</span><span class="src-var">$arg </span>- <span class="src-var">$mean</span><span class="src-sym">) </span>/ <span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">3</span><span class="src-sym">) </span><span class="src-sym">;</span></li>
<li><a name="a3510"></a>                ++<span class="src-var">$count</span><span class="src-sym">;</span></li>
<li><a name="a3511"></a>            <span class="src-sym">}</span></li>
<li><a name="a3512"></a>        <span class="src-sym">}</span></li>
<li><a name="a3513"></a>&nbsp;</li>
<li><a name="a3514"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a3515"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$count </span>&gt; <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3516"></a>            <span class="src-key">return </span><span class="src-var">$summer </span>* <span class="src-sym">(</span><span class="src-var">$count </span>/ <span class="src-sym">((</span><span class="src-var">$count</span>-<span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$count</span>-<span class="src-num">2</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a3517"></a>        <span class="src-sym">}</span></li>
<li><a name="a3518"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3519"></a>    <span class="src-sym">}</span></li>
<li><a name="a3520"></a>&nbsp;</li>
<li><a name="a3521"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3522"></a><span class="src-doc">     * KURT</span></li>
<li><a name="a3523"></a><span class="src-doc">     *</span></li>
<li><a name="a3524"></a><span class="src-doc">     * Returns the kurtosis of a data set. Kurtosis characterizes the relative peakedness</span></li>
<li><a name="a3525"></a><span class="src-doc">     * or flatness of a distribution compared with the normal distribution. Positive</span></li>
<li><a name="a3526"></a><span class="src-doc">     * kurtosis indicates a relatively peaked distribution. Negative kurtosis indicates a</span></li>
<li><a name="a3527"></a><span class="src-doc">     * relatively flat distribution.</span></li>
<li><a name="a3528"></a><span class="src-doc">     *</span></li>
<li><a name="a3529"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   Data Series</span></li>
<li><a name="a3530"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a3531"></a><span class="src-doc">     */</span></li>
<li><a name="a3532"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">KURT</span><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3533"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3534"></a>        <span class="src-var">$mean </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodAVERAGE">AVERAGE</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3535"></a>        <span class="src-var">$stdDev </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTDEV">STDEV</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3536"></a>&nbsp;</li>
<li><a name="a3537"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$stdDev </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3538"></a>            <span class="src-var">$count </span>= <span class="src-var">$summer </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3539"></a>            <span class="src-comm">// Loop through arguments</span></li>
<li><a name="a3540"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3541"></a>                <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a3542"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3543"></a>                    <span class="src-var">$summer </span>+= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(((</span><span class="src-var">$arg </span>- <span class="src-var">$mean</span><span class="src-sym">) </span>/ <span class="src-var">$stdDev</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">4</span><span class="src-sym">) </span><span class="src-sym">;</span></li>
<li><a name="a3544"></a>                    ++<span class="src-var">$count</span><span class="src-sym">;</span></li>
<li><a name="a3545"></a>                <span class="src-sym">}</span></li>
<li><a name="a3546"></a>            <span class="src-sym">}</span></li>
<li><a name="a3547"></a>&nbsp;</li>
<li><a name="a3548"></a>            <span class="src-comm">// Return</span></li>
<li><a name="a3549"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$count </span>&gt; <span class="src-num">3</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3550"></a>                <span class="src-key">return </span><span class="src-var">$summer </span>* <span class="src-sym">(</span><span class="src-var">$count </span>* <span class="src-sym">(</span><span class="src-var">$count</span>+<span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-sym">((</span><span class="src-var">$count</span>-<span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$count</span>-<span class="src-num">2</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$count</span>-<span class="src-num">3</span><span class="src-sym">))) </span>- <span class="src-sym">(</span><span class="src-num">3 </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$count</span>-<span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">) </span>/ <span class="src-sym">((</span><span class="src-var">$count</span>-<span class="src-num">2</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$count</span>-<span class="src-num">3</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a3551"></a>            <span class="src-sym">}</span></li>
<li><a name="a3552"></a>        <span class="src-sym">}</span></li>
<li><a name="a3553"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3554"></a>    <span class="src-sym">}</span></li>
<li><a name="a3555"></a>&nbsp;</li>
<li><a name="a3556"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3557"></a><span class="src-doc">     * RAND</span></li>
<li><a name="a3558"></a><span class="src-doc">     *</span></li>
<li><a name="a3559"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$min </span><span class="src-doc">   Minimal value</span></li>
<li><a name="a3560"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$max </span><span class="src-doc">   Maximal value</span></li>
<li><a name="a3561"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Random number</span></li>
<li><a name="a3562"></a><span class="src-doc">     */</span></li>
<li><a name="a3563"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">RAND</span><span class="src-sym">(</span><span class="src-var">$min </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$max </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3564"></a>        <span class="src-var">$min        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$min</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3565"></a>        <span class="src-var">$max        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$max</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3566"></a>&nbsp;</li>
<li><a name="a3567"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$min </span>== <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$max </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3568"></a>            <span class="src-key">return </span><span class="src-sym">(</span><a href="http://www.php.net/rand">rand</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">10000000</span><span class="src-sym">)) </span>/ <span class="src-num">10000000</span><span class="src-sym">;</span></li>
<li><a name="a3569"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3570"></a>            <span class="src-key">return </span><a href="http://www.php.net/rand">rand</a><span class="src-sym">(</span><span class="src-var">$min</span><span class="src-sym">, </span><span class="src-var">$max</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3571"></a>        <span class="src-sym">}</span></li>
<li><a name="a3572"></a>    <span class="src-sym">}</span></li>
<li><a name="a3573"></a>&nbsp;</li>
<li><a name="a3574"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3575"></a><span class="src-doc">     * MOD</span></li>
<li><a name="a3576"></a><span class="src-doc">     *</span></li>
<li><a name="a3577"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$a </span><span class="src-doc">       Dividend</span></li>
<li><a name="a3578"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$b </span><span class="src-doc">       Divisor</span></li>
<li><a name="a3579"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Remainder</span></li>
<li><a name="a3580"></a><span class="src-doc">     */</span></li>
<li><a name="a3581"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMOD">MOD</a><span class="src-sym">(</span><span class="src-var">$a </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$b </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3582"></a>        <span class="src-var">$a        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3583"></a>        <span class="src-var">$b        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3584"></a>&nbsp;</li>
<li><a name="a3585"></a>        <span class="src-key">return </span><span class="src-var">$a </span>% <span class="src-var">$b</span><span class="src-sym">;</span></li>
<li><a name="a3586"></a>    <span class="src-sym">}</span></li>
<li><a name="a3587"></a>&nbsp;</li>
<li><a name="a3588"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3589"></a><span class="src-doc">     * ASCIICODE</span></li>
<li><a name="a3590"></a><span class="src-doc">     *</span></li>
<li><a name="a3591"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$character </span><span class="src-doc">   Value</span></li>
<li><a name="a3592"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a3593"></a><span class="src-doc">     */</span></li>
<li><a name="a3594"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodASCIICODE">ASCIICODE</a><span class="src-sym">(</span><span class="src-var">$characters</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3595"></a>        <span class="src-var">$characters    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$characters</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3596"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$characters</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3597"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3598"></a>                <span class="src-var">$characters </span>= (int) <span class="src-var">$characters</span><span class="src-sym">;</span></li>
<li><a name="a3599"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3600"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$characters</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3601"></a>                    <span class="src-var">$characters </span>= <span class="src-str">'True'</span><span class="src-sym">;</span></li>
<li><a name="a3602"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3603"></a>                    <span class="src-var">$characters </span>= <span class="src-str">'False'</span><span class="src-sym">;</span></li>
<li><a name="a3604"></a>                <span class="src-sym">}</span></li>
<li><a name="a3605"></a>            <span class="src-sym">}</span></li>
<li><a name="a3606"></a>        <span class="src-sym">}</span></li>
<li><a name="a3607"></a>&nbsp;</li>
<li><a name="a3608"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$characters</span><span class="src-sym">) </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3609"></a>            <span class="src-key">return </span><a href="http://www.php.net/ord">ord</a><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$characters</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3610"></a>        <span class="src-sym">}</span></li>
<li><a name="a3611"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3612"></a>    <span class="src-sym">}</span></li>
<li><a name="a3613"></a>&nbsp;</li>
<li><a name="a3614"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3615"></a><span class="src-doc">     * CONCATENATE</span></li>
<li><a name="a3616"></a><span class="src-doc">     *</span></li>
<li><a name="a3617"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a3618"></a><span class="src-doc">     */</span></li>
<li><a name="a3619"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">CONCATENATE</span><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3620"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a3621"></a>        <span class="src-var">$returnValue </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a3622"></a>&nbsp;</li>
<li><a name="a3623"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a3624"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3625"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$aArgs </span><span class="src-key">as </span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3626"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3627"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3628"></a>                    <span class="src-var">$arg </span>= (int) <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a3629"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3630"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$arg</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3631"></a>                        <span class="src-var">$arg </span>= <span class="src-str">'TRUE'</span><span class="src-sym">;</span></li>
<li><a name="a3632"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3633"></a>                        <span class="src-var">$arg </span>= <span class="src-str">'FALSE'</span><span class="src-sym">;</span></li>
<li><a name="a3634"></a>                    <span class="src-sym">}</span></li>
<li><a name="a3635"></a>                <span class="src-sym">}</span></li>
<li><a name="a3636"></a>            <span class="src-sym">}</span></li>
<li><a name="a3637"></a>            <span class="src-var">$returnValue </span>.= <span class="src-var">$arg</span><span class="src-sym">;</span></li>
<li><a name="a3638"></a>        <span class="src-sym">}</span></li>
<li><a name="a3639"></a>&nbsp;</li>
<li><a name="a3640"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a3641"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a3642"></a>    <span class="src-sym">}</span></li>
<li><a name="a3643"></a>&nbsp;</li>
<li><a name="a3644"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3645"></a><span class="src-doc">     * SEARCHSENSITIVE</span></li>
<li><a name="a3646"></a><span class="src-doc">     *</span></li>
<li><a name="a3647"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$needle </span><span class="src-doc">       The string to look for</span></li>
<li><a name="a3648"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$haystack </span><span class="src-doc">   The string in which to look</span></li>
<li><a name="a3649"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$offset </span><span class="src-doc">       Offset within $haystack</span></li>
<li><a name="a3650"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a3651"></a><span class="src-doc">     */</span></li>
<li><a name="a3652"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSEARCHSENSITIVE">SEARCHSENSITIVE</a><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">,</span><span class="src-var">$haystack</span><span class="src-sym">,</span><span class="src-var">$offset</span>=<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3653"></a>        <span class="src-var">$needle        </span>= (string) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3654"></a>        <span class="src-var">$haystack    </span>= (string) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3655"></a>        <span class="src-var">$offset        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$offset</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3656"></a>&nbsp;</li>
<li><a name="a3657"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$offset </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">) </span>&gt; <span class="src-var">$offset</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3658"></a>            <span class="src-var">$pos </span>= <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">, </span><span class="src-var">$needle</span><span class="src-sym">, </span>--<span class="src-var">$offset</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3659"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pos </span>!== <span class="src-id">false</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3660"></a>                <span class="src-key">return </span>++<span class="src-var">$pos</span><span class="src-sym">;</span></li>
<li><a name="a3661"></a>            <span class="src-sym">}</span></li>
<li><a name="a3662"></a>        <span class="src-sym">}</span></li>
<li><a name="a3663"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3664"></a>    <span class="src-sym">}</span></li>
<li><a name="a3665"></a>&nbsp;</li>
<li><a name="a3666"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3667"></a><span class="src-doc">     * SEARCHINSENSITIVE</span></li>
<li><a name="a3668"></a><span class="src-doc">     *</span></li>
<li><a name="a3669"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$needle </span><span class="src-doc">       The string to look for</span></li>
<li><a name="a3670"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$haystack </span><span class="src-doc">   The string in which to look</span></li>
<li><a name="a3671"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$offset </span><span class="src-doc">       Offset within $haystack</span></li>
<li><a name="a3672"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a3673"></a><span class="src-doc">     */</span></li>
<li><a name="a3674"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">SEARCHINSENSITIVE</span><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">,</span><span class="src-var">$haystack</span><span class="src-sym">,</span><span class="src-var">$offset</span>=<span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3675"></a>        <span class="src-var">$needle        </span>= (string) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3676"></a>        <span class="src-var">$haystack    </span>= (string) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3677"></a>        <span class="src-var">$offset        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$offset</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3678"></a>&nbsp;</li>
<li><a name="a3679"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$offset </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">) </span>&gt; <span class="src-var">$offset</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3680"></a>            <span class="src-var">$pos </span>= <a href="http://www.php.net/stripos">stripos</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">, </span><span class="src-var">$needle</span><span class="src-sym">, </span>--<span class="src-var">$offset</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3681"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pos </span>!== <span class="src-id">false</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3682"></a>                <span class="src-key">return </span>++<span class="src-var">$pos</span><span class="src-sym">;</span></li>
<li><a name="a3683"></a>            <span class="src-sym">}</span></li>
<li><a name="a3684"></a>        <span class="src-sym">}</span></li>
<li><a name="a3685"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3686"></a>    <span class="src-sym">}</span></li>
<li><a name="a3687"></a>&nbsp;</li>
<li><a name="a3688"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3689"></a><span class="src-doc">     * LEFT</span></li>
<li><a name="a3690"></a><span class="src-doc">     *</span></li>
<li><a name="a3691"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value</span></li>
<li><a name="a3692"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$chars </span><span class="src-doc">   Number of characters</span></li>
<li><a name="a3693"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a3694"></a><span class="src-doc">     */</span></li>
<li><a name="a3695"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">LEFT</span><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$chars </span>= <span class="src-id">null</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3696"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3697"></a>        <span class="src-var">$chars        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$chars</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3698"></a>&nbsp;</li>
<li><a name="a3699"></a>        <span class="src-key">return </span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$chars</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3700"></a>    <span class="src-sym">}</span></li>
<li><a name="a3701"></a>&nbsp;</li>
<li><a name="a3702"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3703"></a><span class="src-doc">     * RIGHT</span></li>
<li><a name="a3704"></a><span class="src-doc">     *</span></li>
<li><a name="a3705"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value</span></li>
<li><a name="a3706"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$chars </span><span class="src-doc">   Number of characters</span></li>
<li><a name="a3707"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a3708"></a><span class="src-doc">     */</span></li>
<li><a name="a3709"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodRIGHT">RIGHT</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$chars </span>= <span class="src-id">null</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3710"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3711"></a>        <span class="src-var">$chars        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$chars</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3712"></a>&nbsp;</li>
<li><a name="a3713"></a>        <span class="src-key">return </span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>- <span class="src-var">$chars</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3714"></a>    <span class="src-sym">}</span></li>
<li><a name="a3715"></a>&nbsp;</li>
<li><a name="a3716"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3717"></a><span class="src-doc">     * MID</span></li>
<li><a name="a3718"></a><span class="src-doc">     *</span></li>
<li><a name="a3719"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value</span></li>
<li><a name="a3720"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$start </span><span class="src-doc">   Start character</span></li>
<li><a name="a3721"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$chars </span><span class="src-doc">   Number of characters</span></li>
<li><a name="a3722"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a3723"></a><span class="src-doc">     */</span></li>
<li><a name="a3724"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMID">MID</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$start </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$chars </span>= <span class="src-id">null</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3725"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3726"></a>        <span class="src-var">$start        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$start</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3727"></a>        <span class="src-var">$chars        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$chars</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3728"></a>&nbsp;</li>
<li><a name="a3729"></a>        <span class="src-key">return </span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span>--<span class="src-var">$start</span><span class="src-sym">, </span><span class="src-var">$chars</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3730"></a>    <span class="src-sym">}</span></li>
<li><a name="a3731"></a>&nbsp;</li>
<li><a name="a3732"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3733"></a><span class="src-doc">     * RETURNSTRING</span></li>
<li><a name="a3734"></a><span class="src-doc">     *</span></li>
<li><a name="a3735"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3736"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3737"></a><span class="src-doc">     */</span></li>
<li><a name="a3738"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodRETURNSTRING">RETURNSTRING</a><span class="src-sym">(</span><span class="src-var">$testValue </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3739"></a>        <span class="src-var">$testValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$testValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3740"></a>&nbsp;</li>
<li><a name="a3741"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$testValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3742"></a>            <span class="src-key">return </span><span class="src-var">$testValue</span><span class="src-sym">;</span></li>
<li><a name="a3743"></a>        <span class="src-sym">}</span></li>
<li><a name="a3744"></a>        <span class="src-key">return </span><span class="src-id">Null</span><span class="src-sym">;</span></li>
<li><a name="a3745"></a>    <span class="src-sym">}</span></li>
<li><a name="a3746"></a>&nbsp;</li>
<li><a name="a3747"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3748"></a><span class="src-doc">     * TRIMSPACES</span></li>
<li><a name="a3749"></a><span class="src-doc">     *</span></li>
<li><a name="a3750"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3751"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3752"></a><span class="src-doc">     */</span></li>
<li><a name="a3753"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodTRIMSPACES">TRIMSPACES</a><span class="src-sym">(</span><span class="src-var">$stringValue </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3754"></a>        <span class="src-var">$stringValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$stringValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3755"></a>&nbsp;</li>
<li><a name="a3756"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$stringValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3757"></a>            <span class="src-key">return </span><a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$stringValue</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-str">'  '</span><span class="src-sym">,</span><span class="src-str">' '</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3758"></a>        <span class="src-sym">}</span></li>
<li><a name="a3759"></a>        <span class="src-key">return </span><span class="src-id">Null</span><span class="src-sym">;</span></li>
<li><a name="a3760"></a>    <span class="src-sym">}</span></li>
<li><a name="a3761"></a>&nbsp;</li>
<li><a name="a3762"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3763"></a><span class="src-doc">     * IS_BLANK</span></li>
<li><a name="a3764"></a><span class="src-doc">     *</span></li>
<li><a name="a3765"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3766"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3767"></a><span class="src-doc">     */</span></li>
<li><a name="a3768"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodIS_BLANK">IS_BLANK</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3769"></a>        <span class="src-var">$value    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3770"></a>&nbsp;</li>
<li><a name="a3771"></a>        <span class="src-key">return </span><span class="src-sym">(</span><a href="http://www.php.net/is_null">is_null</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$value </span>== <span class="src-str">''</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a3772"></a>    <span class="src-sym">}</span></li>
<li><a name="a3773"></a>&nbsp;</li>
<li><a name="a3774"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3775"></a><span class="src-doc">     * IS_ERR</span></li>
<li><a name="a3776"></a><span class="src-doc">     *</span></li>
<li><a name="a3777"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3778"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3779"></a><span class="src-doc">     */</span></li>
<li><a name="a3780"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodIS_ERR">IS_ERR</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3781"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3782"></a>&nbsp;</li>
<li><a name="a3783"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">IS_ERROR</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">IS_NA</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3784"></a>    <span class="src-sym">}</span></li>
<li><a name="a3785"></a>&nbsp;</li>
<li><a name="a3786"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3787"></a><span class="src-doc">     * IS_ERROR</span></li>
<li><a name="a3788"></a><span class="src-doc">     *</span></li>
<li><a name="a3789"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3790"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3791"></a><span class="src-doc">     */</span></li>
<li><a name="a3792"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodIS_ERROR">IS_ERROR</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3793"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3794"></a>&nbsp;</li>
<li><a name="a3795"></a>        <span class="src-key">return </span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">, </span><a href="http://www.php.net/array_values">array_values</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3796"></a>    <span class="src-sym">}</span></li>
<li><a name="a3797"></a>&nbsp;</li>
<li><a name="a3798"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3799"></a><span class="src-doc">     * IS_NA</span></li>
<li><a name="a3800"></a><span class="src-doc">     *</span></li>
<li><a name="a3801"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3802"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3803"></a><span class="src-doc">     */</span></li>
<li><a name="a3804"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">IS_NA</span><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3805"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3806"></a>&nbsp;</li>
<li><a name="a3807"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$value </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'na'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3808"></a>    <span class="src-sym">}</span></li>
<li><a name="a3809"></a>&nbsp;</li>
<li><a name="a3810"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3811"></a><span class="src-doc">     * IS_EVEN</span></li>
<li><a name="a3812"></a><span class="src-doc">     *</span></li>
<li><a name="a3813"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">   Value to check</span></li>
<li><a name="a3814"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3815"></a><span class="src-doc">     */</span></li>
<li><a name="a3816"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">IS_EVEN</span><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3817"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3818"></a>&nbsp;</li>
<li><a name="a3819"></a>        <span class="src-key">while </span><span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>!= <span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3820"></a>            <span class="src-var">$value </span>*= <span class="src-num">10</span><span class="src-sym">;</span></li>
<li><a name="a3821"></a>        <span class="src-sym">}</span></li>
<li><a name="a3822"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$value </span>% <span class="src-num">2 </span>== <span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3823"></a>    <span class="src-sym">}</span></li>
<li><a name="a3824"></a>&nbsp;</li>
<li><a name="a3825"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3826"></a><span class="src-doc">     * IS_NUMBER</span></li>
<li><a name="a3827"></a><span class="src-doc">     *</span></li>
<li><a name="a3828"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">       Value to check</span></li>
<li><a name="a3829"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">boolean </span></li>
<li><a name="a3830"></a><span class="src-doc">     */</span></li>
<li><a name="a3831"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodIS_NUMBER">IS_NUMBER</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3832"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3833"></a>&nbsp;</li>
<li><a name="a3834"></a>        <span class="src-key">return </span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3835"></a>    <span class="src-sym">}</span></li>
<li><a name="a3836"></a>&nbsp;</li>
<li><a name="a3837"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3838"></a><span class="src-doc">     * STATEMENT_IF</span></li>
<li><a name="a3839"></a><span class="src-doc">     *</span></li>
<li><a name="a3840"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">       Value to check</span></li>
<li><a name="a3841"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$truepart </span><span class="src-doc">   Value when true</span></li>
<li><a name="a3842"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$falsepart </span><span class="src-doc">   Value when false</span></li>
<li><a name="a3843"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">mixed </span></li>
<li><a name="a3844"></a><span class="src-doc">     */</span></li>
<li><a name="a3845"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTATEMENT_IF">STATEMENT_IF</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$truepart </span>= <span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$falsepart </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3846"></a>        <span class="src-var">$value        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3847"></a>        <span class="src-var">$truepart    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$truepart</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3848"></a>        <span class="src-var">$falsepart    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$falsepart</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3849"></a>&nbsp;</li>
<li><a name="a3850"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$value </span>? <span class="src-var">$truepart </span>: <span class="src-var">$falsepart</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3851"></a>    <span class="src-sym">}</span></li>
<li><a name="a3852"></a>&nbsp;</li>
<li><a name="a3853"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3854"></a><span class="src-doc">     * STATEMENT_IFERROR</span></li>
<li><a name="a3855"></a><span class="src-doc">     *</span></li>
<li><a name="a3856"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">       Value to check , is also value when no error</span></li>
<li><a name="a3857"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$errorpart </span><span class="src-doc">   Value when error</span></li>
<li><a name="a3858"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">mixed </span></li>
<li><a name="a3859"></a><span class="src-doc">     */</span></li>
<li><a name="a3860"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSTATEMENT_IFERROR">STATEMENT_IFERROR</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">, </span><span class="src-var">$errorpart </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3861"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">STATEMENT_IF</span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">IS_ERROR</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$errorpart</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3862"></a>    <span class="src-sym">}</span></li>
<li><a name="a3863"></a>&nbsp;</li>
<li><a name="a3864"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3865"></a><span class="src-doc">     * VERSION</span></li>
<li><a name="a3866"></a><span class="src-doc">     *</span></li>
<li><a name="a3867"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span><span class="src-doc">   Version information</span></li>
<li><a name="a3868"></a><span class="src-doc">     */</span></li>
<li><a name="a3869"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodVERSION">VERSION</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3870"></a>        <span class="src-key">return </span><span class="src-str">'PHPExcel 1.5.5, 2007-12-24'</span><span class="src-sym">;</span></li>
<li><a name="a3871"></a>    <span class="src-sym">}</span></li>
<li><a name="a3872"></a>&nbsp;</li>
<li><a name="a3873"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3874"></a><span class="src-doc">     * DATE</span></li>
<li><a name="a3875"></a><span class="src-doc">     *</span></li>
<li><a name="a3876"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$year </span></li>
<li><a name="a3877"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$month </span></li>
<li><a name="a3878"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$day </span></li>
<li><a name="a3879"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel date serial value</span></li>
<li><a name="a3880"></a><span class="src-doc">     */</span></li>
<li><a name="a3881"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDATE">DATE</a><span class="src-sym">(</span><span class="src-var">$year </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$month </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$day </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3882"></a>        <span class="src-var">$year    </span>= (integer) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3883"></a>        <span class="src-var">$month    </span>= (integer) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$month</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3884"></a>        <span class="src-var">$day    </span>= (integer) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$day</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3885"></a>&nbsp;</li>
<li><a name="a3886"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a3887"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$year </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$year </span>&gt;= <span class="src-num">10000</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3888"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3889"></a>        <span class="src-sym">}</span></li>
<li><a name="a3890"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year </span>&lt; <span class="src-num">1900</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3891"></a>            <span class="src-var">$year </span>+= <span class="src-num">1900</span><span class="src-sym">;</span></li>
<li><a name="a3892"></a>        <span class="src-sym">}</span></li>
<li><a name="a3893"></a>&nbsp;</li>
<li><a name="a3894"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$month </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$month </span>&gt; <span class="src-num">12</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3895"></a>            <span class="src-var">$year </span>+= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$month </span>/ <span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3896"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$month </span>&gt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3897"></a>                <span class="src-var">$month </span>= <span class="src-var">$month </span>% <span class="src-num">12</span><span class="src-sym">;</span></li>
<li><a name="a3898"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3899"></a>                <span class="src-var">$month </span>= <span class="src-num">12 </span>- <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$month </span>% <span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3900"></a>            <span class="src-sym">}</span></li>
<li><a name="a3901"></a>        <span class="src-sym">}</span></li>
<li><a name="a3902"></a>&nbsp;</li>
<li><a name="a3903"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a3904"></a>        <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodFormattedPHPToExcel">FormattedPHPToExcel</a><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">, </span><span class="src-var">$month</span><span class="src-sym">, </span><span class="src-var">$day</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3905"></a>    <span class="src-sym">}</span></li>
<li><a name="a3906"></a>&nbsp;</li>
<li><a name="a3907"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3908"></a><span class="src-doc">     * TIME</span></li>
<li><a name="a3909"></a><span class="src-doc">     *</span></li>
<li><a name="a3910"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$hour </span></li>
<li><a name="a3911"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$minute </span></li>
<li><a name="a3912"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$second </span></li>
<li><a name="a3913"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel time serial value</span></li>
<li><a name="a3914"></a><span class="src-doc">     */</span></li>
<li><a name="a3915"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodTIME">TIME</a><span class="src-sym">(</span><span class="src-var">$hour </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$minute </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$second </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3916"></a>        <span class="src-var">$hour    </span>= (integer) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$hour</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3917"></a>        <span class="src-var">$minute    </span>= (integer) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$minute</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3918"></a>        <span class="src-var">$second    </span>= (integer) <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$second</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3919"></a>&nbsp;</li>
<li><a name="a3920"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a3921"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$hour </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$minute </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$second </span>&lt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3922"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3923"></a>        <span class="src-sym">}</span></li>
<li><a name="a3924"></a>&nbsp;</li>
<li><a name="a3925"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$second </span>&gt;= <span class="src-num">60</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3926"></a>            <span class="src-var">$minute </span>+= <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$second </span>/ <span class="src-num">60</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3927"></a>            <span class="src-var">$second </span>= <span class="src-var">$second </span>% <span class="src-num">60</span><span class="src-sym">;</span></li>
<li><a name="a3928"></a>        <span class="src-sym">}</span></li>
<li><a name="a3929"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$minute </span>&gt;= <span class="src-num">60</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3930"></a>            <span class="src-var">$hour </span>+= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$minute </span>/ <span class="src-num">60</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3931"></a>            <span class="src-var">$minute </span>= <span class="src-var">$minute </span>% <span class="src-num">60</span><span class="src-sym">;</span></li>
<li><a name="a3932"></a>        <span class="src-sym">}</span></li>
<li><a name="a3933"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$hour </span>&gt;= <span class="src-num">24</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3934"></a>            <span class="src-var">$hour </span>= <span class="src-var">$hour </span>% <span class="src-num">24</span><span class="src-sym">;</span></li>
<li><a name="a3935"></a>        <span class="src-sym">}</span></li>
<li><a name="a3936"></a>&nbsp;</li>
<li><a name="a3937"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a3938"></a>        <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodFormattedPHPToExcel">FormattedPHPToExcel</a><span class="src-sym">(</span><span class="src-num">1900</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$hour</span><span class="src-sym">, </span><span class="src-var">$minute</span><span class="src-sym">, </span><span class="src-var">$second</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3939"></a>    <span class="src-sym">}</span></li>
<li><a name="a3940"></a>&nbsp;</li>
<li><a name="a3941"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3942"></a><span class="src-doc">     * DATEVALUE</span></li>
<li><a name="a3943"></a><span class="src-doc">     *</span></li>
<li><a name="a3944"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span></li>
<li><a name="a3945"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel date serial value</span></li>
<li><a name="a3946"></a><span class="src-doc">     */</span></li>
<li><a name="a3947"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDATEVALUE">DATEVALUE</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3948"></a>        <span class="src-var">$dateValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3949"></a>&nbsp;</li>
<li><a name="a3950"></a>        <span class="src-var">$PHPDateArray </span>= <a href="http://www.php.net/date_parse">date_parse</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3951"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$PHPDateArray </span>=== <span class="src-id">False</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'error_count'</span><span class="src-sym">] </span>&gt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3952"></a>            <span class="src-var">$testVal1 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">,</span><span class="src-str">'/-'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3953"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$testVal1 </span>!== <span class="src-id">False</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3954"></a>                <span class="src-var">$testVal2 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'/-'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3955"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$testVal2 </span>!== <span class="src-id">False</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3956"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$testVal1</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$testVal2</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a3957"></a>                        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$testVal1 </span>== <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$testVal2</span><span class="src-sym">,</span>-<span class="src-num">1</span><span class="src-sym">) </span>== <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3958"></a>                            <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">] </span>= <span class="src-var">$testVal2</span><span class="src-sym">;</span></li>
<li><a name="a3959"></a>                            <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">] </span>= <span class="src-var">$testVal1</span><span class="src-sym">;</span></li>
<li><a name="a3960"></a>                            <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'error_count'</span><span class="src-sym">]</span>--<span class="src-sym">;</span></li>
<li><a name="a3961"></a>                        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><span class="src-var">$testVal2 </span>== <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$testVal1</span><span class="src-sym">,</span>-<span class="src-num">1</span><span class="src-sym">) </span>== <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3962"></a>                            <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">] </span>= <span class="src-var">$testVal1</span><span class="src-sym">;</span></li>
<li><a name="a3963"></a>                            <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">] </span>= <span class="src-var">$testVal2</span><span class="src-sym">;</span></li>
<li><a name="a3964"></a>                            <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'error_count'</span><span class="src-sym">]</span>--<span class="src-sym">;</span></li>
<li><a name="a3965"></a>                        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3966"></a>                            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3967"></a>                        <span class="src-sym">}</span></li>
<li><a name="a3968"></a>                    <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3969"></a>                        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3970"></a>                    <span class="src-sym">}</span></li>
<li><a name="a3971"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3972"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3973"></a>                <span class="src-sym">}</span></li>
<li><a name="a3974"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a3975"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3976"></a>            <span class="src-sym">}</span></li>
<li><a name="a3977"></a>        <span class="src-sym">}</span></li>
<li><a name="a3978"></a>&nbsp;</li>
<li><a name="a3979"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$PHPDateArray </span>!== <span class="src-id">False</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'error_count'</span><span class="src-sym">] </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a3980"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">] </span>== <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3981"></a>                <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">] </span>= <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-str">'%Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3982"></a>            <span class="src-sym">}</span></li>
<li><a name="a3983"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">] </span>== <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3984"></a>                <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">] </span>= <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-str">'%m'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3985"></a>            <span class="src-sym">}</span></li>
<li><a name="a3986"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">] </span>== <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a3987"></a>                <span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">] </span>= <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-str">'%d'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3988"></a>            <span class="src-sym">}</span></li>
<li><a name="a3989"></a>            <span class="src-key">return </span><a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodFormattedPHPToExcel">FormattedPHPToExcel</a><span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'hour'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'minute'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'second'</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3990"></a>        <span class="src-sym">}</span></li>
<li><a name="a3991"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3992"></a>    <span class="src-sym">}</span></li>
<li><a name="a3993"></a>&nbsp;</li>
<li><a name="a3994"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3995"></a><span class="src-doc">     * TIMEVALUE</span></li>
<li><a name="a3996"></a><span class="src-doc">     *</span></li>
<li><a name="a3997"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$timeValue </span></li>
<li><a name="a3998"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel time serial value</span></li>
<li><a name="a3999"></a><span class="src-doc">     */</span></li>
<li><a name="a4000"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">TIMEVALUE</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4001"></a>        <span class="src-var">$timeValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4002"></a>&nbsp;</li>
<li><a name="a4003"></a>        <span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$PHPDateArray </span>= <a href="http://www.php.net/date_parse">date_parse</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span>!== <span class="src-id">False</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'error_count'</span><span class="src-sym">] </span>== <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4004"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4005"></a>                <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodFormattedPHPToExcel">FormattedPHPToExcel</a><span class="src-sym">(</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'hour'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'minute'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'second'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4006"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4007"></a>                <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodFormattedPHPToExcel">FormattedPHPToExcel</a><span class="src-sym">(</span><span class="src-num">1900</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'hour'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'minute'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$PHPDateArray</span><span class="src-sym">[</span><span class="src-str">'second'</span><span class="src-sym">]</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4008"></a>            <span class="src-sym">}</span></li>
<li><a name="a4009"></a>        <span class="src-sym">}</span></li>
<li><a name="a4010"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4011"></a>    <span class="src-sym">}</span></li>
<li><a name="a4012"></a>&nbsp;</li>
<li><a name="a4013"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4014"></a><span class="src-doc">     * DATETIMENOW</span></li>
<li><a name="a4015"></a><span class="src-doc">     *</span></li>
<li><a name="a4016"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel date/time serial value</span></li>
<li><a name="a4017"></a><span class="src-doc">     */</span></li>
<li><a name="a4018"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">DATETIMENOW</span><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4019"></a>        <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodPHPToExcel">PHPToExcel</a><span class="src-sym">(</span><a href="http://www.php.net/time">time</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4020"></a>    <span class="src-sym">}</span></li>
<li><a name="a4021"></a>&nbsp;</li>
<li><a name="a4022"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4023"></a><span class="src-doc">     * DATENOW</span></li>
<li><a name="a4024"></a><span class="src-doc">     *</span></li>
<li><a name="a4025"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel date/time serial value</span></li>
<li><a name="a4026"></a><span class="src-doc">     */</span></li>
<li><a name="a4027"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDATENOW">DATENOW</a><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4028"></a>        <span class="src-key">return </span><a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodPHPToExcel">PHPToExcel</a><span class="src-sym">(</span><a href="http://www.php.net/time">time</a><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a4029"></a>    <span class="src-sym">}</span></li>
<li><a name="a4030"></a>&nbsp;</li>
<li><a name="a4031"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodisLeapYear">isLeapYear</a><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4032"></a>        <span class="src-key">return </span><span class="src-sym">(((</span><span class="src-var">$year </span>% <span class="src-num">4</span><span class="src-sym">) </span>== <span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">((</span><span class="src-var">$year </span>% <span class="src-num">100</span><span class="src-sym">) </span>!= <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">((</span><span class="src-var">$year </span>% <span class="src-num">400</span><span class="src-sym">) </span>== <span class="src-num">0</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4033"></a>    <span class="src-sym">}</span></li>
<li><a name="a4034"></a>&nbsp;</li>
<li><a name="a4035"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methoddateDiff360">dateDiff360</a><span class="src-sym">(</span><span class="src-var">$startDay</span><span class="src-sym">, </span><span class="src-var">$startMonth</span><span class="src-sym">, </span><span class="src-var">$startYear</span><span class="src-sym">, </span><span class="src-var">$endDay</span><span class="src-sym">, </span><span class="src-var">$endMonth</span><span class="src-sym">, </span><span class="src-var">$endYear</span><span class="src-sym">, </span><span class="src-var">$methodUS</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4036"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$startDay </span>== <span class="src-num">31</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4037"></a>            <span class="src-var">$startDay</span>--<span class="src-sym">;</span></li>
<li><a name="a4038"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$methodUS </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$startMonth </span>== <span class="src-num">2 </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$startDay </span>== <span class="src-num">29 </span>|| <span class="src-sym">(</span><span class="src-var">$startDay </span>== <span class="src-num">28 </span>&amp;&amp; <span class="src-sym">!</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">isLeapYear</span><span class="src-sym">(</span><span class="src-var">$startYear</span><span class="src-sym">))))) </span><span class="src-sym">{</span></li>
<li><a name="a4039"></a>            <span class="src-var">$startDay </span>= <span class="src-num">30</span><span class="src-sym">;</span></li>
<li><a name="a4040"></a>        <span class="src-sym">}</span></li>
<li><a name="a4041"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endDay </span>== <span class="src-num">31</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4042"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$methodUS </span>&amp;&amp; <span class="src-var">$startDay </span>!= <span class="src-num">30</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4043"></a>                <span class="src-var">$endDay </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4044"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endMonth </span>== <span class="src-num">12</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4045"></a>                    <span class="src-var">$endYear</span>++<span class="src-sym">;</span></li>
<li><a name="a4046"></a>                    <span class="src-var">$endMonth </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4047"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4048"></a>                    <span class="src-var">$endMonth</span>++<span class="src-sym">;</span></li>
<li><a name="a4049"></a>                <span class="src-sym">}</span></li>
<li><a name="a4050"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4051"></a>                <span class="src-var">$endDay </span>= <span class="src-num">30</span><span class="src-sym">;</span></li>
<li><a name="a4052"></a>            <span class="src-sym">}</span></li>
<li><a name="a4053"></a>        <span class="src-sym">}</span></li>
<li><a name="a4054"></a>&nbsp;</li>
<li><a name="a4055"></a>        <span class="src-key">return </span><span class="src-var">$endDay </span>+ <span class="src-var">$endMonth </span>* <span class="src-num">30 </span>+ <span class="src-var">$endYear </span>* <span class="src-num">360 </span>- <span class="src-var">$startDay </span>- <span class="src-var">$startMonth </span>* <span class="src-num">30 </span>- <span class="src-var">$startYear </span>* <span class="src-num">360</span><span class="src-sym">;</span></li>
<li><a name="a4056"></a>    <span class="src-sym">}</span></li>
<li><a name="a4057"></a>&nbsp;</li>
<li><a name="a4058"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4059"></a><span class="src-doc">     * DAYS360</span></li>
<li><a name="a4060"></a><span class="src-doc">     *</span></li>
<li><a name="a4061"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$startDate </span><span class="src-doc">       Excel date serial value</span></li>
<li><a name="a4062"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$endDate </span><span class="src-doc">       Excel date serial value</span></li>
<li><a name="a4063"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">   </span><span class="src-doc-var">$method </span><span class="src-doc">           US or European Method</span></li>
<li><a name="a4064"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   PHP date/time serial</span></li>
<li><a name="a4065"></a><span class="src-doc">     */</span></li>
<li><a name="a4066"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDAYS360">DAYS360</a><span class="src-sym">(</span><span class="src-var">$startDate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$endDate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$method </span>= <span class="src-id">false</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4067"></a>        <span class="src-var">$startDate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4068"></a>        <span class="src-var">$endDate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4069"></a>&nbsp;</li>
<li><a name="a4070"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4071"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4072"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4073"></a>            <span class="src-sym">}</span></li>
<li><a name="a4074"></a>            <span class="src-var">$startDate </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4075"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4076"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4077"></a>            <span class="src-sym">}</span></li>
<li><a name="a4078"></a>        <span class="src-sym">}</span></li>
<li><a name="a4079"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4080"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4081"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4082"></a>            <span class="src-sym">}</span></li>
<li><a name="a4083"></a>            <span class="src-var">$endDate </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4084"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4085"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4086"></a>            <span class="src-sym">}</span></li>
<li><a name="a4087"></a>        <span class="src-sym">}</span></li>
<li><a name="a4088"></a>&nbsp;</li>
<li><a name="a4089"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4090"></a>        <span class="src-var">$PHPStartDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4091"></a>        <span class="src-var">$startDay </span>= <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'j'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4092"></a>        <span class="src-var">$startMonth </span>= <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'n'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4093"></a>        <span class="src-var">$startYear </span>= <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4094"></a>&nbsp;</li>
<li><a name="a4095"></a>        <span class="src-var">$PHPEndDateObject </span>= <span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodExcelToPHPObject">ExcelToPHPObject</a><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4096"></a>        <span class="src-var">$endDay </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'j'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4097"></a>        <span class="src-var">$endMonth </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'n'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4098"></a>        <span class="src-var">$endYear </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4099"></a>&nbsp;</li>
<li><a name="a4100"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">dateDiff360</span><span class="src-sym">(</span><span class="src-var">$startDay</span><span class="src-sym">, </span><span class="src-var">$startMonth</span><span class="src-sym">, </span><span class="src-var">$startYear</span><span class="src-sym">, </span><span class="src-var">$endDay</span><span class="src-sym">, </span><span class="src-var">$endMonth</span><span class="src-sym">, </span><span class="src-var">$endYear</span><span class="src-sym">, </span><span class="src-sym">!</span><span class="src-var">$method</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4101"></a>    <span class="src-sym">}</span></li>
<li><a name="a4102"></a>&nbsp;</li>
<li><a name="a4103"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4104"></a><span class="src-doc">     * DATEDIF</span></li>
<li><a name="a4105"></a><span class="src-doc">     *</span></li>
<li><a name="a4106"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$startDate </span><span class="src-doc">       Excel date serial value</span></li>
<li><a name="a4107"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$endDate </span><span class="src-doc">       Excel date serial value</span></li>
<li><a name="a4108"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$unit </span></li>
<li><a name="a4109"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Interval between the dates</span></li>
<li><a name="a4110"></a><span class="src-doc">     */</span></li>
<li><a name="a4111"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDATEDIF">DATEDIF</a><span class="src-sym">(</span><span class="src-var">$startDate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$endDate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$unit </span>= <span class="src-str">'D'</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4112"></a>        <span class="src-var">$startDate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4113"></a>        <span class="src-var">$endDate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4114"></a>        <span class="src-var">$unit        </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$unit</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4115"></a>&nbsp;</li>
<li><a name="a4116"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4117"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4118"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4119"></a>            <span class="src-sym">}</span></li>
<li><a name="a4120"></a>            <span class="src-var">$startDate </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4121"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4122"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4123"></a>            <span class="src-sym">}</span></li>
<li><a name="a4124"></a>        <span class="src-sym">}</span></li>
<li><a name="a4125"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4126"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4127"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4128"></a>            <span class="src-sym">}</span></li>
<li><a name="a4129"></a>            <span class="src-var">$endDate </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4130"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4131"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4132"></a>            <span class="src-sym">}</span></li>
<li><a name="a4133"></a>        <span class="src-sym">}</span></li>
<li><a name="a4134"></a>&nbsp;</li>
<li><a name="a4135"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a4136"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$startDate </span>&gt;= <span class="src-var">$endDate</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4137"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4138"></a>        <span class="src-sym">}</span></li>
<li><a name="a4139"></a>&nbsp;</li>
<li><a name="a4140"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4141"></a>        <span class="src-var">$difference </span>= <span class="src-var">$endDate </span>- <span class="src-var">$startDate</span><span class="src-sym">;</span></li>
<li><a name="a4142"></a>&nbsp;</li>
<li><a name="a4143"></a>        <span class="src-var">$PHPStartDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$startDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4144"></a>        <span class="src-var">$startDays </span>= <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'j'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4145"></a>        <span class="src-var">$startMonths </span>= <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'n'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4146"></a>        <span class="src-var">$startYears </span>= <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4147"></a>&nbsp;</li>
<li><a name="a4148"></a>        <span class="src-var">$PHPEndDateObject </span>= <span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodExcelToPHPObject">ExcelToPHPObject</a><span class="src-sym">(</span><span class="src-var">$endDate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4149"></a>        <span class="src-var">$endDays </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'j'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4150"></a>        <span class="src-var">$endMonths </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'n'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4151"></a>        <span class="src-var">$endYears </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4152"></a>&nbsp;</li>
<li><a name="a4153"></a>        <span class="src-var">$retVal </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4154"></a>        <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$unit</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4155"></a>            <span class="src-key">case </span><span class="src-str">'D'</span>:</li>
<li><a name="a4156"></a>                <span class="src-var">$retVal </span>= <span class="src-id">intval</span><span class="src-sym">(</span><span class="src-var">$difference</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4157"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4158"></a>            <span class="src-key">case </span><span class="src-str">'M'</span>:</li>
<li><a name="a4159"></a>                <span class="src-var">$retVal </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$endMonths </span>- <span class="src-var">$startMonths</span><span class="src-sym">) </span>+ <span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$endYears </span>- <span class="src-var">$startYears</span><span class="src-sym">) </span>* <span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4160"></a>                <span class="src-comm">//    We're only interested in full months</span></li>
<li><a name="a4161"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endDays </span>&lt; <span class="src-var">$startDays</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4162"></a>                    <span class="src-var">$retVal</span>--<span class="src-sym">;</span></li>
<li><a name="a4163"></a>                <span class="src-sym">}</span></li>
<li><a name="a4164"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4165"></a>            <span class="src-key">case </span><span class="src-str">'Y'</span>:</li>
<li><a name="a4166"></a>                <span class="src-var">$retVal </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$endYears </span>- <span class="src-var">$startYears</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4167"></a>                <span class="src-comm">//    We're only interested in full months</span></li>
<li><a name="a4168"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endMonths </span>&lt; <span class="src-var">$startMonths</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4169"></a>                    <span class="src-var">$retVal</span>--<span class="src-sym">;</span></li>
<li><a name="a4170"></a>                <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><span class="src-var">$endMonths </span>== <span class="src-var">$startMonths</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$endDays </span>&lt; <span class="src-var">$startDays</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4171"></a>                    <span class="src-var">$retVal</span>--<span class="src-sym">;</span></li>
<li><a name="a4172"></a>                <span class="src-sym">}</span></li>
<li><a name="a4173"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4174"></a>            <span class="src-key">case </span><span class="src-str">'MD'</span>:</li>
<li><a name="a4175"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endDays </span>&lt; <span class="src-var">$startDays</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4176"></a>                    <span class="src-var">$retVal </span>= <span class="src-var">$endDays</span><span class="src-sym">;</span></li>
<li><a name="a4177"></a>                    <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">modify</span><span class="src-sym">(</span><span class="src-str">'-'</span>.<span class="src-var">$endDays</span>.<span class="src-str">' days'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4178"></a>                    <span class="src-var">$adjustDays </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'j'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4179"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$adjustDays </span>&gt; <span class="src-var">$startDays</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4180"></a>                        <span class="src-var">$retVal </span>+= <span class="src-sym">(</span><span class="src-var">$adjustDays </span>- <span class="src-var">$startDays</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4181"></a>                    <span class="src-sym">}</span></li>
<li><a name="a4182"></a>                <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4183"></a>                    <span class="src-var">$retVal </span>= <span class="src-var">$endDays </span>- <span class="src-var">$startDays</span><span class="src-sym">;</span></li>
<li><a name="a4184"></a>                <span class="src-sym">}</span></li>
<li><a name="a4185"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4186"></a>            <span class="src-key">case </span><span class="src-str">'YM'</span>:</li>
<li><a name="a4187"></a>                <span class="src-var">$retVal </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$endMonths </span>- <span class="src-var">$startMonths</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4188"></a>                <span class="src-comm">//    We're only interested in full months</span></li>
<li><a name="a4189"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endDays </span>&lt; <span class="src-var">$startDays</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4190"></a>                    <span class="src-var">$retVal</span>--<span class="src-sym">;</span></li>
<li><a name="a4191"></a>                <span class="src-sym">}</span></li>
<li><a name="a4192"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4193"></a>            <span class="src-key">case </span><span class="src-str">'YD'</span>:</li>
<li><a name="a4194"></a>                <span class="src-var">$retVal </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$difference</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4195"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$endYears </span>&gt; <span class="src-var">$startYears</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4196"></a>                    <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$endYears </span>&gt; <span class="src-var">$startYears</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4197"></a>                        <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">modify</span><span class="src-sym">(</span><span class="src-str">'-1 year'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4198"></a>                        <span class="src-var">$endYears </span>= <span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4199"></a>                    <span class="src-sym">}</span></li>
<li><a name="a4200"></a>                    <span class="src-var">$retVal </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$PHPEndDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'z'</span><span class="src-sym">) </span>- <span class="src-var">$PHPStartDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'z'</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4201"></a>                <span class="src-sym">}</span></li>
<li><a name="a4202"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4203"></a>        <span class="src-sym">}</span></li>
<li><a name="a4204"></a>        <span class="src-key">return </span><span class="src-var">$retVal</span><span class="src-sym">;</span></li>
<li><a name="a4205"></a>    <span class="src-sym">}</span></li>
<li><a name="a4206"></a>&nbsp;</li>
<li><a name="a4207"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4208"></a><span class="src-doc">     * DAYOFMONTH</span></li>
<li><a name="a4209"></a><span class="src-doc">     *</span></li>
<li><a name="a4210"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">       Excel date serial value or a standard date string</span></li>
<li><a name="a4211"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Day</span></li>
<li><a name="a4212"></a><span class="src-doc">     */</span></li>
<li><a name="a4213"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDAYOFMONTH">DAYOFMONTH</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4214"></a>        <span class="src-var">$dateValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4215"></a>&nbsp;</li>
<li><a name="a4216"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4217"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4218"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4219"></a>            <span class="src-sym">}</span></li>
<li><a name="a4220"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4221"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4222"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4223"></a>            <span class="src-sym">}</span></li>
<li><a name="a4224"></a>        <span class="src-sym">}</span></li>
<li><a name="a4225"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4226"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4227"></a>        <span class="src-key">return </span><span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'j'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4228"></a>    <span class="src-sym">}</span></li>
<li><a name="a4229"></a>&nbsp;</li>
<li><a name="a4230"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4231"></a><span class="src-doc">     * DAYOFWEEK</span></li>
<li><a name="a4232"></a><span class="src-doc">     *</span></li>
<li><a name="a4233"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">       Excel date serial value or a standard date string</span></li>
<li><a name="a4234"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Day</span></li>
<li><a name="a4235"></a><span class="src-doc">     */</span></li>
<li><a name="a4236"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDAYOFWEEK">DAYOFWEEK</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$style </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4237"></a>        <span class="src-var">$dateValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4238"></a>        <span class="src-var">$style        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$style</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4239"></a>&nbsp;</li>
<li><a name="a4240"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4241"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4242"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4243"></a>            <span class="src-sym">}</span></li>
<li><a name="a4244"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4245"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4246"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4247"></a>            <span class="src-sym">}</span></li>
<li><a name="a4248"></a>        <span class="src-sym">}</span></li>
<li><a name="a4249"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4250"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4251"></a>        <span class="src-var">$DoW </span>= <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'w'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4252"></a>        <span class="src-var">$firstDay </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4253"></a>        <span class="src-key">switch </span><span class="src-sym">(</span><span class="src-var">$style</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4254"></a>            <span class="src-key">case </span><span class="src-num">1</span>: ++<span class="src-var">$DoW</span><span class="src-sym">;</span></li>
<li><a name="a4255"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4256"></a>            <span class="src-key">case </span><span class="src-num">2</span>: <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$DoW </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$DoW </span>= <span class="src-num">7</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a4257"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4258"></a>            <span class="src-key">case </span><span class="src-num">3</span>: <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$DoW </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{ </span><span class="src-var">$DoW </span>= <span class="src-num">7</span><span class="src-sym">; </span><span class="src-sym">}</span></li>
<li><a name="a4259"></a>                    <span class="src-var">$firstDay </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a4260"></a>                    --<span class="src-var">$DoW</span><span class="src-sym">;</span></li>
<li><a name="a4261"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4262"></a>            <span class="src-key">default</span>:</li>
<li><a name="a4263"></a>        <span class="src-sym">}</span></li>
<li><a name="a4264"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_EXCEL</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4265"></a>            <span class="src-comm">//    Test for Excel's 1900 leap year, and introduce the error as required</span></li>
<li><a name="a4266"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">) </span>== <span class="src-num">1900</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'n'</span><span class="src-sym">) </span>&lt;= <span class="src-num">2</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4267"></a>                --<span class="src-var">$DoW</span><span class="src-sym">;</span></li>
<li><a name="a4268"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$DoW </span>&lt; <span class="src-var">$firstDay</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4269"></a>                    <span class="src-var">$DoW </span>+= <span class="src-num">7</span><span class="src-sym">;</span></li>
<li><a name="a4270"></a>                <span class="src-sym">}</span></li>
<li><a name="a4271"></a>            <span class="src-sym">}</span></li>
<li><a name="a4272"></a>        <span class="src-sym">}</span></li>
<li><a name="a4273"></a>        <span class="src-key">return </span><span class="src-var">$DoW</span><span class="src-sym">;</span></li>
<li><a name="a4274"></a>    <span class="src-sym">}</span></li>
<li><a name="a4275"></a>&nbsp;</li>
<li><a name="a4276"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4277"></a><span class="src-doc">     * WEEKOFYEAR</span></li>
<li><a name="a4278"></a><span class="src-doc">     *</span></li>
<li><a name="a4279"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">       Excel date serial value or a standard date string</span></li>
<li><a name="a4280"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">boolean </span><span class="src-doc">   </span><span class="src-doc-var">$method </span><span class="src-doc">           Week begins on Sunday or Monday</span></li>
<li><a name="a4281"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Week Number</span></li>
<li><a name="a4282"></a><span class="src-doc">     */</span></li>
<li><a name="a4283"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodWEEKOFYEAR">WEEKOFYEAR</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$method </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4284"></a>        <span class="src-var">$dateValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4285"></a>        <span class="src-var">$method        </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$method</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4286"></a>&nbsp;</li>
<li><a name="a4287"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$method</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4288"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4289"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">((</span><span class="src-var">$method </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$method </span>&gt; <span class="src-num">2</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4290"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4291"></a>        <span class="src-sym">}</span></li>
<li><a name="a4292"></a>&nbsp;</li>
<li><a name="a4293"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4294"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4295"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4296"></a>            <span class="src-sym">}</span></li>
<li><a name="a4297"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4298"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4299"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4300"></a>            <span class="src-sym">}</span></li>
<li><a name="a4301"></a>        <span class="src-sym">}</span></li>
<li><a name="a4302"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4303"></a>        <span class="src-var">$dayOfYear </span>= <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'z'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4304"></a>        <span class="src-var">$dow </span>= <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'w'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4305"></a>        <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">modify</span><span class="src-sym">(</span><span class="src-str">'-'</span>.<span class="src-var">$dayOfYear</span>.<span class="src-str">' days'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4306"></a>        <span class="src-var">$dow </span>= <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'w'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4307"></a>        <span class="src-var">$daysInFirstWeek </span>= <span class="src-num">7 </span>- <span class="src-sym">((</span><span class="src-var">$dow </span>+ <span class="src-sym">(</span><span class="src-num">2 </span>- <span class="src-var">$method</span><span class="src-sym">)) </span>% <span class="src-num">7</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4308"></a>        <span class="src-var">$dayOfYear </span>-= <span class="src-var">$daysInFirstWeek</span><span class="src-sym">;</span></li>
<li><a name="a4309"></a>        <span class="src-var">$weekOfYear </span>= <a href="http://www.php.net/ceil">ceil</a><span class="src-sym">(</span><span class="src-var">$dayOfYear </span>/ <span class="src-num">7</span><span class="src-sym">) </span>+ <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4310"></a>        <span class="src-key">return </span><span class="src-var">$weekOfYear</span><span class="src-sym">;</span></li>
<li><a name="a4311"></a>    <span class="src-sym">}</span></li>
<li><a name="a4312"></a>&nbsp;</li>
<li><a name="a4313"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4314"></a><span class="src-doc">     * MONTHOFYEAR</span></li>
<li><a name="a4315"></a><span class="src-doc">     *</span></li>
<li><a name="a4316"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">       Excel date serial value or a standard date string</span></li>
<li><a name="a4317"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Month</span></li>
<li><a name="a4318"></a><span class="src-doc">     */</span></li>
<li><a name="a4319"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMONTHOFYEAR">MONTHOFYEAR</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4320"></a>        <span class="src-var">$dateValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4321"></a>&nbsp;</li>
<li><a name="a4322"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4323"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4324"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4325"></a>            <span class="src-sym">}</span></li>
<li><a name="a4326"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4327"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4328"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4329"></a>            <span class="src-sym">}</span></li>
<li><a name="a4330"></a>        <span class="src-sym">}</span></li>
<li><a name="a4331"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4332"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4333"></a>        <span class="src-key">return </span><span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'n'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4334"></a>    <span class="src-sym">}</span></li>
<li><a name="a4335"></a>&nbsp;</li>
<li><a name="a4336"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4337"></a><span class="src-doc">     * YEAR</span></li>
<li><a name="a4338"></a><span class="src-doc">     *</span></li>
<li><a name="a4339"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">       Excel date serial value or a standard date string</span></li>
<li><a name="a4340"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Year</span></li>
<li><a name="a4341"></a><span class="src-doc">     */</span></li>
<li><a name="a4342"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodYEAR">YEAR</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4343"></a>        <span class="src-var">$dateValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4344"></a>&nbsp;</li>
<li><a name="a4345"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4346"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4347"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4348"></a>            <span class="src-sym">}</span></li>
<li><a name="a4349"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4350"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4351"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4352"></a>            <span class="src-sym">}</span></li>
<li><a name="a4353"></a>        <span class="src-sym">}</span></li>
<li><a name="a4354"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4355"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4356"></a>        <span class="src-key">return </span><span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4357"></a>    <span class="src-sym">}</span></li>
<li><a name="a4358"></a>&nbsp;</li>
<li><a name="a4359"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4360"></a><span class="src-doc">     * HOUROFDAY</span></li>
<li><a name="a4361"></a><span class="src-doc">     *</span></li>
<li><a name="a4362"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$timeValue </span><span class="src-doc">       Excel time serial value or a standard time string</span></li>
<li><a name="a4363"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Hour</span></li>
<li><a name="a4364"></a><span class="src-doc">     */</span></li>
<li><a name="a4365"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodHOUROFDAY">HOUROFDAY</a><span class="src-sym">(</span><span class="src-var">$timeValue </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4366"></a>        <span class="src-var">$timeValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4367"></a>&nbsp;</li>
<li><a name="a4368"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4369"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4370"></a>                <span class="src-var">$testVal </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">,</span><span class="src-str">'/-'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4371"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$testVal</span><span class="src-sym">) </span>&lt; <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4372"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4373"></a>                <span class="src-sym">}</span></li>
<li><a name="a4374"></a>            <span class="src-sym">}</span></li>
<li><a name="a4375"></a>            <span class="src-var">$timeValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TIMEVALUE</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4376"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4377"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4378"></a>            <span class="src-sym">}</span></li>
<li><a name="a4379"></a>        <span class="src-sym">}</span></li>
<li><a name="a4380"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4381"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4382"></a>        <span class="src-key">return </span><span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'G'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4383"></a>    <span class="src-sym">}</span></li>
<li><a name="a4384"></a>&nbsp;</li>
<li><a name="a4385"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4386"></a><span class="src-doc">     * MINUTEOFHOUR</span></li>
<li><a name="a4387"></a><span class="src-doc">     *</span></li>
<li><a name="a4388"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$timeValue </span><span class="src-doc">       Excel time serial value or a standard time string</span></li>
<li><a name="a4389"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Minute</span></li>
<li><a name="a4390"></a><span class="src-doc">     */</span></li>
<li><a name="a4391"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodMINUTEOFHOUR">MINUTEOFHOUR</a><span class="src-sym">(</span><span class="src-var">$timeValue </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4392"></a>        <span class="src-var">$timeValue </span>= <span class="src-var">$timeTester    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4393"></a>&nbsp;</li>
<li><a name="a4394"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4395"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4396"></a>                <span class="src-var">$testVal </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">,</span><span class="src-str">'/-'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4397"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$testVal</span><span class="src-sym">) </span>&lt; <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4398"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4399"></a>                <span class="src-sym">}</span></li>
<li><a name="a4400"></a>            <span class="src-sym">}</span></li>
<li><a name="a4401"></a>            <span class="src-var">$timeValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TIMEVALUE</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4402"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4403"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4404"></a>            <span class="src-sym">}</span></li>
<li><a name="a4405"></a>        <span class="src-sym">}</span></li>
<li><a name="a4406"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4407"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4408"></a>        <span class="src-var">$minutes </span>= <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'i'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4409"></a>        <span class="src-var">$seconds </span>+= <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'s'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4410"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$timeTester</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$timeTester</span><span class="src-sym">,</span><span class="src-str">':'</span><span class="src-sym">) </span>&lt; <span class="src-num">2</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4411"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$seconds </span>&gt; <span class="src-num">30</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4412"></a>                <span class="src-var">$minutes</span>++<span class="src-sym">;</span></li>
<li><a name="a4413"></a>            <span class="src-sym">}</span></li>
<li><a name="a4414"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$minutes </span>== <span class="src-num">60</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4415"></a>                <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a4416"></a>            <span class="src-sym">}</span></li>
<li><a name="a4417"></a>        <span class="src-sym">}</span></li>
<li><a name="a4418"></a>        <span class="src-key">return </span><span class="src-var">$minutes</span><span class="src-sym">;</span></li>
<li><a name="a4419"></a>    <span class="src-sym">}</span></li>
<li><a name="a4420"></a>&nbsp;</li>
<li><a name="a4421"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4422"></a><span class="src-doc">     * SECONDOFMINUTE</span></li>
<li><a name="a4423"></a><span class="src-doc">     *</span></li>
<li><a name="a4424"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$timeValue </span><span class="src-doc">       Excel time serial value or a standard time string</span></li>
<li><a name="a4425"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       Second</span></li>
<li><a name="a4426"></a><span class="src-doc">     */</span></li>
<li><a name="a4427"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSECONDOFMINUTE">SECONDOFMINUTE</a><span class="src-sym">(</span><span class="src-var">$timeValue </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4428"></a>        <span class="src-var">$timeValue    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4429"></a>&nbsp;</li>
<li><a name="a4430"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4431"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4432"></a>                <span class="src-var">$testVal </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">,</span><span class="src-str">'/-'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4433"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$testVal</span><span class="src-sym">) </span>&lt; <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4434"></a>                    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4435"></a>                <span class="src-sym">}</span></li>
<li><a name="a4436"></a>            <span class="src-sym">}</span></li>
<li><a name="a4437"></a>            <span class="src-var">$timeValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">TIMEVALUE</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4438"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4439"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4440"></a>            <span class="src-sym">}</span></li>
<li><a name="a4441"></a>        <span class="src-sym">}</span></li>
<li><a name="a4442"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4443"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">PHPExcel_Shared_Date</span><span class="src-sym">::</span><span class="src-id">ExcelToPHPObject</span><span class="src-sym">(</span><span class="src-var">$timeValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4444"></a>        <span class="src-key">return </span>(int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'s'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4445"></a>    <span class="src-sym">}</span></li>
<li><a name="a4446"></a>&nbsp;</li>
<li><a name="a4447"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodadjustDateByMonths">adjustDateByMonths</a> <span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$adjustmentMonths </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4448"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4449"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodExcelToPHPObject">ExcelToPHPObject</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4450"></a>        <span class="src-var">$oMonth </span>= (int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'m'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4451"></a>        <span class="src-var">$oYear </span>= (int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4452"></a>&nbsp;</li>
<li><a name="a4453"></a>        <span class="src-var">$adjustmentMonthsString </span>= (string) <span class="src-var">$adjustmentMonths</span><span class="src-sym">;</span></li>
<li><a name="a4454"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$adjustmentMonths </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4455"></a>            <span class="src-var">$adjustmentMonthsString </span>= <span class="src-str">'+'</span>.<span class="src-var">$adjustmentMonths</span><span class="src-sym">;</span></li>
<li><a name="a4456"></a>        <span class="src-sym">}</span></li>
<li><a name="a4457"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$adjustmentMonths </span>!= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4458"></a>            <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">modify</span><span class="src-sym">(</span><span class="src-var">$adjustmentMonthsString</span>.<span class="src-str">' months'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4459"></a>        <span class="src-sym">}</span></li>
<li><a name="a4460"></a>        <span class="src-var">$nMonth </span>= (int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'m'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4461"></a>        <span class="src-var">$nYear </span>= (int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4462"></a>&nbsp;</li>
<li><a name="a4463"></a>        <span class="src-var">$monthDiff </span>= <span class="src-sym">(</span><span class="src-var">$nMonth </span>- <span class="src-var">$oMonth</span><span class="src-sym">) </span>+ <span class="src-sym">((</span><span class="src-var">$nYear </span>- <span class="src-var">$oYear</span><span class="src-sym">) </span>* <span class="src-num">12</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4464"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$monthDiff </span>!= <span class="src-var">$adjustmentMonths</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4465"></a>            <span class="src-var">$adjustDays </span>= (int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'d'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4466"></a>            <span class="src-var">$adjustDaysString </span>= <span class="src-str">'-'</span>.<span class="src-var">$adjustDays</span>.<span class="src-str">' days'</span><span class="src-sym">;</span></li>
<li><a name="a4467"></a>            <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">modify</span><span class="src-sym">(</span><span class="src-var">$adjustDaysString</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4468"></a>        <span class="src-sym">}</span></li>
<li><a name="a4469"></a>        <span class="src-key">return </span><span class="src-var">$PHPDateObject</span><span class="src-sym">;</span></li>
<li><a name="a4470"></a>    <span class="src-sym">}</span></li>
<li><a name="a4471"></a>&nbsp;</li>
<li><a name="a4472"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4473"></a><span class="src-doc">     * EDATE</span></li>
<li><a name="a4474"></a><span class="src-doc">     *</span></li>
<li><a name="a4475"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">               Excel date serial value or a standard date string</span></li>
<li><a name="a4476"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$adjustmentMonths </span><span class="src-doc">   Number of months to adjust by</span></li>
<li><a name="a4477"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel date serial value</span></li>
<li><a name="a4478"></a><span class="src-doc">     */</span></li>
<li><a name="a4479"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodEDATE">EDATE</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$adjustmentMonths </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4480"></a>        <span class="src-var">$dateValue            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4481"></a>        <span class="src-var">$adjustmentMonths    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$adjustmentMonths</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4482"></a>&nbsp;</li>
<li><a name="a4483"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$adjustmentMonths</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4484"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4485"></a>        <span class="src-sym">}</span></li>
<li><a name="a4486"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4487"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4488"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4489"></a>            <span class="src-sym">}</span></li>
<li><a name="a4490"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4491"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4492"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4493"></a>            <span class="src-sym">}</span></li>
<li><a name="a4494"></a>        <span class="src-sym">}</span></li>
<li><a name="a4495"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">adjustDateByMonths</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">,</span><span class="src-var">$adjustmentMonths</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4496"></a>&nbsp;</li>
<li><a name="a4497"></a>        <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodPHPToExcel">PHPToExcel</a><span class="src-sym">(</span><span class="src-var">$PHPDateObject</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4498"></a>    <span class="src-sym">}</span></li>
<li><a name="a4499"></a>&nbsp;</li>
<li><a name="a4500"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4501"></a><span class="src-doc">     * EOMONTH</span></li>
<li><a name="a4502"></a><span class="src-doc">     *</span></li>
<li><a name="a4503"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">long </span><span class="src-doc">   </span><span class="src-doc-var">$dateValue </span><span class="src-doc">           Excel date serial value or a standard date string</span></li>
<li><a name="a4504"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$adjustmentMonths </span><span class="src-doc">   Number of months to adjust by</span></li>
<li><a name="a4505"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">long </span><span class="src-doc">   Excel date serial value</span></li>
<li><a name="a4506"></a><span class="src-doc">     */</span></li>
<li><a name="a4507"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodEOMONTH">EOMONTH</a><span class="src-sym">(</span><span class="src-var">$dateValue </span>= <span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$adjustmentMonths </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4508"></a>        <span class="src-var">$dateValue            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4509"></a>        <span class="src-var">$adjustmentMonths    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$adjustmentMonths</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4510"></a>&nbsp;</li>
<li><a name="a4511"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$adjustmentMonths</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4512"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4513"></a>        <span class="src-sym">}</span></li>
<li><a name="a4514"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_numeric</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4515"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4516"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4517"></a>            <span class="src-sym">}</span></li>
<li><a name="a4518"></a>            <span class="src-var">$dateValue </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">DATEVALUE</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4519"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_string">is_string</a><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4520"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4521"></a>            <span class="src-sym">}</span></li>
<li><a name="a4522"></a>        <span class="src-sym">}</span></li>
<li><a name="a4523"></a>        <span class="src-comm">// Execute function</span></li>
<li><a name="a4524"></a>        <span class="src-var">$PHPDateObject </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">adjustDateByMonths</span><span class="src-sym">(</span><span class="src-var">$dateValue</span><span class="src-sym">,</span><span class="src-var">$adjustmentMonths</span>+<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4525"></a>        <span class="src-var">$adjustDays </span>= (int) <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">'d'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4526"></a>        <span class="src-var">$adjustDaysString </span>= <span class="src-str">'-'</span>.<span class="src-var">$adjustDays</span>.<span class="src-str">' days'</span><span class="src-sym">;</span></li>
<li><a name="a4527"></a>        <span class="src-var">$PHPDateObject</span><span class="src-sym">-&gt;</span><span class="src-id">modify</span><span class="src-sym">(</span><span class="src-var">$adjustDaysString</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4528"></a>&nbsp;</li>
<li><a name="a4529"></a>        <span class="src-key">return </span><span class="src-id"><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html">PHPExcel_Shared_Date</a></span><span class="src-sym">::</span><a href="../PHPExcel_Shared/PHPExcel_Shared_Date.html#methodPHPToExcel">PHPToExcel</a><span class="src-sym">(</span><span class="src-var">$PHPDateObject</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4530"></a>    <span class="src-sym">}</span></li>
<li><a name="a4531"></a>&nbsp;</li>
<li><a name="a4532"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4533"></a><span class="src-doc">     * TRUNC</span></li>
<li><a name="a4534"></a><span class="src-doc">     *</span></li>
<li><a name="a4535"></a><span class="src-doc">     * Truncates value to the number of fractional digits by number_digits.</span></li>
<li><a name="a4536"></a><span class="src-doc">     *</span></li>
<li><a name="a4537"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$value </span></li>
<li><a name="a4538"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">           </span><span class="src-doc-var">$number_digits </span></li>
<li><a name="a4539"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span><span class="src-doc">       Truncated value</span></li>
<li><a name="a4540"></a><span class="src-doc">     */</span></li>
<li><a name="a4541"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodTRUNC">TRUNC</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$number_digits </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4542"></a>        <span class="src-var">$value            </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4543"></a>        <span class="src-var">$number_digits    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number_digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4544"></a>&nbsp;</li>
<li><a name="a4545"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a4546"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$number_digits </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4547"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4548"></a>        <span class="src-sym">}</span></li>
<li><a name="a4549"></a>&nbsp;</li>
<li><a name="a4550"></a>        <span class="src-comm">// Truncate</span></li>
<li><a name="a4551"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$number_digits </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4552"></a>            <span class="src-var">$value </span>= <span class="src-var">$value </span>* <span class="src-id">pow</span><span class="src-sym">(</span><span class="src-num">10</span><span class="src-sym">, </span><span class="src-var">$number_digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4553"></a>        <span class="src-sym">}</span></li>
<li><a name="a4554"></a>        <span class="src-var">$value </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4555"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$number_digits </span>&gt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4556"></a>            <span class="src-var">$value </span>= <span class="src-var">$value </span>/ <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">10</span><span class="src-sym">, </span><span class="src-var">$number_digits</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4557"></a>        <span class="src-sym">}</span></li>
<li><a name="a4558"></a>&nbsp;</li>
<li><a name="a4559"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a4560"></a>        <span class="src-key">return </span><span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a4561"></a>    <span class="src-sym">}</span></li>
<li><a name="a4562"></a>&nbsp;</li>
<li><a name="a4563"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4564"></a><span class="src-doc">     * POWER</span></li>
<li><a name="a4565"></a><span class="src-doc">     *</span></li>
<li><a name="a4566"></a><span class="src-doc">     * Computes x raised to the power y.</span></li>
<li><a name="a4567"></a><span class="src-doc">     *</span></li>
<li><a name="a4568"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4569"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$y </span></li>
<li><a name="a4570"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">float </span></li>
<li><a name="a4571"></a><span class="src-doc">     */</span></li>
<li><a name="a4572"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodPOWER">POWER</a><span class="src-sym">(</span><span class="src-var">$x </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$y </span>= <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4573"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4574"></a>        <span class="src-var">$y    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$y</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4575"></a>&nbsp;</li>
<li><a name="a4576"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a4577"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4578"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4579"></a>        <span class="src-sym">}</span></li>
<li><a name="a4580"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>== <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$y </span>&lt;= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4581"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'divisionbyzero'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4582"></a>        <span class="src-sym">}</span></li>
<li><a name="a4583"></a>&nbsp;</li>
<li><a name="a4584"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a4585"></a>        <span class="src-key">return </span><span class="src-id">pow</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$y</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4586"></a>    <span class="src-sym">}</span></li>
<li><a name="a4587"></a>&nbsp;</li>
<li><a name="a4588"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4589"></a><span class="src-doc">     * BINTODEC</span></li>
<li><a name="a4590"></a><span class="src-doc">     *</span></li>
<li><a name="a4591"></a><span class="src-doc">     * Return a binary value as Decimal.</span></li>
<li><a name="a4592"></a><span class="src-doc">     *</span></li>
<li><a name="a4593"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4594"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4595"></a><span class="src-doc">     */</span></li>
<li><a name="a4596"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBINTODEC">BINTODEC</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4597"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4598"></a>&nbsp;</li>
<li><a name="a4599"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4600"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4601"></a>                <span class="src-var">$x </span>= (int) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4602"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4603"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4604"></a>            <span class="src-sym">}</span></li>
<li><a name="a4605"></a>        <span class="src-sym">}</span></li>
<li><a name="a4606"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4607"></a>            <span class="src-var">$x </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4608"></a>        <span class="src-sym">}</span></li>
<li><a name="a4609"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4610"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[01]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4611"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4612"></a>        <span class="src-sym">}</span></li>
<li><a name="a4613"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <span class="src-num">10</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4614"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4615"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>== <span class="src-num">10</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4616"></a>            <span class="src-comm">//    Two's Complement</span></li>
<li><a name="a4617"></a>            <span class="src-var">$x </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span>-<span class="src-num">9</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4618"></a>            <span class="src-key">return </span><span class="src-str">'-'</span>.<span class="src-sym">(</span><span class="src-num">512</span>-<a href="http://www.php.net/bindec">bindec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4619"></a>        <span class="src-sym">}</span></li>
<li><a name="a4620"></a>        <span class="src-key">return </span><a href="http://www.php.net/bindec">bindec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4621"></a>    <span class="src-sym">}</span></li>
<li><a name="a4622"></a>&nbsp;</li>
<li><a name="a4623"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4624"></a><span class="src-doc">     * BINTOHEX</span></li>
<li><a name="a4625"></a><span class="src-doc">     *</span></li>
<li><a name="a4626"></a><span class="src-doc">     * Return a binary value as Hex.</span></li>
<li><a name="a4627"></a><span class="src-doc">     *</span></li>
<li><a name="a4628"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4629"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4630"></a><span class="src-doc">     */</span></li>
<li><a name="a4631"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBINTOHEX">BINTOHEX</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4632"></a>        <span class="src-var">$x    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4633"></a>&nbsp;</li>
<li><a name="a4634"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4635"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4636"></a>                <span class="src-var">$x </span>= (int) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4637"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4638"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4639"></a>            <span class="src-sym">}</span></li>
<li><a name="a4640"></a>        <span class="src-sym">}</span></li>
<li><a name="a4641"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4642"></a>            <span class="src-var">$x </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4643"></a>        <span class="src-sym">}</span></li>
<li><a name="a4644"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4645"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[01]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4646"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4647"></a>        <span class="src-sym">}</span></li>
<li><a name="a4648"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <span class="src-num">10</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4649"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4650"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>== <span class="src-num">10</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4651"></a>            <span class="src-comm">//    Two's Complement</span></li>
<li><a name="a4652"></a>            <span class="src-key">return </span><a href="http://www.php.net/str_repeat">str_repeat</a><span class="src-sym">(</span><span class="src-str">'F'</span><span class="src-sym">,</span><span class="src-num">8</span><span class="src-sym">)</span>.<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/dechex">dechex</a><span class="src-sym">(</span><a href="http://www.php.net/bindec">bindec</a><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span>-<span class="src-num">9</span><span class="src-sym">))))</span><span class="src-sym">,</span>-<span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4653"></a>        <span class="src-sym">}</span></li>
<li><a name="a4654"></a>        <span class="src-key">return </span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/dechex">dechex</a><span class="src-sym">(</span><a href="http://www.php.net/bindec">bindec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a4655"></a>    <span class="src-sym">}</span></li>
<li><a name="a4656"></a>&nbsp;</li>
<li><a name="a4657"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4658"></a><span class="src-doc">     * BINTOOCT</span></li>
<li><a name="a4659"></a><span class="src-doc">     *</span></li>
<li><a name="a4660"></a><span class="src-doc">     * Return a binary value as Octal.</span></li>
<li><a name="a4661"></a><span class="src-doc">     *</span></li>
<li><a name="a4662"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4663"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4664"></a><span class="src-doc">     */</span></li>
<li><a name="a4665"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBINTOOCT">BINTOOCT</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4666"></a>        <span class="src-var">$x    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4667"></a>&nbsp;</li>
<li><a name="a4668"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4669"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4670"></a>                <span class="src-var">$x </span>= (int) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4671"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4672"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4673"></a>            <span class="src-sym">}</span></li>
<li><a name="a4674"></a>        <span class="src-sym">}</span></li>
<li><a name="a4675"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_GNUMERIC</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4676"></a>            <span class="src-var">$x </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4677"></a>        <span class="src-sym">}</span></li>
<li><a name="a4678"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4679"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[01]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4680"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4681"></a>        <span class="src-sym">}</span></li>
<li><a name="a4682"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <span class="src-num">10</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4683"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4684"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>== <span class="src-num">10</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4685"></a>            <span class="src-comm">//    Two's Complement</span></li>
<li><a name="a4686"></a>            <span class="src-key">return </span><a href="http://www.php.net/str_repeat">str_repeat</a><span class="src-sym">(</span><span class="src-str">'7'</span><span class="src-sym">,</span><span class="src-num">7</span><span class="src-sym">)</span>.<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/dechex">dechex</a><span class="src-sym">(</span><a href="http://www.php.net/bindec">bindec</a><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span>-<span class="src-num">9</span><span class="src-sym">))))</span><span class="src-sym">,</span>-<span class="src-num">3</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4687"></a>        <span class="src-sym">}</span></li>
<li><a name="a4688"></a>        <span class="src-key">return </span><a href="http://www.php.net/decoct">decoct</a><span class="src-sym">(</span><a href="http://www.php.net/bindec">bindec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4689"></a>    <span class="src-sym">}</span></li>
<li><a name="a4690"></a>&nbsp;</li>
<li><a name="a4691"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4692"></a><span class="src-doc">     * DECTOBIN</span></li>
<li><a name="a4693"></a><span class="src-doc">     *</span></li>
<li><a name="a4694"></a><span class="src-doc">     * Return an octal value as binary.</span></li>
<li><a name="a4695"></a><span class="src-doc">     *</span></li>
<li><a name="a4696"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4697"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4698"></a><span class="src-doc">     */</span></li>
<li><a name="a4699"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDECTOBIN">DECTOBIN</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4700"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4701"></a>&nbsp;</li>
<li><a name="a4702"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4703"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4704"></a>                <span class="src-var">$x </span>= (int) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4705"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4706"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4707"></a>            <span class="src-sym">}</span></li>
<li><a name="a4708"></a>        <span class="src-sym">}</span></li>
<li><a name="a4709"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4710"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[-0123456789.]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4711"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4712"></a>        <span class="src-sym">}</span></li>
<li><a name="a4713"></a>        <span class="src-var">$x </span>= (string) <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4714"></a>        <span class="src-var">$r </span>= <a href="http://www.php.net/decbin">decbin</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4715"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">) </span>== <span class="src-num">32</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4716"></a>            <span class="src-comm">//    Two's Complement</span></li>
<li><a name="a4717"></a>            <span class="src-var">$r </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">,</span>-<span class="src-num">10</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4718"></a>        <span class="src-sym">} </span><span class="src-key">elseif </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">) </span>&gt; <span class="src-num">11</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4719"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4720"></a>        <span class="src-sym">}</span></li>
<li><a name="a4721"></a>        <span class="src-key">return </span><span class="src-var">$r</span><span class="src-sym">;</span></li>
<li><a name="a4722"></a>    <span class="src-sym">}</span></li>
<li><a name="a4723"></a>&nbsp;</li>
<li><a name="a4724"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4725"></a><span class="src-doc">     * DECTOOCT</span></li>
<li><a name="a4726"></a><span class="src-doc">     *</span></li>
<li><a name="a4727"></a><span class="src-doc">     * Return an octal value as binary.</span></li>
<li><a name="a4728"></a><span class="src-doc">     *</span></li>
<li><a name="a4729"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4730"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4731"></a><span class="src-doc">     */</span></li>
<li><a name="a4732"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">DECTOOCT</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4733"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4734"></a>&nbsp;</li>
<li><a name="a4735"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4736"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4737"></a>                <span class="src-var">$x </span>= (int) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4738"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4739"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4740"></a>            <span class="src-sym">}</span></li>
<li><a name="a4741"></a>        <span class="src-sym">}</span></li>
<li><a name="a4742"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4743"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[-0123456789.]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4744"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4745"></a>        <span class="src-sym">}</span></li>
<li><a name="a4746"></a>        <span class="src-var">$x </span>= (string) <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4747"></a>        <span class="src-var">$r </span>= <a href="http://www.php.net/decoct">decoct</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4748"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">) </span>== <span class="src-num">11</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4749"></a>            <span class="src-comm">//    Two's Complement</span></li>
<li><a name="a4750"></a>            <span class="src-var">$r </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">,</span>-<span class="src-num">10</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4751"></a>        <span class="src-sym">}</span></li>
<li><a name="a4752"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4753"></a>    <span class="src-sym">}</span></li>
<li><a name="a4754"></a>&nbsp;</li>
<li><a name="a4755"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4756"></a><span class="src-doc">     * DECTOHEX</span></li>
<li><a name="a4757"></a><span class="src-doc">     *</span></li>
<li><a name="a4758"></a><span class="src-doc">     * Return an octal value as binary.</span></li>
<li><a name="a4759"></a><span class="src-doc">     *</span></li>
<li><a name="a4760"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4761"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4762"></a><span class="src-doc">     */</span></li>
<li><a name="a4763"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodDECTOHEX">DECTOHEX</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4764"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4765"></a>&nbsp;</li>
<li><a name="a4766"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4767"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$compatibilityMode </span>== <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">COMPATIBILITY_OPENOFFICE</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4768"></a>                <span class="src-var">$x </span>= (int) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4769"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4770"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4771"></a>            <span class="src-sym">}</span></li>
<li><a name="a4772"></a>        <span class="src-sym">}</span></li>
<li><a name="a4773"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4774"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[-0123456789.]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4775"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4776"></a>        <span class="src-sym">}</span></li>
<li><a name="a4777"></a>        <span class="src-var">$x </span>= (string) <span class="src-id">floor</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4778"></a>        <span class="src-var">$r </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/dechex">dechex</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4779"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">) </span>== <span class="src-num">8</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4780"></a>            <span class="src-comm">//    Two's Complement</span></li>
<li><a name="a4781"></a>            <span class="src-var">$r </span>= <span class="src-str">'FF'</span>.<span class="src-var">$r</span><span class="src-sym">;</span></li>
<li><a name="a4782"></a>        <span class="src-sym">}</span></li>
<li><a name="a4783"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4784"></a>    <span class="src-sym">}</span></li>
<li><a name="a4785"></a>&nbsp;</li>
<li><a name="a4786"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4787"></a><span class="src-doc">     * HEXTOBIN</span></li>
<li><a name="a4788"></a><span class="src-doc">     *</span></li>
<li><a name="a4789"></a><span class="src-doc">     * Return a hex value as binary.</span></li>
<li><a name="a4790"></a><span class="src-doc">     *</span></li>
<li><a name="a4791"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4792"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4793"></a><span class="src-doc">     */</span></li>
<li><a name="a4794"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodHEXTOBIN">HEXTOBIN</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4795"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4796"></a>&nbsp;</li>
<li><a name="a4797"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4798"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4799"></a>        <span class="src-sym">}</span></li>
<li><a name="a4800"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4801"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[0123456789ABCDEF]/'</span><span class="src-sym">,</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4802"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4803"></a>        <span class="src-sym">}</span></li>
<li><a name="a4804"></a>        <span class="src-key">return </span><span class="src-id">decbin</span><span class="src-sym">(</span><a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4805"></a>    <span class="src-sym">}</span></li>
<li><a name="a4806"></a>&nbsp;</li>
<li><a name="a4807"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4808"></a><span class="src-doc">     * HEXTOOCT</span></li>
<li><a name="a4809"></a><span class="src-doc">     *</span></li>
<li><a name="a4810"></a><span class="src-doc">     * Return a hex value as octal.</span></li>
<li><a name="a4811"></a><span class="src-doc">     *</span></li>
<li><a name="a4812"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4813"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4814"></a><span class="src-doc">     */</span></li>
<li><a name="a4815"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodHEXTOOCT">HEXTOOCT</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4816"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4817"></a>&nbsp;</li>
<li><a name="a4818"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4819"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4820"></a>        <span class="src-sym">}</span></li>
<li><a name="a4821"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4822"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[0123456789ABCDEF]/'</span><span class="src-sym">,</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4823"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4824"></a>        <span class="src-sym">}</span></li>
<li><a name="a4825"></a>        <span class="src-key">return </span><span class="src-id">decoct</span><span class="src-sym">(</span><a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4826"></a>    <span class="src-sym">}</span></li>
<li><a name="a4827"></a>&nbsp;</li>
<li><a name="a4828"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4829"></a><span class="src-doc">     * HEXTODEC</span></li>
<li><a name="a4830"></a><span class="src-doc">     *</span></li>
<li><a name="a4831"></a><span class="src-doc">     * Return a hex value as octal.</span></li>
<li><a name="a4832"></a><span class="src-doc">     *</span></li>
<li><a name="a4833"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4834"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4835"></a><span class="src-doc">     */</span></li>
<li><a name="a4836"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodHEXTODEC">HEXTODEC</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4837"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4838"></a>&nbsp;</li>
<li><a name="a4839"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4840"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4841"></a>        <span class="src-sym">}</span></li>
<li><a name="a4842"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4843"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <a href="http://www.php.net/preg_match_all">preg_match_all</a><span class="src-sym">(</span><span class="src-str">'/[0123456789ABCDEF]/'</span><span class="src-sym">,</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4844"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4845"></a>        <span class="src-sym">}</span></li>
<li><a name="a4846"></a>        <span class="src-key">return </span><span class="src-id">hexdec</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4847"></a>    <span class="src-sym">}</span></li>
<li><a name="a4848"></a>&nbsp;</li>
<li><a name="a4849"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4850"></a><span class="src-doc">     * OCTTOBIN</span></li>
<li><a name="a4851"></a><span class="src-doc">     *</span></li>
<li><a name="a4852"></a><span class="src-doc">     * Return an octal value as binary.</span></li>
<li><a name="a4853"></a><span class="src-doc">     *</span></li>
<li><a name="a4854"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4855"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4856"></a><span class="src-doc">     */</span></li>
<li><a name="a4857"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodOCTTOBIN">OCTTOBIN</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4858"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4859"></a>&nbsp;</li>
<li><a name="a4860"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4861"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4862"></a>        <span class="src-sym">}</span></li>
<li><a name="a4863"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4864"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match_all</span><span class="src-sym">(</span><span class="src-str">'/[01234567]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">) </span>!= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4865"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4866"></a>        <span class="src-sym">}</span></li>
<li><a name="a4867"></a>        <span class="src-key">return </span><span class="src-id">decbin</span><span class="src-sym">(</span><a href="http://www.php.net/octdec">octdec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4868"></a>    <span class="src-sym">}</span></li>
<li><a name="a4869"></a>&nbsp;</li>
<li><a name="a4870"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4871"></a><span class="src-doc">     * OCTTODEC</span></li>
<li><a name="a4872"></a><span class="src-doc">     *</span></li>
<li><a name="a4873"></a><span class="src-doc">     * Return an octal value as binary.</span></li>
<li><a name="a4874"></a><span class="src-doc">     *</span></li>
<li><a name="a4875"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4876"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4877"></a><span class="src-doc">     */</span></li>
<li><a name="a4878"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodOCTTODEC">OCTTODEC</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4879"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4880"></a>&nbsp;</li>
<li><a name="a4881"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4882"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4883"></a>        <span class="src-sym">}</span></li>
<li><a name="a4884"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4885"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match_all</span><span class="src-sym">(</span><span class="src-str">'/[01234567]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">) </span>!= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4886"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4887"></a>        <span class="src-sym">}</span></li>
<li><a name="a4888"></a>        <span class="src-key">return </span><span class="src-id">octdec</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4889"></a>    <span class="src-sym">}</span></li>
<li><a name="a4890"></a>&nbsp;</li>
<li><a name="a4891"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4892"></a><span class="src-doc">     * OCTTOHEX</span></li>
<li><a name="a4893"></a><span class="src-doc">     *</span></li>
<li><a name="a4894"></a><span class="src-doc">     * Return an octal value as hex.</span></li>
<li><a name="a4895"></a><span class="src-doc">     *</span></li>
<li><a name="a4896"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4897"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">string </span></li>
<li><a name="a4898"></a><span class="src-doc">     */</span></li>
<li><a name="a4899"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodOCTTOHEX">OCTTOHEX</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4900"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4901"></a>&nbsp;</li>
<li><a name="a4902"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_bool">is_bool</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4903"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4904"></a>        <span class="src-sym">}</span></li>
<li><a name="a4905"></a>        <span class="src-var">$x </span>= (string) <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a4906"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">preg_match_all</span><span class="src-sym">(</span><span class="src-str">'/[01234567]/'</span><span class="src-sym">,</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-var">$out</span><span class="src-sym">) </span>!= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4907"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4908"></a>        <span class="src-sym">}</span></li>
<li><a name="a4909"></a>        <span class="src-key">return </span><span class="src-id">strtoupper</span><span class="src-sym">(</span><a href="http://www.php.net/dechex">dechex</a><span class="src-sym">(</span><a href="http://www.php.net/octdec">octdec</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a4910"></a>    <span class="src-sym">}</span></li>
<li><a name="a4911"></a>&nbsp;</li>
<li><a name="a4912"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4913"></a><span class="src-doc">     * BESSELI</span></li>
<li><a name="a4914"></a><span class="src-doc">     *</span></li>
<li><a name="a4915"></a><span class="src-doc">     * Returns the modified Bessel function, which is equivalent to the Bessel function evaluated for purely imaginary arguments</span></li>
<li><a name="a4916"></a><span class="src-doc">     *</span></li>
<li><a name="a4917"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4918"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$n </span></li>
<li><a name="a4919"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a4920"></a><span class="src-doc">     */</span></li>
<li><a name="a4921"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBESSELI">BESSELI</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$n</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4922"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4923"></a>        <span class="src-var">$n    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4924"></a>&nbsp;</li>
<li><a name="a4925"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a4926"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$n </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4927"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4928"></a>            <span class="src-sym">}</span></li>
<li><a name="a4929"></a>            <span class="src-var">$f_2_PI </span>= <span class="src-num">2 </span>* <span class="src-id">pi</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4930"></a>&nbsp;</li>
<li><a name="a4931"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&lt;= <span class="src-num">30</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4932"></a>                <span class="src-var">$fTerm </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x </span>/ <span class="src-num">2</span><span class="src-sym">, </span><span class="src-var">$n</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4933"></a>                <span class="src-var">$nK </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4934"></a>                <span class="src-var">$fResult </span>= <span class="src-var">$fTerm</span><span class="src-sym">;</span></li>
<li><a name="a4935"></a>                <span class="src-var">$fSqrX </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">) </span>/ <span class="src-num">4</span><span class="src-sym">;</span></li>
<li><a name="a4936"></a>                do <span class="src-sym">{</span></li>
<li><a name="a4937"></a>                    <span class="src-var">$fTerm </span>*= <span class="src-var">$fSqrX</span><span class="src-sym">;</span></li>
<li><a name="a4938"></a>                    <span class="src-var">$fTerm </span>/= <span class="src-sym">(</span><span class="src-var">$nK </span>* <span class="src-sym">(</span><span class="src-var">$nK </span>+ <span class="src-var">$n</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4939"></a>                    <span class="src-var">$fResult </span>+= <span class="src-var">$fTerm</span><span class="src-sym">;</span></li>
<li><a name="a4940"></a>                <span class="src-sym">} </span><span class="src-key">while </span><span class="src-sym">((</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$fTerm</span><span class="src-sym">) </span>&gt; <span class="src-num">1e-10</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span>++<span class="src-var">$nK </span>&lt; <span class="src-num">100</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4941"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4942"></a>                <span class="src-var">$fXAbs </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4943"></a>                <span class="src-var">$fResult </span>= <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span><span class="src-var">$fXAbs</span><span class="src-sym">) </span>/ <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$f_2_PI </span>* <span class="src-var">$fXAbs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4944"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$n </span>&amp;&amp; <span class="src-num">1</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$x </span>&lt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4945"></a>                    <span class="src-var">$fResult </span>= -<span class="src-var">$fResult</span><span class="src-sym">;</span></li>
<li><a name="a4946"></a>                <span class="src-sym">}</span></li>
<li><a name="a4947"></a>            <span class="src-sym">}</span></li>
<li><a name="a4948"></a>            <span class="src-key">return </span><span class="src-var">$fResult</span><span class="src-sym">;</span></li>
<li><a name="a4949"></a>        <span class="src-sym">}</span></li>
<li><a name="a4950"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4951"></a>    <span class="src-sym">}</span></li>
<li><a name="a4952"></a>&nbsp;</li>
<li><a name="a4953"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4954"></a><span class="src-doc">     * BESSELJ</span></li>
<li><a name="a4955"></a><span class="src-doc">     *</span></li>
<li><a name="a4956"></a><span class="src-doc">     * Returns the Bessel function</span></li>
<li><a name="a4957"></a><span class="src-doc">     *</span></li>
<li><a name="a4958"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a4959"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$n </span></li>
<li><a name="a4960"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a4961"></a><span class="src-doc">     */</span></li>
<li><a name="a4962"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">BESSELJ</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$n</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4963"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4964"></a>        <span class="src-var">$n    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4965"></a>&nbsp;</li>
<li><a name="a4966"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a4967"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$n </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4968"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4969"></a>            <span class="src-sym">}</span></li>
<li><a name="a4970"></a>            <span class="src-var">$f_2_DIV_PI </span>= <span class="src-num">2 </span>/ <span class="src-id">pi</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4971"></a>            <span class="src-var">$f_PI_DIV_2 </span>= <a href="http://www.php.net/pi">pi</a><span class="src-sym">(</span><span class="src-sym">) </span>/ <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a4972"></a>            <span class="src-var">$f_PI_DIV_4 </span>= <a href="http://www.php.net/pi">pi</a><span class="src-sym">(</span><span class="src-sym">) </span>/ <span class="src-num">4</span><span class="src-sym">;</span></li>
<li><a name="a4973"></a>&nbsp;</li>
<li><a name="a4974"></a>            <span class="src-var">$fResult </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a4975"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&lt;= <span class="src-num">30</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4976"></a>                <span class="src-var">$fTerm </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x </span>/ <span class="src-num">2</span><span class="src-sym">, </span><span class="src-var">$n</span><span class="src-sym">) </span>/ <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">FACT</span><span class="src-sym">(</span><span class="src-var">$n</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4977"></a>                <span class="src-var">$nK </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a4978"></a>                <span class="src-var">$fResult </span>= <span class="src-var">$fTerm</span><span class="src-sym">;</span></li>
<li><a name="a4979"></a>                <span class="src-var">$fSqrX </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">) </span>/ -<span class="src-num">4</span><span class="src-sym">;</span></li>
<li><a name="a4980"></a>                do <span class="src-sym">{</span></li>
<li><a name="a4981"></a>                    <span class="src-var">$fTerm </span>*= <span class="src-var">$fSqrX</span><span class="src-sym">;</span></li>
<li><a name="a4982"></a>                    <span class="src-var">$fTerm </span>/= <span class="src-sym">(</span><span class="src-var">$nK </span>* <span class="src-sym">(</span><span class="src-var">$nK </span>+ <span class="src-var">$n</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4983"></a>                    <span class="src-var">$fResult </span>+= <span class="src-var">$fTerm</span><span class="src-sym">;</span></li>
<li><a name="a4984"></a>                <span class="src-sym">} </span><span class="src-key">while </span><span class="src-sym">((</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$fTerm</span><span class="src-sym">) </span>&gt; <span class="src-num">1e-10</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span>++<span class="src-var">$nK </span>&lt; <span class="src-num">100</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a4985"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a4986"></a>                <span class="src-var">$fXAbs </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4987"></a>                <span class="src-var">$fResult </span>= <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$f_2_DIV_PI </span>/ <span class="src-var">$fXAbs</span><span class="src-sym">) </span>* <a href="http://www.php.net/cos">cos</a><span class="src-sym">(</span><span class="src-var">$fXAbs </span>- <span class="src-var">$n </span>* <span class="src-var">$f_PI_DIV_2 </span>- <span class="src-var">$f_PI_DIV_4</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4988"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$n </span>&amp;&amp; <span class="src-num">1</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$x </span>&lt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a4989"></a>                    <span class="src-var">$fResult </span>= -<span class="src-var">$fResult</span><span class="src-sym">;</span></li>
<li><a name="a4990"></a>                <span class="src-sym">}</span></li>
<li><a name="a4991"></a>            <span class="src-sym">}</span></li>
<li><a name="a4992"></a>            <span class="src-key">return </span><span class="src-var">$fResult</span><span class="src-sym">;</span></li>
<li><a name="a4993"></a>        <span class="src-sym">}</span></li>
<li><a name="a4994"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4995"></a>    <span class="src-sym">}</span></li>
<li><a name="a4996"></a>&nbsp;</li>
<li><a name="a4997"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">Besselk0</span><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4998"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$fNum </span>&lt;= <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a4999"></a>            <span class="src-var">$fNum2 </span>= <span class="src-var">$fNum </span>* <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a5000"></a>            <span class="src-var">$y </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$fNum2</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5001"></a>            <span class="src-var">$fRet </span>= -<a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$fNum2</span><span class="src-sym">) </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">BESSELI</span><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">) </span>+</li>
<li><a name="a5002"></a>                    <span class="src-sym">(</span>-<span class="src-num">0.57721566 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.42278420 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.23069756 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.3488590e-1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.262698e-2 </span>+ <span class="src-var">$y </span>*</li>
<li><a name="a5003"></a>                    <span class="src-sym">(</span><span class="src-num">0.10750e-3 </span>+ <span class="src-var">$y </span>* <span class="src-num">0.74e-5</span><span class="src-sym">))))))</span><span class="src-sym">;</span></li>
<li><a name="a5004"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5005"></a>            <span class="src-var">$y </span>= <span class="src-num">2 </span>/ <span class="src-var">$fNum</span><span class="src-sym">;</span></li>
<li><a name="a5006"></a>            <span class="src-var">$fRet </span>= <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span>-<span class="src-var">$fNum</span><span class="src-sym">) </span>/ <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span>*</li>
<li><a name="a5007"></a>                    <span class="src-sym">(</span><span class="src-num">1.25331414 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.7832358e-1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.2189568e-1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.1062446e-1 </span>+ <span class="src-var">$y </span>*</li>
<li><a name="a5008"></a>                    <span class="src-sym">(</span><span class="src-num">0.587872e-2 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.251540e-2 </span>+ <span class="src-var">$y </span>* <span class="src-num">0.53208e-3</span><span class="src-sym">))))))</span><span class="src-sym">;</span></li>
<li><a name="a5009"></a>        <span class="src-sym">}</span></li>
<li><a name="a5010"></a>        <span class="src-key">return </span><span class="src-var">$fRet</span><span class="src-sym">;</span></li>
<li><a name="a5011"></a>    <span class="src-sym">}</span></li>
<li><a name="a5012"></a>&nbsp;</li>
<li><a name="a5013"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBesselk1">Besselk1</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5014"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$fNum </span>&lt;= <span class="src-num">2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5015"></a>            <span class="src-var">$fNum2 </span>= <span class="src-var">$fNum </span>* <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a5016"></a>            <span class="src-var">$y </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$fNum2</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5017"></a>            <span class="src-var">$fRet </span>= <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$fNum2</span><span class="src-sym">) </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">BESSELI</span><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">) </span>+</li>
<li><a name="a5018"></a>                    <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.15443144 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.67278579 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.18156897 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.1919402e-1 </span>+ <span class="src-var">$y </span>*</li>
<li><a name="a5019"></a>                    <span class="src-sym">(</span>-<span class="src-num">0.110404e-2 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.4686e-4</span><span class="src-sym">))))))) </span>/ <span class="src-var">$fNum</span><span class="src-sym">;</span></li>
<li><a name="a5020"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5021"></a>            <span class="src-var">$y </span>= <span class="src-num">2 </span>/ <span class="src-var">$fNum</span><span class="src-sym">;</span></li>
<li><a name="a5022"></a>            <span class="src-var">$fRet </span>= <a href="http://www.php.net/exp">exp</a><span class="src-sym">(</span>-<span class="src-var">$fNum</span><span class="src-sym">) </span>/ <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span>*</li>
<li><a name="a5023"></a>                    <span class="src-sym">(</span><span class="src-num">1.25331414 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.23498619 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.3655620e-1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.1504268e-1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.780353e-2 </span>+ <span class="src-var">$y </span>*</li>
<li><a name="a5024"></a>                    <span class="src-sym">(</span><span class="src-num">0.325614e-2 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.68245e-3</span><span class="src-sym">)))))))</span><span class="src-sym">;</span></li>
<li><a name="a5025"></a>        <span class="src-sym">}</span></li>
<li><a name="a5026"></a>        <span class="src-key">return </span><span class="src-var">$fRet</span><span class="src-sym">;</span></li>
<li><a name="a5027"></a>    <span class="src-sym">}</span></li>
<li><a name="a5028"></a>&nbsp;</li>
<li><a name="a5029"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5030"></a><span class="src-doc">     * BESSELK</span></li>
<li><a name="a5031"></a><span class="src-doc">     *</span></li>
<li><a name="a5032"></a><span class="src-doc">     * Returns the modified Bessel function, which is equivalent to the Bessel functions evaluated for purely imaginary arguments.</span></li>
<li><a name="a5033"></a><span class="src-doc">     *</span></li>
<li><a name="a5034"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a5035"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$n </span></li>
<li><a name="a5036"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a5037"></a><span class="src-doc">     */</span></li>
<li><a name="a5038"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBESSELK">BESSELK</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$ord</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5039"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5040"></a>        <span class="src-var">$n    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$ord</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a5041"></a>&nbsp;</li>
<li><a name="a5042"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$ord</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a5043"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ord </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5044"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5045"></a>            <span class="src-sym">}</span></li>
<li><a name="a5046"></a>&nbsp;</li>
<li><a name="a5047"></a>            <span class="src-key">switch</span><span class="src-sym">(</span><span class="src-var">$ord</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5048"></a>                <span class="src-key">case </span><span class="src-num">0 </span>:    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Besselk0</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5049"></a>                            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a5050"></a>                <span class="src-key">case </span><span class="src-num">1 </span>:    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Besselk1</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5051"></a>                            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a5052"></a>                <span class="src-key">default </span>:    <span class="src-var">$fTox    </span>= <span class="src-num">2 </span>/ <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a5053"></a>                            <span class="src-var">$fBkm    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Besselk0</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5054"></a>                            <span class="src-var">$fBk    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Besselk1</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5055"></a>                            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$n </span>= <span class="src-num">1</span><span class="src-sym">; </span><span class="src-var">$n </span>&lt; <span class="src-var">$ord</span><span class="src-sym">; </span><span class="src-var">$n</span>++<span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5056"></a>                                <span class="src-var">$fBkp    </span>= <span class="src-var">$fBkm </span>+ <span class="src-var">$n </span>* <span class="src-var">$fTox </span>* <span class="src-var">$fBk</span><span class="src-sym">;</span></li>
<li><a name="a5057"></a>                                <span class="src-var">$fBkm    </span>= <span class="src-var">$fBk</span><span class="src-sym">;</span></li>
<li><a name="a5058"></a>                                <span class="src-var">$fBk    </span>= <span class="src-var">$fBkp</span><span class="src-sym">;</span></li>
<li><a name="a5059"></a>                            <span class="src-sym">}</span></li>
<li><a name="a5060"></a>            <span class="src-sym">}</span></li>
<li><a name="a5061"></a>            <span class="src-key">return </span><span class="src-var">$fBk</span><span class="src-sym">;</span></li>
<li><a name="a5062"></a>        <span class="src-sym">}</span></li>
<li><a name="a5063"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5064"></a>    <span class="src-sym">}</span></li>
<li><a name="a5065"></a>&nbsp;</li>
<li><a name="a5066"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">Bessely0</span><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5067"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$fNum </span>&lt; <span class="src-num">8</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5068"></a>            <span class="src-var">$y </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5069"></a>            <span class="src-var">$f1 </span>= -<span class="src-num">2957821389.0 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">7062834065.0 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">512359803.6 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">10879881.29 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">86327.92757 </span>+ <span class="src-var">$y </span>* <span class="src-num">228.4622733</span><span class="src-sym">))))</span><span class="src-sym">;</span></li>
<li><a name="a5070"></a>            <span class="src-var">$f2 </span>= <span class="src-num">40076544269.0 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">745249964.8 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">7189466.438 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">47447.26470 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">226.1030244 </span>+ <span class="src-var">$y</span><span class="src-sym">))))</span><span class="src-sym">;</span></li>
<li><a name="a5071"></a>            <span class="src-var">$fRet </span>= <span class="src-var">$f1 </span>/ <span class="src-var">$f2 </span>+ <span class="src-num">0.636619772 </span>* <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">BESSELJ</span><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">) </span>* <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5072"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5073"></a>            <span class="src-var">$z </span>= <span class="src-num">8 </span>/ <span class="src-var">$fNum</span><span class="src-sym">;</span></li>
<li><a name="a5074"></a>            <span class="src-var">$y </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$z</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5075"></a>            <span class="src-var">$xx </span>= <span class="src-var">$fNum </span>- <span class="src-num">0.785398164</span><span class="src-sym">;</span></li>
<li><a name="a5076"></a>            <span class="src-var">$f1 </span>= <span class="src-num">1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.1098628627e-2 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.2734510407e-4 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.2073370639e-5 </span>+ <span class="src-var">$y </span>* <span class="src-num">0.2093887211e-6</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a5077"></a>            <span class="src-var">$f2 </span>= -<span class="src-num">0.1562499995e-1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.1430488765e-3 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.6911147651e-5 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.7621095161e-6 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.934945152e-7</span><span class="src-sym">))))</span><span class="src-sym">;</span></li>
<li><a name="a5078"></a>            <span class="src-var">$fRet </span>= <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-num">0.636619772 </span>/ <span class="src-var">$fNum</span><span class="src-sym">) </span>* <span class="src-sym">(</span><a href="http://www.php.net/sin">sin</a><span class="src-sym">(</span><span class="src-var">$xx</span><span class="src-sym">) </span>* <span class="src-var">$f1 </span>+ <span class="src-var">$z </span>* <a href="http://www.php.net/cos">cos</a><span class="src-sym">(</span><span class="src-var">$xx</span><span class="src-sym">) </span>* <span class="src-var">$f2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5079"></a>        <span class="src-sym">}</span></li>
<li><a name="a5080"></a>        <span class="src-key">return </span><span class="src-var">$fRet</span><span class="src-sym">;</span></li>
<li><a name="a5081"></a>    <span class="src-sym">}</span></li>
<li><a name="a5082"></a>&nbsp;</li>
<li><a name="a5083"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBessely1">Bessely1</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5084"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$fNum </span>&lt; <span class="src-num">8</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5085"></a>            <span class="src-var">$y </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5086"></a>            <span class="src-var">$f1 </span>= <span class="src-var">$fNum </span>* <span class="src-sym">(</span>-<span class="src-num">0.4900604943e13 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.1275274390e13 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.5153438139e11 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.7349264551e9 </span>+ <span class="src-var">$y </span>*</li>
<li><a name="a5087"></a>                <span class="src-sym">(</span>-<span class="src-num">0.4237922726e7 </span>+ <span class="src-var">$y </span>* <span class="src-num">0.8511937935e4</span><span class="src-sym">)))))</span><span class="src-sym">;</span></li>
<li><a name="a5088"></a>            <span class="src-var">$f2 </span>= <span class="src-num">0.2499580570e14 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.4244419664e12 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.3733650367e10 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.2245904002e8 </span>+ <span class="src-var">$y </span>*</li>
<li><a name="a5089"></a>                <span class="src-sym">(</span><span class="src-num">0.1020426050e6 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.3549632885e3 </span>+ <span class="src-var">$y</span><span class="src-sym">)))))</span><span class="src-sym">;</span></li>
<li><a name="a5090"></a>            <span class="src-var">$fRet </span>= <span class="src-var">$f1 </span>/ <span class="src-var">$f2 </span>+ <span class="src-num">0.636619772 </span>* <span class="src-sym">( </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">BESSELJ</span><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">) </span>* <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-var">$fNum</span><span class="src-sym">) </span>- <span class="src-num">1 </span>/ <span class="src-var">$fNum</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5091"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5092"></a>            <span class="src-var">$z </span>= <span class="src-num">8 </span>/ <span class="src-var">$fNum</span><span class="src-sym">;</span></li>
<li><a name="a5093"></a>            <span class="src-var">$y </span>= <span class="src-var">$z </span>* <span class="src-var">$z</span><span class="src-sym">;</span></li>
<li><a name="a5094"></a>            <span class="src-var">$xx </span>= <span class="src-var">$fNum </span>- <span class="src-num">2.356194491</span><span class="src-sym">;</span></li>
<li><a name="a5095"></a>            <span class="src-var">$f1 </span>= <span class="src-num">1 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.183105e-2 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.3516396496e-4 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.2457520174e-5 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.240337019e6</span><span class="src-sym">))))</span><span class="src-sym">;</span></li>
<li><a name="a5096"></a>            <span class="src-var">$f2 </span>= <span class="src-num">0.04687499995 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.2002690873e-3 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span><span class="src-num">0.8449199096e-5 </span>+ <span class="src-var">$y </span>* <span class="src-sym">(</span>-<span class="src-num">0.88228987e-6 </span>+ <span class="src-var">$y </span>* <span class="src-num">0.105787412e-6</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a5097"></a>            <span class="src-var">$fRet </span>= <a href="http://www.php.net/sqrt">sqrt</a><span class="src-sym">(</span><span class="src-num">0.636619772 </span>/ <span class="src-var">$fNum</span><span class="src-sym">) </span>* <span class="src-sym">(</span><a href="http://www.php.net/sin">sin</a><span class="src-sym">(</span><span class="src-var">$xx</span><span class="src-sym">) </span>* <span class="src-var">$f1 </span>+ <span class="src-var">$z </span>* <a href="http://www.php.net/cos">cos</a><span class="src-sym">(</span><span class="src-var">$xx</span><span class="src-sym">) </span>* <span class="src-var">$f2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5098"></a>            <span class="src-comm">#i12430# ...but this seems to work much better.</span></li>
<li><a name="a5099"></a><span class="src-comm">//            $fRet = sqrt(0.636619772 / $fNum) * sin($fNum - 2.356194491);</span></li>
<li><a name="a5100"></a>        <span class="src-sym">}</span></li>
<li><a name="a5101"></a>        <span class="src-key">return </span><span class="src-var">$fRet</span><span class="src-sym">;</span></li>
<li><a name="a5102"></a>    <span class="src-sym">}</span></li>
<li><a name="a5103"></a>&nbsp;</li>
<li><a name="a5104"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5105"></a><span class="src-doc">     * BESSELY</span></li>
<li><a name="a5106"></a><span class="src-doc">     *</span></li>
<li><a name="a5107"></a><span class="src-doc">     * Returns the Bessel function, which is also called the Weber function or the Neumann function.</span></li>
<li><a name="a5108"></a><span class="src-doc">     *</span></li>
<li><a name="a5109"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$x </span></li>
<li><a name="a5110"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$n </span></li>
<li><a name="a5111"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a5112"></a><span class="src-doc">     */</span></li>
<li><a name="a5113"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodBESSELY">BESSELY</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">, </span><span class="src-var">$ord</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5114"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5115"></a>        <span class="src-var">$n    </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$ord</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a5116"></a>&nbsp;</li>
<li><a name="a5117"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$ord</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a5118"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ord </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5119"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5120"></a>            <span class="src-sym">}</span></li>
<li><a name="a5121"></a>&nbsp;</li>
<li><a name="a5122"></a>            <span class="src-key">switch</span><span class="src-sym">(</span><span class="src-var">$ord</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5123"></a>                <span class="src-key">case </span><span class="src-num">0 </span>:    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Bessely0</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5124"></a>                            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a5125"></a>                <span class="src-key">case </span><span class="src-num">1 </span>:    <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Bessely1</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5126"></a>                            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a5127"></a>                <span class="src-key">default</span>:    <span class="src-var">$fTox    </span>= <span class="src-num">2 </span>/ <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a5128"></a>                            <span class="src-var">$fBym    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Bessely0</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5129"></a>                            <span class="src-var">$fBy    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">Bessely1</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5130"></a>                            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$n </span>= <span class="src-num">1</span><span class="src-sym">; </span><span class="src-var">$n </span>&lt; <span class="src-var">$ord</span><span class="src-sym">; </span><span class="src-var">$n</span>++<span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5131"></a>                                <span class="src-var">$fByp    </span>= <span class="src-var">$n </span>* <span class="src-var">$fTox </span>* <span class="src-var">$fBy </span>- <span class="src-var">$fBym</span><span class="src-sym">;</span></li>
<li><a name="a5132"></a>                                <span class="src-var">$fBym    </span>= <span class="src-var">$fBy</span><span class="src-sym">;</span></li>
<li><a name="a5133"></a>                                <span class="src-var">$fBy    </span>= <span class="src-var">$fByp</span><span class="src-sym">;</span></li>
<li><a name="a5134"></a>                            <span class="src-sym">}</span></li>
<li><a name="a5135"></a>            <span class="src-sym">}</span></li>
<li><a name="a5136"></a>            <span class="src-key">return </span><span class="src-var">$fBy</span><span class="src-sym">;</span></li>
<li><a name="a5137"></a>        <span class="src-sym">}</span></li>
<li><a name="a5138"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5139"></a>    <span class="src-sym">}</span></li>
<li><a name="a5140"></a>&nbsp;</li>
<li><a name="a5141"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5142"></a><span class="src-doc">     * DELTA</span></li>
<li><a name="a5143"></a><span class="src-doc">     *</span></li>
<li><a name="a5144"></a><span class="src-doc">     * Tests whether two values are equal. Returns 1 if number1 = number2; returns 0 otherwise.</span></li>
<li><a name="a5145"></a><span class="src-doc">     *</span></li>
<li><a name="a5146"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$a </span></li>
<li><a name="a5147"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$b </span></li>
<li><a name="a5148"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a5149"></a><span class="src-doc">     */</span></li>
<li><a name="a5150"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">DELTA</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">, </span><span class="src-var">$b</span>=<span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5151"></a>        <span class="src-var">$a    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5152"></a>        <span class="src-var">$b    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5153"></a>&nbsp;</li>
<li><a name="a5154"></a>        <span class="src-key">return </span>(int) <span class="src-sym">(</span><span class="src-var">$a </span>== <span class="src-var">$b</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5155"></a>    <span class="src-sym">}</span></li>
<li><a name="a5156"></a>&nbsp;</li>
<li><a name="a5157"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5158"></a><span class="src-doc">     * GESTEP</span></li>
<li><a name="a5159"></a><span class="src-doc">     *</span></li>
<li><a name="a5160"></a><span class="src-doc">     * Returns 1 if number = step; returns 0 (zero) otherwise</span></li>
<li><a name="a5161"></a><span class="src-doc">     *</span></li>
<li><a name="a5162"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$number </span></li>
<li><a name="a5163"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$step </span></li>
<li><a name="a5164"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a5165"></a><span class="src-doc">     */</span></li>
<li><a name="a5166"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodGESTEP">GESTEP</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">, </span><span class="src-var">$step</span>=<span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5167"></a>        <span class="src-var">$number    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5168"></a>        <span class="src-var">$step    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$step</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5169"></a>&nbsp;</li>
<li><a name="a5170"></a>        <span class="src-key">return </span>(int) <span class="src-sym">(</span><span class="src-var">$number </span>&gt;= <span class="src-var">$step</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5171"></a>    <span class="src-sym">}</span></li>
<li><a name="a5172"></a>&nbsp;</li>
<li><a name="a5173"></a>    <span class="src-comm">//</span></li>
<li><a name="a5174"></a><span class="src-comm">//    Private method to calculate the erf value</span></li>
<li><a name="a5175"></a>    <span class="src-comm">//</span></li>
<li><a name="a5175"></a>    </li>
<li><a name="a5176"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$two_sqrtpi </span>= <span class="src-num">1.128379167095512574</span><span class="src-sym">;</span></li>
<li><a name="a5177"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$rel_error </span>= <span class="src-num">1E-15</span><span class="src-sym">;</span></li>
<li><a name="a5178"></a>&nbsp;</li>
<li><a name="a5179"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methoderfVal">erfVal</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5180"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&gt; <span class="src-num">2.2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5181"></a>            <span class="src-key">return </span><span class="src-num">1 </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfcVal</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5182"></a>        <span class="src-sym">}</span></li>
<li><a name="a5183"></a>        <span class="src-var">$sum </span>= <span class="src-var">$term </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a5184"></a>        <span class="src-var">$xsqr </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5185"></a>        <span class="src-var">$j </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a5186"></a>        do <span class="src-sym">{</span></li>
<li><a name="a5187"></a>            <span class="src-var">$term </span>*= <span class="src-var">$xsqr </span>/ <span class="src-var">$j</span><span class="src-sym">;</span></li>
<li><a name="a5188"></a>            <span class="src-var">$sum </span>-= <span class="src-var">$term </span>/ <span class="src-sym">(</span><span class="src-num">2 </span>* <span class="src-var">$j </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5189"></a>            ++<span class="src-var">$j</span><span class="src-sym">;</span></li>
<li><a name="a5190"></a>            <span class="src-var">$term </span>*= <span class="src-var">$xsqr </span>/ <span class="src-var">$j</span><span class="src-sym">;</span></li>
<li><a name="a5191"></a>            <span class="src-var">$sum </span>+= <span class="src-var">$term </span>/ <span class="src-sym">(</span><span class="src-num">2 </span>* <span class="src-var">$j </span>+ <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5192"></a>            ++<span class="src-var">$j</span><span class="src-sym">;</span></li>
<li><a name="a5193"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sum </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5194"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a5195"></a>            <span class="src-sym">}</span></li>
<li><a name="a5196"></a>        <span class="src-sym">} </span><span class="src-key">while </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$term </span>/ <span class="src-var">$sum</span><span class="src-sym">) </span>&gt; <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$rel_error</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5197"></a>        <span class="src-key">return  </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$two_sqrtpi </span>* <span class="src-var">$sum</span><span class="src-sym">;</span></li>
<li><a name="a5198"></a>    <span class="src-sym">}</span></li>
<li><a name="a5199"></a>&nbsp;</li>
<li><a name="a5200"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5201"></a><span class="src-doc">     * ERF</span></li>
<li><a name="a5202"></a><span class="src-doc">     *</span></li>
<li><a name="a5203"></a><span class="src-doc">     * Returns the error function integrated between lower_limit and upper_limit</span></li>
<li><a name="a5204"></a><span class="src-doc">     *</span></li>
<li><a name="a5205"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$lower </span><span class="src-doc">   lower bound for integrating ERF</span></li>
<li><a name="a5206"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$upper </span><span class="src-doc">   upper bound for integrating ERF.</span></li>
<li><a name="a5207"></a><span class="src-doc">     *                                 If omitted, ERF integrates between zero and lower_limit</span></li>
<li><a name="a5208"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a5209"></a><span class="src-doc">     */</span></li>
<li><a name="a5210"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">ERF</span><span class="src-sym">(</span><span class="src-var">$lower</span><span class="src-sym">, </span><span class="src-var">$upper </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5211"></a>        <span class="src-var">$lower    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$lower</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5212"></a>        <span class="src-var">$upper    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$upper</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5213"></a>&nbsp;</li>
<li><a name="a5214"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$lower</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$upper</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a5215"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$lower </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$upper </span>&lt; <span class="src-num">0</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5216"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5217"></a>            <span class="src-sym">}</span></li>
<li><a name="a5218"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$upper </span>&gt; <span class="src-var">$lower</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5219"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfVal</span><span class="src-sym">(</span><span class="src-var">$upper</span><span class="src-sym">) </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfVal</span><span class="src-sym">(</span><span class="src-var">$lower</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5220"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5221"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfVal</span><span class="src-sym">(</span><span class="src-var">$lower</span><span class="src-sym">) </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfVal</span><span class="src-sym">(</span><span class="src-var">$upper</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5222"></a>            <span class="src-sym">}</span></li>
<li><a name="a5223"></a>        <span class="src-sym">}</span></li>
<li><a name="a5224"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5225"></a>    <span class="src-sym">}</span></li>
<li><a name="a5226"></a>&nbsp;</li>
<li><a name="a5227"></a>    <span class="src-comm">//</span></li>
<li><a name="a5228"></a><span class="src-comm">//    Private method to calculate the erfc value</span></li>
<li><a name="a5229"></a>    <span class="src-comm">//</span></li>
<li><a name="a5229"></a>    </li>
<li><a name="a5230"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-var">$one_sqrtpi </span>= <span class="src-num">0.564189583547756287</span><span class="src-sym">;</span></li>
<li><a name="a5231"></a>&nbsp;</li>
<li><a name="a5232"></a>    <span class="src-key">private </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">erfcVal</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5233"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span>&lt; <span class="src-num">2.2</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5234"></a>            <span class="src-key">return </span><span class="src-num">1 </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfVal</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5235"></a>        <span class="src-sym">}</span></li>
<li><a name="a5236"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5237"></a>            <span class="src-key">return </span><span class="src-num">2 </span>- <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfc</span><span class="src-sym">(</span>-<span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5238"></a>        <span class="src-sym">}</span></li>
<li><a name="a5239"></a>        <span class="src-var">$a </span>= <span class="src-var">$n </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a5240"></a>        <span class="src-var">$b </span>= <span class="src-var">$c </span>= <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a5241"></a>        <span class="src-var">$d </span>= <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">) </span>+ <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a5242"></a>        <span class="src-var">$q1 </span>= <span class="src-var">$q2 </span>= <span class="src-var">$b </span>/ <span class="src-var">$d</span><span class="src-sym">;</span></li>
<li><a name="a5243"></a>        <span class="src-var">$t </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a5244"></a>        do <span class="src-sym">{</span></li>
<li><a name="a5245"></a>            <span class="src-var">$t </span>= <span class="src-var">$a </span>* <span class="src-var">$n </span>+ <span class="src-var">$b </span>* <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a5246"></a>            <span class="src-var">$a </span>= <span class="src-var">$b</span><span class="src-sym">;</span></li>
<li><a name="a5247"></a>            <span class="src-var">$b </span>= <span class="src-var">$t</span><span class="src-sym">;</span></li>
<li><a name="a5248"></a>            <span class="src-var">$t </span>= <span class="src-var">$c </span>* <span class="src-var">$n </span>+ <span class="src-var">$d </span>* <span class="src-var">$x</span><span class="src-sym">;</span></li>
<li><a name="a5249"></a>            <span class="src-var">$c </span>= <span class="src-var">$d</span><span class="src-sym">;</span></li>
<li><a name="a5250"></a>            <span class="src-var">$d </span>= <span class="src-var">$t</span><span class="src-sym">;</span></li>
<li><a name="a5251"></a>            <span class="src-var">$n </span>+= <span class="src-num">0.5</span><span class="src-sym">;</span></li>
<li><a name="a5252"></a>            <span class="src-var">$q1 </span>= <span class="src-var">$q2</span><span class="src-sym">;</span></li>
<li><a name="a5253"></a>            <span class="src-var">$q2 </span>= <span class="src-var">$b </span>/ <span class="src-var">$d</span><span class="src-sym">;</span></li>
<li><a name="a5254"></a>        <span class="src-sym">} </span><span class="src-key">while </span><span class="src-sym">((</span><a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><span class="src-var">$q1 </span>- <span class="src-var">$q2</span><span class="src-sym">) </span>/ <span class="src-var">$q2</span><span class="src-sym">) </span>&gt; <span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$rel_error</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5255"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$one_sqrtpi </span>* <span class="src-id">exp</span><span class="src-sym">(</span>-<span class="src-var">$x </span>* <span class="src-var">$x</span><span class="src-sym">) </span>* <span class="src-var">$q2</span><span class="src-sym">;</span></li>
<li><a name="a5256"></a>    <span class="src-sym">}</span></li>
<li><a name="a5257"></a>&nbsp;</li>
<li><a name="a5258"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5259"></a><span class="src-doc">     * ERFC</span></li>
<li><a name="a5260"></a><span class="src-doc">     *</span></li>
<li><a name="a5261"></a><span class="src-doc">     * Returns the complementary ERF function integrated between x and infinity</span></li>
<li><a name="a5262"></a><span class="src-doc">     *</span></li>
<li><a name="a5263"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">       </span><span class="src-doc-var">$x </span><span class="src-doc">       The lower bound for integrating ERF</span></li>
<li><a name="a5264"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span></li>
<li><a name="a5265"></a><span class="src-doc">     */</span></li>
<li><a name="a5266"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodERFC">ERFC</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5267"></a>        <span class="src-var">$x    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5268"></a>&nbsp;</li>
<li><a name="a5269"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5270"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$x </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5271"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5272"></a>            <span class="src-sym">}</span></li>
<li><a name="a5273"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">erfcVal</span><span class="src-sym">(</span><span class="src-var">$x</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5274"></a>        <span class="src-sym">}</span></li>
<li><a name="a5275"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5276"></a>    <span class="src-sym">}</span></li>
<li><a name="a5277"></a>&nbsp;</li>
<li><a name="a5278"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5279"></a><span class="src-doc">     * EFFECT</span></li>
<li><a name="a5280"></a><span class="src-doc">     *</span></li>
<li><a name="a5281"></a><span class="src-doc">     * Returns the effective interest rate given the nominal rate and the number of compounding payments per year.</span></li>
<li><a name="a5282"></a><span class="src-doc">     *</span></li>
<li><a name="a5283"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$nominal_rate </span><span class="src-doc">     Nominal interest rate</span></li>
<li><a name="a5284"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$npery </span><span class="src-doc">              Number of compounding payments per year</span></li>
<li><a name="a5285"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5286"></a><span class="src-doc">     */</span></li>
<li><a name="a5287"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">EFFECT</span><span class="src-sym">(</span><span class="src-var">$nominal_rate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$npery </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5288"></a>        <span class="src-var">$nominal_rate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span>$<span class="src-var">$nominal_rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5289"></a>        <span class="src-var">$npery            </span>= (int)<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$npery</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5290"></a>&nbsp;</li>
<li><a name="a5291"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a5292"></a>        <span class="src-key">if </span><span class="src-sym">(</span>$<span class="src-var">$nominal_rate </span>&lt;= <span class="src-num">0 </span>|| <span class="src-var">$npery </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5293"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5294"></a>        <span class="src-sym">}</span></li>
<li><a name="a5295"></a>&nbsp;</li>
<li><a name="a5296"></a>        <span class="src-key">return </span><span class="src-id">pow</span><span class="src-sym">((</span><span class="src-num">1 </span>+ <span class="src-var">$nominal_rate </span>/ <span class="src-var">$npery</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$npery</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a5297"></a>    <span class="src-sym">}</span></li>
<li><a name="a5298"></a>&nbsp;</li>
<li><a name="a5299"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5300"></a><span class="src-doc">     * NOMINAL</span></li>
<li><a name="a5301"></a><span class="src-doc">     *</span></li>
<li><a name="a5302"></a><span class="src-doc">     * Returns the nominal interest rate given the effective rate and the number of compounding payments per year.</span></li>
<li><a name="a5303"></a><span class="src-doc">     *</span></li>
<li><a name="a5304"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$effect_rate </span><span class="src-doc">   Effective interest rate</span></li>
<li><a name="a5305"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$npery </span><span class="src-doc">           Number of compounding payments per year</span></li>
<li><a name="a5306"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5307"></a><span class="src-doc">     */</span></li>
<li><a name="a5308"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodNOMINAL">NOMINAL</a><span class="src-sym">(</span><span class="src-var">$effect_rate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$npery </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5309"></a>        <span class="src-var">$effect_rate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$effect_rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5310"></a>        <span class="src-var">$npery            </span>= (int)<span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$npery</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5311"></a>&nbsp;</li>
<li><a name="a5312"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a5313"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$effect_rate </span>&lt;= <span class="src-num">0 </span>|| <span class="src-var">$npery </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5314"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5315"></a>        <span class="src-sym">}</span></li>
<li><a name="a5316"></a>&nbsp;</li>
<li><a name="a5317"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5318"></a>        <span class="src-key">return </span><span class="src-var">$npery </span>* <span class="src-sym">(</span><span class="src-id">pow</span><span class="src-sym">(</span><span class="src-var">$effect_rate </span>+ <span class="src-num">1</span><span class="src-sym">, </span><span class="src-num">1 </span>/ <span class="src-var">$npery</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5319"></a>    <span class="src-sym">}</span></li>
<li><a name="a5320"></a>&nbsp;</li>
<li><a name="a5321"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5322"></a><span class="src-doc">     * PV</span></li>
<li><a name="a5323"></a><span class="src-doc">     *</span></li>
<li><a name="a5324"></a><span class="src-doc">     * Returns the Present Value of a cash flow with constant payments and interest rate (annuities).</span></li>
<li><a name="a5325"></a><span class="src-doc">     *</span></li>
<li><a name="a5326"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$rate </span><span class="src-doc">   Interest rate per period</span></li>
<li><a name="a5327"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$nper </span><span class="src-doc">   Number of periods</span></li>
<li><a name="a5328"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$pmt </span><span class="src-doc">   Periodic payment (annuity)</span></li>
<li><a name="a5329"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$fv </span><span class="src-doc">       Future Value</span></li>
<li><a name="a5330"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$type </span><span class="src-doc">   Payment type: 0 = at the end of each period, 1 = at the beginning of each period</span></li>
<li><a name="a5331"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5332"></a><span class="src-doc">     */</span></li>
<li><a name="a5333"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodPV">PV</a><span class="src-sym">(</span><span class="src-var">$rate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$nper </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pmt </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$fv </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$type </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5334"></a>        <span class="src-var">$rate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5335"></a>        <span class="src-var">$nper    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$nper</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5336"></a>        <span class="src-var">$pmt    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$pmt</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5337"></a>        <span class="src-var">$fv        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5338"></a>        <span class="src-var">$type    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5339"></a>&nbsp;</li>
<li><a name="a5340"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a5341"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$type </span>!= <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$type </span>!= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5342"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5343"></a>        <span class="src-sym">}</span></li>
<li><a name="a5344"></a>&nbsp;</li>
<li><a name="a5345"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5346"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$rate </span>!= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5347"></a>            <span class="src-key">return </span><span class="src-sym">(</span>-<span class="src-var">$pmt </span>* <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate </span>* <span class="src-var">$type</span><span class="src-sym">) </span>* <span class="src-sym">((</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$nper</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-var">$rate</span><span class="src-sym">) </span>- <span class="src-var">$fv</span><span class="src-sym">) </span>/ <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$nper</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5348"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5349"></a>            <span class="src-key">return </span>-<span class="src-var">$fv </span>- <span class="src-var">$pmt </span>* <span class="src-var">$nper</span><span class="src-sym">;</span></li>
<li><a name="a5350"></a>        <span class="src-sym">}</span></li>
<li><a name="a5351"></a>    <span class="src-sym">}</span></li>
<li><a name="a5352"></a>&nbsp;</li>
<li><a name="a5353"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5354"></a><span class="src-doc">     * FV</span></li>
<li><a name="a5355"></a><span class="src-doc">     *</span></li>
<li><a name="a5356"></a><span class="src-doc">     * Returns the Future Value of a cash flow with constant payments and interest rate (annuities).</span></li>
<li><a name="a5357"></a><span class="src-doc">     *</span></li>
<li><a name="a5358"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$rate </span><span class="src-doc">   Interest rate per period</span></li>
<li><a name="a5359"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$nper </span><span class="src-doc">   Number of periods</span></li>
<li><a name="a5360"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$pmt </span><span class="src-doc">   Periodic payment (annuity)</span></li>
<li><a name="a5361"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$pv </span><span class="src-doc">       Present Value</span></li>
<li><a name="a5362"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$type </span><span class="src-doc">   Payment type: 0 = at the end of each period, 1 = at the beginning of each period</span></li>
<li><a name="a5363"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5364"></a><span class="src-doc">     */</span></li>
<li><a name="a5365"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodFV">FV</a><span class="src-sym">(</span><span class="src-var">$rate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$nper </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pmt </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pv </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$type </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5366"></a>        <span class="src-var">$rate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5367"></a>        <span class="src-var">$nper    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$nper</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5368"></a>        <span class="src-var">$pmt    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$pmt</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5369"></a>        <span class="src-var">$pv        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$pv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5370"></a>        <span class="src-var">$type    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5371"></a>&nbsp;</li>
<li><a name="a5372"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a5373"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$type </span>!= <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$type </span>!= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5374"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5375"></a>        <span class="src-sym">}</span></li>
<li><a name="a5376"></a>&nbsp;</li>
<li><a name="a5377"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5378"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$rate </span>!= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5379"></a>            <span class="src-key">return </span>-<span class="src-var">$pv </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$nper</span><span class="src-sym">) </span>- <span class="src-var">$pmt </span>* <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate </span>* <span class="src-var">$type</span><span class="src-sym">) </span>* <span class="src-sym">(</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$nper</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-var">$rate</span><span class="src-sym">;</span></li>
<li><a name="a5380"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5381"></a>            <span class="src-key">return </span>-<span class="src-var">$pv </span>- <span class="src-var">$pmt </span>* <span class="src-var">$nper</span><span class="src-sym">;</span></li>
<li><a name="a5382"></a>        <span class="src-sym">}</span></li>
<li><a name="a5383"></a>    <span class="src-sym">}</span></li>
<li><a name="a5384"></a>&nbsp;</li>
<li><a name="a5385"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5386"></a><span class="src-doc">     * PMT</span></li>
<li><a name="a5387"></a><span class="src-doc">     *</span></li>
<li><a name="a5388"></a><span class="src-doc">     * Returns the constant payment (annuity) for a cash flow with a constant interest rate.</span></li>
<li><a name="a5389"></a><span class="src-doc">     *</span></li>
<li><a name="a5390"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$rate </span><span class="src-doc">   Interest rate per period</span></li>
<li><a name="a5391"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$nper </span><span class="src-doc">   Number of periods</span></li>
<li><a name="a5392"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$pv </span><span class="src-doc">       Present Value</span></li>
<li><a name="a5393"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$fv </span><span class="src-doc">       Future Value</span></li>
<li><a name="a5394"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$type </span><span class="src-doc">   Payment type: 0 = at the end of each period, 1 = at the beginning of each period</span></li>
<li><a name="a5395"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5396"></a><span class="src-doc">     */</span></li>
<li><a name="a5397"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodPMT">PMT</a><span class="src-sym">(</span><span class="src-var">$rate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$nper </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pv </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$fv </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$type </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5398"></a>        <span class="src-var">$rate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5399"></a>        <span class="src-var">$nper    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$nper</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5400"></a>        <span class="src-var">$pv        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$pv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5401"></a>        <span class="src-var">$fv        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5402"></a>        <span class="src-var">$type    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5403"></a>&nbsp;</li>
<li><a name="a5404"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a5405"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$type </span>!= <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$type </span>!= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5406"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5407"></a>        <span class="src-sym">}</span></li>
<li><a name="a5408"></a>&nbsp;</li>
<li><a name="a5409"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5410"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$rate </span>!= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5411"></a>            <span class="src-key">return </span><span class="src-sym">(</span>-<span class="src-var">$fv </span>- <span class="src-var">$pv </span>* <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$nper</span><span class="src-sym">)) </span>/ <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate </span>* <span class="src-var">$type</span><span class="src-sym">) </span>/ <span class="src-sym">((</span><a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$nper</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">) </span>/ <span class="src-var">$rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5412"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5413"></a>            <span class="src-key">return </span><span class="src-sym">(</span>-<span class="src-var">$pv </span>- <span class="src-var">$fv</span><span class="src-sym">) </span>/ <span class="src-var">$nper</span><span class="src-sym">;</span></li>
<li><a name="a5414"></a>        <span class="src-sym">}</span></li>
<li><a name="a5415"></a>    <span class="src-sym">}</span></li>
<li><a name="a5416"></a>&nbsp;</li>
<li><a name="a5417"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5418"></a><span class="src-doc">     * NPER</span></li>
<li><a name="a5419"></a><span class="src-doc">     *</span></li>
<li><a name="a5420"></a><span class="src-doc">     * Returns the number of periods for a cash flow with constant periodic payments (annuities), and interest rate.</span></li>
<li><a name="a5421"></a><span class="src-doc">     *</span></li>
<li><a name="a5422"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$rate </span><span class="src-doc">   Interest rate per period</span></li>
<li><a name="a5423"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$pmt </span><span class="src-doc">   Periodic payment (annuity)</span></li>
<li><a name="a5424"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$pv </span><span class="src-doc">       Present Value</span></li>
<li><a name="a5425"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$fv </span><span class="src-doc">       Future Value</span></li>
<li><a name="a5426"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$type </span><span class="src-doc">   Payment type: 0 = at the end of each period, 1 = at the beginning of each period</span></li>
<li><a name="a5427"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5428"></a><span class="src-doc">     */</span></li>
<li><a name="a5429"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodNPER">NPER</a><span class="src-sym">(</span><span class="src-var">$rate </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pmt </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pv </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$fv </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$type </span>= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5430"></a>        <span class="src-var">$rate    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5431"></a>        <span class="src-var">$pmt    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$pmt</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5432"></a>        <span class="src-var">$pv        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$pv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5433"></a>        <span class="src-var">$fv        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$fv</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5434"></a>        <span class="src-var">$type    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5435"></a>&nbsp;</li>
<li><a name="a5436"></a>        <span class="src-comm">// Validate parameters</span></li>
<li><a name="a5437"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$type </span>!= <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$type </span>!= <span class="src-num">1</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5438"></a>            <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5439"></a>        <span class="src-sym">}</span></li>
<li><a name="a5440"></a>&nbsp;</li>
<li><a name="a5441"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5442"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$rate</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$rate </span>!= <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5443"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pmt </span>== <span class="src-num">0 </span>&amp;&amp; <span class="src-var">$pv </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5444"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5445"></a>            <span class="src-sym">}</span></li>
<li><a name="a5446"></a>            <span class="src-key">return </span><span class="src-id">log</span><span class="src-sym">((</span><span class="src-var">$pmt </span>* <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate </span>* <span class="src-var">$type</span><span class="src-sym">) </span>/ <span class="src-var">$rate </span>- <span class="src-var">$fv</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$pv </span>+ <span class="src-var">$pmt </span>* <span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate </span>* <span class="src-var">$type</span><span class="src-sym">) </span>/ <span class="src-var">$rate</span><span class="src-sym">)) </span>/ <a href="http://www.php.net/log">log</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5447"></a>        <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5448"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pmt </span>== <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5449"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5450"></a>            <span class="src-sym">}</span></li>
<li><a name="a5451"></a>            <span class="src-key">return </span><span class="src-sym">(</span>-<span class="src-var">$pv </span>-<span class="src-var">$fv</span><span class="src-sym">) </span>/ <span class="src-var">$pmt</span><span class="src-sym">;</span></li>
<li><a name="a5452"></a>        <span class="src-sym">}</span></li>
<li><a name="a5453"></a>    <span class="src-sym">}</span></li>
<li><a name="a5454"></a>&nbsp;</li>
<li><a name="a5455"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5456"></a><span class="src-doc">     * NPV</span></li>
<li><a name="a5457"></a><span class="src-doc">     *</span></li>
<li><a name="a5458"></a><span class="src-doc">     * Returns the Net Present Value of a cash flow series given a discount rate.</span></li>
<li><a name="a5459"></a><span class="src-doc">     *</span></li>
<li><a name="a5460"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   Discount interest rate</span></li>
<li><a name="a5461"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   Cash flow series</span></li>
<li><a name="a5462"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5463"></a><span class="src-doc">     */</span></li>
<li><a name="a5464"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">NPV</span><span class="src-sym">(</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5465"></a>        <span class="src-comm">// Return value</span></li>
<li><a name="a5466"></a>        <span class="src-var">$returnValue </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a5467"></a>&nbsp;</li>
<li><a name="a5468"></a>        <span class="src-comm">// Loop trough arguments</span></li>
<li><a name="a5469"></a>        <span class="src-var">$aArgs </span>= <span class="src-id"><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html">PHPExcel_Calculation_Functions</a></span><span class="src-sym">::</span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenArray">flattenArray</a><span class="src-sym">(</span><a href="http://www.php.net/func_get_args">func_get_args</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a5470"></a>&nbsp;</li>
<li><a name="a5471"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5472"></a>        <span class="src-var">$rate </span>= <a href="http://www.php.net/array_shift">array_shift</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5473"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">1</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt;= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">)</span><span class="src-sym">; </span>++<span class="src-var">$i</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5474"></a>            <span class="src-comm">// Is it a numeric value?</span></li>
<li><a name="a5475"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$aArgs</span><span class="src-sym">[</span><span class="src-var">$i </span>- <span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5476"></a>                <span class="src-var">$returnValue </span>+= <span class="src-var">$aArgs</span><span class="src-sym">[</span><span class="src-var">$i </span>- <span class="src-num">1</span><span class="src-sym">] </span>/ <a href="http://www.php.net/pow">pow</a><span class="src-sym">(</span><span class="src-num">1 </span>+ <span class="src-var">$rate</span><span class="src-sym">, </span><span class="src-var">$i</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5477"></a>            <span class="src-sym">}</span></li>
<li><a name="a5478"></a>        <span class="src-sym">}</span></li>
<li><a name="a5479"></a>&nbsp;</li>
<li><a name="a5480"></a>        <span class="src-comm">// Return</span></li>
<li><a name="a5481"></a>        <span class="src-key">return </span><span class="src-var">$returnValue</span><span class="src-sym">;</span></li>
<li><a name="a5482"></a>    <span class="src-sym">}</span></li>
<li><a name="a5483"></a>&nbsp;</li>
<li><a name="a5484"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5485"></a><span class="src-doc">     * ACCRINT</span></li>
<li><a name="a5486"></a><span class="src-doc">     *</span></li>
<li><a name="a5487"></a><span class="src-doc">     * Computes the accrued interest for a security that pays periodic interest.</span></li>
<li><a name="a5488"></a><span class="src-doc">     *</span></li>
<li><a name="a5489"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$issue </span></li>
<li><a name="a5490"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$firstInterest </span></li>
<li><a name="a5491"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$settlement </span></li>
<li><a name="a5492"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$rate </span></li>
<li><a name="a5493"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$par </span></li>
<li><a name="a5494"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$frequency </span></li>
<li><a name="a5495"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$basis </span></li>
<li><a name="a5496"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">int </span><span class="src-doc">       The accrued interest for a security that pays periodic interest.</span></li>
<li><a name="a5497"></a><span class="src-doc">     */</span></li>
<li><a name="a5498"></a>    <span class="src-comm">/*</span></li>
<li><a name="a5499"></a><span class="src-comm">    public static function ACCRINT($issue = 0, $firstInterest = 0, $settlement = 0, $rate = 0, $par = 1000, $frequency = 1, $basis = 0) {</span></li>
<li><a name="a5500"></a><span class="src-comm">        $issue            = self::flattenSingleValue($issue);</span></li>
<li><a name="a5501"></a><span class="src-comm">        $firstInterest    = self::flattenSingleValue($firstInterest);</span></li>
<li><a name="a5502"></a><span class="src-comm">        $settlement    = self::flattenSingleValue($settlement);</span></li>
<li><a name="a5503"></a><span class="src-comm">        $rate            = self::flattenSingleValue($rate);</span></li>
<li><a name="a5504"></a><span class="src-comm">        $par            = self::flattenSingleValue($par);</span></li>
<li><a name="a5505"></a><span class="src-comm">        $frequency        = self::flattenSingleValue($frequency);</span></li>
<li><a name="a5506"></a><span class="src-comm">        $basis            = self::flattenSingleValue($basis);</span></li>
<li><a name="a5507"></a>&nbsp;</li>
<li><a name="a5508"></a><span class="src-comm">        // Perform checks</span></li>
<li><a name="a5509"></a><span class="src-comm">        if ($issue &gt;= $settlement || $rate &lt;= 0 || $par &lt;= 0 || !($frequency == 1 || $frequency == 2 || $frequency == 4) || $basis &lt; 0 || $basis &gt; 4) return self::$_errorCodes['num'];</span></li>
<li><a name="a5510"></a>&nbsp;</li>
<li><a name="a5511"></a><span class="src-comm">        // Calculate value</span></li>
<li><a name="a5512"></a><span class="src-comm">        return $par * ($rate / $frequency) *</span></li>
<li><a name="a5513"></a><span class="src-comm">    }</span></li>
<li><a name="a5514"></a><span class="src-comm">    */</span></li>
<li><a name="a5515"></a>&nbsp;</li>
<li><a name="a5516"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5517"></a><span class="src-doc">     * SLN</span></li>
<li><a name="a5518"></a><span class="src-doc">     *</span></li>
<li><a name="a5519"></a><span class="src-doc">     * Returns the straight-line depreciation of an asset for one period</span></li>
<li><a name="a5520"></a><span class="src-doc">     *</span></li>
<li><a name="a5521"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">cost </span><span class="src-doc">       Initial cost of the asset</span></li>
<li><a name="a5522"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">salvage </span><span class="src-doc">       Value at the end of the depreciation</span></li>
<li><a name="a5523"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">life </span><span class="src-doc">       Number of periods over which the asset is depreciated</span></li>
<li><a name="a5524"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5525"></a><span class="src-doc">     */</span></li>
<li><a name="a5526"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodSLN">SLN</a><span class="src-sym">(</span><span class="src-var">$cost</span><span class="src-sym">, </span><span class="src-var">$salvage</span><span class="src-sym">, </span><span class="src-var">$life</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5527"></a>        <span class="src-var">$cost        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$cost</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5528"></a>        <span class="src-var">$salvage    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$salvage</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5529"></a>        <span class="src-var">$life        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$life</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5530"></a>&nbsp;</li>
<li><a name="a5531"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5532"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$cost</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$salvage</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$life</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a5533"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$life </span>&lt; <span class="src-num">0</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5534"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5535"></a>            <span class="src-sym">}</span></li>
<li><a name="a5536"></a>            <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$cost </span>- <span class="src-var">$salvage</span><span class="src-sym">) </span>/ <span class="src-var">$life</span><span class="src-sym">;</span></li>
<li><a name="a5537"></a>        <span class="src-sym">}</span></li>
<li><a name="a5538"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5539"></a>    <span class="src-sym">}</span></li>
<li><a name="a5540"></a>&nbsp;</li>
<li><a name="a5541"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5542"></a><span class="src-doc">     * SYD</span></li>
<li><a name="a5543"></a><span class="src-doc">     *</span></li>
<li><a name="a5544"></a><span class="src-doc">     * Returns the sum-of-years' digits depreciation of an asset for a specified period.</span></li>
<li><a name="a5545"></a><span class="src-doc">     *</span></li>
<li><a name="a5546"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">cost </span><span class="src-doc">       Initial cost of the asset</span></li>
<li><a name="a5547"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">salvage </span><span class="src-doc">       Value at the end of the depreciation</span></li>
<li><a name="a5548"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">life </span><span class="src-doc">       Number of periods over which the asset is depreciated</span></li>
<li><a name="a5549"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">period </span><span class="src-doc">       Period</span></li>
<li><a name="a5550"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a5551"></a><span class="src-doc">     */</span></li>
<li><a name="a5552"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">SYD</span><span class="src-sym">(</span><span class="src-var">$cost</span><span class="src-sym">, </span><span class="src-var">$salvage</span><span class="src-sym">, </span><span class="src-var">$life</span><span class="src-sym">, </span><span class="src-var">$period</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5553"></a>        <span class="src-var">$cost        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$cost</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5554"></a>        <span class="src-var">$salvage    </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$salvage</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5555"></a>        <span class="src-var">$life        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$life</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5556"></a>        <span class="src-var">$period        </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$period</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5557"></a>&nbsp;</li>
<li><a name="a5558"></a>        <span class="src-comm">// Calculate</span></li>
<li><a name="a5559"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$cost</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$salvage</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$life</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$period</span><span class="src-sym">))) </span><span class="src-sym">{</span></li>
<li><a name="a5560"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$life </span>&lt; <span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$salvage </span>&lt; <span class="src-var">$life</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5561"></a>                <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'num'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5562"></a>            <span class="src-sym">}</span></li>
<li><a name="a5563"></a>            <span class="src-key">return </span><span class="src-sym">((</span><span class="src-var">$cost </span>- <span class="src-var">$salvage</span><span class="src-sym">) </span>* <span class="src-sym">(</span><span class="src-var">$life </span>- <span class="src-var">$period </span>+ <span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-num">2</span><span class="src-sym">) </span>/ <span class="src-sym">(</span><span class="src-var">$life </span>* <span class="src-sym">(</span><span class="src-var">$life </span>+ <span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a5564"></a>        <span class="src-sym">}</span></li>
<li><a name="a5565"></a>        <span class="src-key">return </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-var">$_errorCodes</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a5566"></a>    <span class="src-sym">}</span></li>
<li><a name="a5567"></a>&nbsp;</li>
<li><a name="a5568"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5569"></a><span class="src-doc">     * Flatten multidemensional array</span></li>
<li><a name="a5570"></a><span class="src-doc">     *</span></li>
<li><a name="a5571"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$array </span><span class="src-doc">   Array to be flattened</span></li>
<li><a name="a5572"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc"> </span><span class="src-doc-type">array </span><span class="src-doc">   Flattened array</span></li>
<li><a name="a5573"></a><span class="src-doc">     */</span></li>
<li><a name="a5574"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><span class="src-id">flattenArray</span><span class="src-sym">(</span><span class="src-var">$array</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5575"></a>        <span class="src-var">$arrayValues </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5576"></a>&nbsp;</li>
<li><a name="a5577"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$array </span><span class="src-key">as </span><span class="src-var">$value</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5578"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_scalar">is_scalar</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5579"></a>                <span class="src-var">$arrayValues</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a5580"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5581"></a>                <span class="src-var">$arrayValues </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><span class="src-var">$arrayValues</span><span class="src-sym">, </span><span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenArray</span><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a5582"></a>            <span class="src-sym">} </span><span class="src-key">else </span><span class="src-sym">{</span></li>
<li><a name="a5583"></a>                <span class="src-var">$arrayValues</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a5584"></a>            <span class="src-sym">}</span></li>
<li><a name="a5585"></a>        <span class="src-sym">}</span></li>
<li><a name="a5586"></a>&nbsp;</li>
<li><a name="a5587"></a>        <span class="src-key">return </span><span class="src-var">$arrayValues</span><span class="src-sym">;</span></li>
<li><a name="a5588"></a>    <span class="src-sym">}</span></li>
<li><a name="a5589"></a>&nbsp;</li>
<li><a name="a5590"></a>    <span class="src-doc">/**</span></li>
<li><a name="a5591"></a><span class="src-doc">     * Convert an array with one element to a flat value</span></li>
<li><a name="a5592"></a><span class="src-doc">     *</span></li>
<li><a name="a5593"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">       </span><span class="src-doc-var">$value </span><span class="src-doc">       Array or flat value</span></li>
<li><a name="a5594"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span></li>
<li><a name="a5595"></a><span class="src-doc">     */</span></li>
<li><a name="a5596"></a>    <span class="src-key">public </span><span class="src-key">static </span><span class="src-key">function </span><a href="../PHPExcel_Calculation/PHPExcel_Calculation_Functions.html#methodflattenSingleValue">flattenSingleValue</a><span class="src-sym">(</span><span class="src-var">$value </span>= <span class="src-str">''</span><span class="src-sym">) </span><span class="src-sym">{</span></li>
<li><a name="a5597"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)) </span><span class="src-sym">{</span></li>
<li><a name="a5598"></a>            <span class="src-var">$value </span>= <span class="src-id">self</span><span class="src-sym">::</span><span class="src-id">flattenSingleValue</span><span class="src-sym">(</span><a href="http://www.php.net/array_pop">array_pop</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a5599"></a>        <span class="src-sym">}</span></li>
<li><a name="a5600"></a>        <span class="src-key">return </span><span class="src-var">$value</span><span class="src-sym">;</span></li>
<li><a name="a5601"></a>    <span class="src-sym">}</span></li>
<li><a name="a5602"></a><span class="src-sym">}</span></li>
</ol></pre></div>
</div>
        <div class="credit">
		    <hr />
		    Documentation generated on Mon, 24 Dec 2007 13:08:25 +0100 by <a href="http://www.phpdoc.org">phpDocumentor 1.3.0RC3</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>